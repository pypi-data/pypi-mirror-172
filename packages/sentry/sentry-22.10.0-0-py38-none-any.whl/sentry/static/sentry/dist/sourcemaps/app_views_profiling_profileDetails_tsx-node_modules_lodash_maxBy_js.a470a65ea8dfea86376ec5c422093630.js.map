{"version":3,"file":"chunks/app_views_profiling_profileDetails_tsx-node_modules_lodash_maxBy_js.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/gridEditable/sortLink.tsx","webpack:///./app/utils/profiling/tableRenderer.tsx","webpack:///./app/utils/profiling/units/units.ts","webpack:///./app/utils/useEffectAfterFirstRender.ts","webpack:///./app/views/profiling/profileDetails.tsx","webpack:///../node_modules/lodash/_baseExtremum.js","webpack:///../node_modules/lodash/_baseGt.js","webpack:///../node_modules/lodash/maxBy.js"],"sourcesContent":["import {browserHistory} from 'react-router';\nimport styled from '@emotion/styled';\nimport {LocationDescriptorObject} from 'history';\nimport omit from 'lodash/omit';\n\nimport Link from 'sentry/components/links/link';\nimport {IconArrow} from 'sentry/icons';\n\nexport type Alignments = 'left' | 'right' | undefined;\nexport type Directions = 'desc' | 'asc' | undefined;\n\ntype Props = {\n  align: Alignments;\n  canSort: boolean;\n  direction: Directions;\n  generateSortLink: () => LocationDescriptorObject | undefined;\n  title: React.ReactNode;\n  onClick?: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n  replace?: boolean;\n};\n\nfunction SortLink({\n  align,\n  title,\n  canSort,\n  generateSortLink,\n  onClick,\n  direction,\n  replace,\n}: Props) {\n  const target = generateSortLink();\n\n  if (!target || !canSort) {\n    return <StyledNonLink align={align}>{title}</StyledNonLink>;\n  }\n\n  const arrow = !direction ? null : (\n    <StyledIconArrow size=\"xs\" direction={direction === 'desc' ? 'down' : 'up'} />\n  );\n\n  const handleOnClick: React.MouseEventHandler<HTMLAnchorElement> = e => {\n    if (replace) {\n      e.preventDefault();\n      browserHistory.replace(target);\n    }\n    onClick?.(e);\n  };\n\n  return (\n    <StyledLink align={align} to={target} onClick={handleOnClick}>\n      {title} {arrow}\n    </StyledLink>\n  );\n}\n\ntype LinkProps = React.ComponentPropsWithoutRef<typeof Link>;\ntype StyledLinkProps = LinkProps & {align: Alignments};\n\nconst StyledLink = styled((props: StyledLinkProps) => {\n  const forwardProps = omit(props, ['align', 'css']);\n  return <Link {...forwardProps} />;\n})`\n  display: block;\n  width: 100%;\n  white-space: nowrap;\n  color: inherit;\n\n  &:hover,\n  &:active,\n  &:focus,\n  &:visited {\n    color: inherit;\n  }\n\n  ${(p: StyledLinkProps) => (p.align ? `text-align: ${p.align};` : '')}\n`;\n\nconst StyledNonLink = styled('div')<{align: Alignments}>`\n  display: block;\n  width: 100%;\n  white-space: nowrap;\n  ${(p: {align: Alignments}) => (p.align ? `text-align: ${p.align};` : '')}\n`;\n\nconst StyledIconArrow = styled(IconArrow)`\n  vertical-align: top;\n`;\n\nexport default SortLink;\n","import {LocationDescriptorObject} from 'history';\n\nimport {GridColumnOrder, GridColumnSortBy} from 'sentry/components/gridEditable';\nimport SortLink from 'sentry/components/gridEditable/sortLink';\n\ninterface TableHeadProps<K> {\n  currentSort?: GridColumnSortBy<K> | null;\n  generateSortLink?: (column: K) => () => LocationDescriptorObject | undefined;\n  onClick?(column: GridColumnOrder<K>, e: React.MouseEvent<HTMLAnchorElement>): void;\n  rightAlignedColumns?: Set<K>;\n  sortableColumns?: Set<K>;\n}\n\nexport function renderTableHead<K>({\n  currentSort,\n  generateSortLink,\n  rightAlignedColumns,\n  sortableColumns,\n  onClick,\n}: TableHeadProps<K>) {\n  return (column: GridColumnOrder<K>, _columnIndex: number) => {\n    return (\n      <SortLink\n        onClick={e => onClick?.(column, e)}\n        align={rightAlignedColumns?.has(column.key) ? 'right' : 'left'}\n        title={column.name}\n        direction={currentSort?.key === column.key ? currentSort?.order : undefined}\n        canSort={sortableColumns?.has(column.key) || false}\n        generateSortLink={generateSortLink?.(column.key) ?? (() => undefined)}\n        replace\n      />\n    );\n  };\n}\n","export function relativeChange(final: number, initial: number): number {\n  return (final - initial) / initial;\n}\n\nexport type ProfilingFormatterUnit =\n  | 'nanoseconds'\n  | 'microseconds'\n  | 'milliseconds'\n  | 'seconds';\n\nconst durationMappings: Record<ProfilingFormatterUnit, number> = {\n  nanoseconds: 1e-9,\n  microseconds: 1e-6,\n  milliseconds: 1e-3,\n  seconds: 1,\n};\n\nexport function formatTo(\n  v: number,\n  from: ProfilingFormatterUnit | string,\n  to: ProfilingFormatterUnit | string\n) {\n  const fromMultiplier = Math.log10(durationMappings[from]);\n  const toMultiplier = Math.log10(durationMappings[to]);\n\n  const value = v * Math.pow(10, fromMultiplier - toMultiplier);\n  return value;\n}\n\nconst format = (v: number, abbrev: string, precision: number) => {\n  return v.toFixed(precision) + abbrev;\n};\n\nexport function makeFormatter(\n  from: ProfilingFormatterUnit | string\n): (value: number) => string {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const duration = value * multiplier;\n\n    if (duration >= 1) {\n      return format(duration, 's', 2);\n    }\n    if (duration / 1e-3 >= 1) {\n      return format(duration / 1e-3, 'ms', 2);\n    }\n    if (duration / 1e-6 >= 1) {\n      return format(duration / 1e-6, 'Î¼s', 2);\n    }\n    return format(duration / 1e-9, 'ns', 2);\n  };\n}\n\nfunction pad(n: number, slots: number) {\n  return Math.floor(n).toString().padStart(slots, '0');\n}\n\nexport function makeTimelineFormatter(from: ProfilingFormatterUnit | string) {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const s = value * multiplier;\n    const m = s / 60;\n    const ms = s * 1e3;\n\n    return `${pad(m, 2)}:${pad(s % 60, 2)}.${pad(ms % 1e3, 3)}`;\n  };\n}\n","import {useEffect, useRef} from 'react';\n\nconst useEffectAfterFirstRender = (\n  cb: React.EffectCallback,\n  deps: React.DependencyList\n): void => {\n  const firstRender = useRef<boolean>(true);\n\n  useEffect(() => {\n    if (firstRender.current) {\n      firstRender.current = false;\n      return;\n    }\n\n    cb();\n    // Dependencies are explicitly managed and the deps warning is enabled for the custom hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n};\n\nexport {useEffectAfterFirstRender};\n","import {Fragment, useCallback, useEffect, useMemo, useState} from 'react';\nimport {browserHistory, Link} from 'react-router';\nimport styled from '@emotion/styled';\nimport Fuse from 'fuse.js';\nimport * as qs from 'query-string';\n\nimport GridEditable, {\n  COL_WIDTH_UNDEFINED,\n  GridColumnOrder,\n} from 'sentry/components/gridEditable';\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport Pagination from 'sentry/components/pagination';\nimport SearchBar from 'sentry/components/searchBar';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport {Container, NumberContainer} from 'sentry/utils/discover/styles';\nimport {CallTreeNode} from 'sentry/utils/profiling/callTreeNode';\nimport {Profile} from 'sentry/utils/profiling/profile/profile';\nimport {generateProfileFlamechartRouteWithQuery} from 'sentry/utils/profiling/routes';\nimport {renderTableHead} from 'sentry/utils/profiling/tableRenderer';\nimport {makeFormatter} from 'sentry/utils/profiling/units/units';\nimport {decodeScalar} from 'sentry/utils/queryString';\nimport {useEffectAfterFirstRender} from 'sentry/utils/useEffectAfterFirstRender';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport {useParams} from 'sentry/utils/useParams';\n\nimport {useProfileGroup} from './profileGroupProvider';\n\nfunction collectTopProfileFrames(profile: Profile) {\n  const nodes: CallTreeNode[] = [];\n\n  profile.forEach(\n    node => {\n      if (node.selfWeight > 0) {\n        nodes.push(node);\n      }\n    },\n    () => {}\n  );\n\n  return (\n    nodes\n      .sort((a, b) => b.selfWeight - a.selfWeight)\n      // take only the slowest nodes from each thread because the rest\n      // aren't useful to display\n      .slice(0, 500)\n      .map(node => ({\n        symbol: node.frame.name,\n        image: node.frame.image,\n        thread: profile.threadId,\n        type: node.frame.is_application ? 'application' : 'system',\n        'self weight': node.selfWeight,\n        'total weight': node.totalWeight,\n      }))\n  );\n}\n\nconst RESULTS_PER_PAGE = 50;\n\nfunction ProfileDetails() {\n  const location = useLocation();\n  const [state] = useProfileGroup();\n  const organization = useOrganization();\n\n  useEffect(() => {\n    trackAdvancedAnalyticsEvent('profiling_views.profile_summary', {\n      organization,\n    });\n  }, [organization]);\n\n  const cursor = useMemo<number>(() => {\n    const cursorQuery = decodeScalar(location.query.cursor, '');\n    return parseInt(cursorQuery, 10) || 0;\n  }, [location.query.cursor]);\n\n  const query = useMemo<string>(() => decodeScalar(location.query.query, ''), [location]);\n\n  const allFunctions: TableDataRow[] = useMemo(() => {\n    return state.type === 'resolved'\n      ? state.data.profiles\n          .flatMap(collectTopProfileFrames)\n          // Self weight desc sort\n          .sort((a, b) => b['self weight'] - a['self weight'])\n      : [];\n  }, [state]);\n\n  const searchIndex = useMemo(() => {\n    return new Fuse(allFunctions, {\n      keys: ['symbol'],\n      threshold: 0.3,\n    });\n  }, [allFunctions]);\n\n  const search = useCallback(\n    (queryString: string) => {\n      if (!queryString) {\n        return allFunctions;\n      }\n      return searchIndex\n        .search(queryString)\n        .map(result => result.item)\n        .sort((a, b) => b['self weight'] - a['self weight']);\n    },\n    [searchIndex, allFunctions]\n  );\n\n  const [slowestFunctions, setSlowestFunctions] = useState<TableDataRow[]>(() => {\n    return search(query);\n  });\n\n  useEffectAfterFirstRender(() => {\n    setSlowestFunctions(search(query));\n  }, [allFunctions, query, search]);\n\n  const pageLinks = useMemo(() => {\n    const prevResults = cursor >= RESULTS_PER_PAGE ? 'true' : 'false';\n    const prevCursor = cursor >= RESULTS_PER_PAGE ? cursor - RESULTS_PER_PAGE : 0;\n    const prevQuery = {...location.query, cursor: prevCursor};\n    const prevHref = `${location.pathname}${qs.stringify(prevQuery)}`;\n    const prev = `<${prevHref}>; rel=\"previous\"; results=\"${prevResults}\"; cursor=\"${prevCursor}\"`;\n\n    const nextResults =\n      cursor + RESULTS_PER_PAGE < slowestFunctions.length ? 'true' : 'false';\n    const nextCursor =\n      cursor + RESULTS_PER_PAGE < slowestFunctions.length ? cursor + RESULTS_PER_PAGE : 0;\n    const nextQuery = {...location.query, cursor: nextCursor};\n    const nextHref = `${location.pathname}${qs.stringify(nextQuery)}`;\n    const next = `<${nextHref}>; rel=\"next\"; results=\"${nextResults}\"; cursor=\"${nextCursor}\"`;\n\n    return `${prev},${next}`;\n  }, [cursor, location, slowestFunctions]);\n\n  const handleSearch = useCallback(\n    searchString => {\n      browserHistory.replace({\n        ...location,\n        query: {\n          ...location.query,\n          query: searchString,\n          cursor: undefined,\n        },\n      });\n\n      setSlowestFunctions(search(searchString));\n    },\n    [location, search]\n  );\n\n  return (\n    <Fragment>\n      <SentryDocumentTitle\n        title={t('Profiling \\u2014 Details')}\n        orgSlug={organization.slug}\n      >\n        <Layout.Body>\n          <Layout.Main fullWidth>\n            <ActionBar>\n              <SearchBar\n                defaultQuery=\"\"\n                query={query}\n                placeholder={t('Search for frames')}\n                onChange={handleSearch}\n              />\n            </ActionBar>\n            <GridEditable\n              title={t('Slowest Functions')}\n              isLoading={state.type === 'loading'}\n              error={state.type === 'errored'}\n              data={slowestFunctions.slice(cursor, cursor + RESULTS_PER_PAGE)}\n              columnOrder={COLUMN_ORDER.map(key => COLUMNS[key])}\n              columnSortBy={[]}\n              grid={{\n                renderHeadCell: renderTableHead({\n                  rightAlignedColumns: RIGHT_ALIGNED_COLUMNS,\n                }),\n                renderBodyCell: renderFunctionCell,\n              }}\n              location={location}\n            />\n            <Pagination pageLinks={pageLinks} />\n          </Layout.Main>\n        </Layout.Body>\n      </SentryDocumentTitle>\n    </Fragment>\n  );\n}\n\nconst RIGHT_ALIGNED_COLUMNS = new Set<TableColumnKey>(['self weight', 'total weight']);\n\nconst ActionBar = styled('div')`\n  display: grid;\n  gap: ${space(2)};\n  grid-template-columns: auto;\n  margin-bottom: ${space(2)};\n`;\n\nfunction renderFunctionCell(\n  column: TableColumn,\n  dataRow: TableDataRow,\n  rowIndex: number,\n  columnIndex: number\n) {\n  return (\n    <ProfilingFunctionsTableCell\n      column={column}\n      dataRow={dataRow}\n      rowIndex={rowIndex}\n      columnIndex={columnIndex}\n    />\n  );\n}\n\ninterface ProfilingFunctionsTableCellProps {\n  column: TableColumn;\n  columnIndex: number;\n  dataRow: TableDataRow;\n  rowIndex: number;\n}\n\nconst formatter = makeFormatter('nanoseconds');\nfunction ProfilingFunctionsTableCell({\n  column,\n  dataRow,\n}: ProfilingFunctionsTableCellProps) {\n  const value = dataRow[column.key];\n  const {orgId, projectId, eventId} = useParams();\n\n  switch (column.key) {\n    case 'self weight':\n      return <NumberContainer>{formatter(value)}</NumberContainer>;\n    case 'total weight':\n      return <NumberContainer>{formatter(value)}</NumberContainer>;\n    case 'image':\n      return <Container>{value ?? 'Unknown'}</Container>;\n    case 'thread': {\n      return (\n        <Container>\n          <Link\n            to={generateProfileFlamechartRouteWithQuery({\n              orgSlug: orgId,\n              projectSlug: projectId,\n              profileId: eventId,\n              query: {tid: dataRow.thread},\n            })}\n          >\n            {value}\n          </Link>\n        </Container>\n      );\n    }\n    default:\n      return <Container>{value}</Container>;\n  }\n}\n\ntype TableColumnKey =\n  | 'symbol'\n  | 'image'\n  | 'self weight'\n  | 'total weight'\n  | 'thread'\n  | 'type';\ntype TableDataRow = Record<TableColumnKey, any>;\n\ntype TableColumn = GridColumnOrder<TableColumnKey>;\n\nconst COLUMN_ORDER: TableColumnKey[] = [\n  'symbol',\n  'image',\n  'thread',\n  'type',\n  'self weight',\n  'total weight',\n];\n\n// TODO: looks like these column names change depending on the platform?\nconst COLUMNS: Record<TableColumnKey, TableColumn> = {\n  symbol: {\n    key: 'symbol',\n    name: t('Symbol'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  image: {\n    key: 'image',\n    name: t('Binary'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  thread: {\n    key: 'thread',\n    name: t('Thread'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  type: {\n    key: 'type',\n    name: t('Type'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  'self weight': {\n    key: 'self weight',\n    name: t('Self Weight'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n  'total weight': {\n    key: 'total weight',\n    name: t('Total Weight'),\n    width: COL_WIDTH_UNDEFINED,\n  },\n};\n\nexport default ProfileDetails;\n","var isSymbol = require('./isSymbol');\n\n/**\n * The base implementation of methods like `_.max` and `_.min` which accepts a\n * `comparator` to determine the extremum value.\n *\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} iteratee The iteratee invoked per iteration.\n * @param {Function} comparator The comparator used to compare values.\n * @returns {*} Returns the extremum value.\n */\nfunction baseExtremum(array, iteratee, comparator) {\n  var index = -1,\n      length = array.length;\n\n  while (++index < length) {\n    var value = array[index],\n        current = iteratee(value);\n\n    if (current != null && (computed === undefined\n          ? (current === current && !isSymbol(current))\n          : comparator(current, computed)\n        )) {\n      var computed = current,\n          result = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseExtremum;\n","/**\n * The base implementation of `_.gt` which doesn't coerce arguments.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if `value` is greater than `other`,\n *  else `false`.\n */\nfunction baseGt(value, other) {\n  return value > other;\n}\n\nmodule.exports = baseGt;\n","var baseExtremum = require('./_baseExtremum'),\n    baseGt = require('./_baseGt'),\n    baseIteratee = require('./_baseIteratee');\n\n/**\n * This method is like `_.max` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * the value is ranked. The iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Math\n * @param {Array} array The array to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {*} Returns the maximum value.\n * @example\n *\n * var objects = [{ 'n': 1 }, { 'n': 2 }];\n *\n * _.maxBy(objects, function(o) { return o.n; });\n * // => { 'n': 2 }\n *\n * // The `_.property` iteratee shorthand.\n * _.maxBy(objects, 'n');\n * // => { 'n': 2 }\n */\nfunction maxBy(array, iteratee) {\n  return (array && array.length)\n    ? baseExtremum(array, baseIteratee(iteratee, 2), baseGt)\n    : undefined;\n}\n\nmodule.exports = maxBy;\n"],"names":["SortLink","align","title","canSort","generateSortLink","onClick","direction","replace","target","StyledNonLink","arrow","StyledIconArrow","size","StyledLink","to","e","preventDefault","browserHistory","props","forwardProps","omit","p","IconArrow","renderTableHead","currentSort","rightAlignedColumns","sortableColumns","column","_columnIndex","has","key","name","order","undefined","durationMappings","nanoseconds","microseconds","milliseconds","seconds","formatTo","v","from","fromMultiplier","Math","log10","toMultiplier","pow","format","abbrev","precision","toFixed","makeFormatter","multiplier","Error","value","duration","pad","n","slots","floor","toString","padStart","makeTimelineFormatter","s","ms","useEffectAfterFirstRender","cb","deps","firstRender","useRef","useEffect","current","collectTopProfileFrames","profile","nodes","forEach","node","selfWeight","push","sort","a","b","slice","map","symbol","frame","image","thread","threadId","type","is_application","totalWeight","RESULTS_PER_PAGE","ProfileDetails","location","useLocation","state","useProfileGroup","organization","useOrganization","trackAdvancedAnalyticsEvent","cursor","useMemo","cursorQuery","decodeScalar","query","parseInt","allFunctions","data","profiles","flatMap","searchIndex","Fuse","keys","threshold","search","useCallback","queryString","result","item","slowestFunctions","setSlowestFunctions","useState","pageLinks","prevResults","prevCursor","prevQuery","prev","pathname","qs","nextResults","length","nextCursor","nextQuery","handleSearch","searchString","Fragment","t","orgSlug","slug","fullWidth","ActionBar","defaultQuery","placeholder","onChange","isLoading","error","columnOrder","COLUMN_ORDER","COLUMNS","columnSortBy","grid","renderHeadCell","RIGHT_ALIGNED_COLUMNS","renderBodyCell","renderFunctionCell","Set","space","dataRow","rowIndex","columnIndex","ProfilingFunctionsTableCell","formatter","orgId","projectId","eventId","useParams","Link","generateProfileFlamechartRouteWithQuery","projectSlug","profileId","tid","width","COL_WIDTH_UNDEFINED","isSymbol","module","exports","array","iteratee","comparator","index","computed","other","baseExtremum","baseGt","baseIteratee"],"sourceRoot":""}