{"version":3,"file":"chunks/app_views_releases_detail_commitsAndFiles_filesChanged_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/avatar/avatarList.tsx","webpack:///./app/components/fileIcon.tsx","webpack:///./app/components/listGroup.tsx","webpack:///./app/components/fileChange.tsx","webpack:///./app/views/releases/detail/commitsAndFiles/filesChanged.tsx"],"sourcesContent":["import {css} from '@emotion/react';\nimport styled from '@emotion/styled';\n\nimport UserAvatar from 'sentry/components/avatar/userAvatar';\nimport Tooltip from 'sentry/components/tooltip';\nimport {AvatarUser} from 'sentry/types';\n\ntype UserAvatarProps = React.ComponentProps<typeof UserAvatar>;\n\ntype Props = {\n  users: AvatarUser[];\n  avatarSize?: number;\n  className?: string;\n  maxVisibleAvatars?: number;\n  renderTooltip?: UserAvatarProps['renderTooltip'];\n  tooltipOptions?: UserAvatarProps['tooltipOptions'];\n  typeMembers?: string;\n};\n\nfunction AvatarList({\n  avatarSize = 28,\n  maxVisibleAvatars = 5,\n  typeMembers = 'users',\n  tooltipOptions = {},\n  className,\n  users,\n  renderTooltip,\n}: Props) {\n  const visibleUsers = users.slice(0, maxVisibleAvatars);\n  const numCollapsedUsers = users.length - visibleUsers.length;\n\n  if (!tooltipOptions.position) {\n    tooltipOptions.position = 'top';\n  }\n\n  return (\n    <AvatarListWrapper className={className}>\n      {!!numCollapsedUsers && (\n        <Tooltip title={`${numCollapsedUsers} other ${typeMembers}`}>\n          <CollapsedUsers size={avatarSize} data-test-id=\"avatarList-collapsedusers\">\n            {numCollapsedUsers < 99 && <Plus>+</Plus>}\n            {numCollapsedUsers}\n          </CollapsedUsers>\n        </Tooltip>\n      )}\n      {visibleUsers.map(user => (\n        <StyledAvatar\n          key={`${user.id}-${user.email}`}\n          user={user}\n          size={avatarSize}\n          renderTooltip={renderTooltip}\n          tooltipOptions={tooltipOptions}\n          hasTooltip\n        />\n      ))}\n    </AvatarListWrapper>\n  );\n}\n\nexport default AvatarList;\n\n// used in releases list page to do some alignment\nexport const AvatarListWrapper = styled('div')`\n  display: flex;\n  flex-direction: row-reverse;\n`;\n\nconst Circle = p => css`\n  border-radius: 50%;\n  border: 2px solid ${p.theme.background};\n  margin-left: -8px;\n  cursor: default;\n\n  &:hover {\n    z-index: 1;\n  }\n`;\n\nconst StyledAvatar = styled(UserAvatar)`\n  overflow: hidden;\n  ${Circle};\n`;\n\nconst CollapsedUsers = styled('div')<{size: number}>`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  text-align: center;\n  font-weight: 600;\n  background-color: ${p => p.theme.gray200};\n  color: ${p => p.theme.gray300};\n  font-size: ${p => Math.floor(p.size / 2.3)}px;\n  width: ${p => p.size}px;\n  height: ${p => p.size}px;\n  ${Circle};\n`;\n\nconst Plus = styled('span')`\n  font-size: 10px;\n  margin-left: 1px;\n  margin-right: -1px;\n`;\n","import {IconFile} from 'sentry/icons';\nimport {fileExtensionToPlatform, getFileExtension} from 'sentry/utils/fileExtension';\nimport theme from 'sentry/utils/theme';\n\ntype Props = {\n  fileName: string;\n  className?: string;\n  size?: string;\n};\n\nconst FileIcon = ({fileName, size: providedSize = 'sm', className}: Props) => {\n  const fileExtension = getFileExtension(fileName);\n  const iconName = fileExtension ? fileExtensionToPlatform(fileExtension) : null;\n  const size = theme.iconSizes[providedSize] ?? providedSize;\n\n  if (!iconName) {\n    return <IconFile size={size} className={className} />;\n  }\n\n  return (\n    <img\n      src={require(`platformicons/svg/${iconName}.svg`)}\n      width={size}\n      height={size}\n      className={className}\n    />\n  );\n};\n\nexport default FileIcon;\n","import styled from '@emotion/styled';\n\nimport space from 'sentry/styles/space';\n\ntype ListGroupProps = {\n  striped?: boolean;\n};\n\ntype ListGroupItemProps = {\n  centered?: boolean;\n};\n\nconst ListGroupItem = styled('li')<ListGroupItemProps>`\n  position: relative;\n  display: block;\n  min-height: 36px;\n  border: 1px solid ${p => p.theme.border};\n\n  padding: ${space(0.5)} ${space(1.5)};\n\n  margin-bottom: -1px;\n  ${p => (p.centered ? 'text-align: center;' : '')}\n\n  &:first-child {\n    border-top-left-radius: ${p => p.theme.borderRadius};\n    border-top-right-radius: ${p => p.theme.borderRadius};\n  }\n  &:last-child {\n    border-bottom-left-radius: ${p => p.theme.borderRadius};\n    border-bottom-right-radius: ${p => p.theme.borderRadius};\n  }\n`;\n\nconst ListGroup = styled('ul')<ListGroupProps>`\n  box-shadow: 0 1px 0px rgba(0, 0, 0, 0.03);\n  background: ${p => p.theme.background};\n  padding: 0;\n  margin: 0;\n\n  ${p =>\n    p.striped\n      ? `\n    & > li:nth-child(odd) {\n      background: ${p.theme.backgroundSecondary};\n    }\n  `\n      : ''}\n`;\n\nexport {ListGroup, ListGroupItem};\n","import styled from '@emotion/styled';\n\nimport AvatarList from 'sentry/components/avatar/avatarList';\nimport FileIcon from 'sentry/components/fileIcon';\nimport {ListGroupItem} from 'sentry/components/listGroup';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport space from 'sentry/styles/space';\nimport {AvatarUser, CommitAuthor} from 'sentry/types';\n\ntype Props = {\n  authors: CommitAuthor[];\n  filename: string;\n  className?: string;\n};\n\nconst FileChange = ({filename, authors, className}: Props) => (\n  <FileItem className={className}>\n    <Filename>\n      <StyledFileIcon fileName={filename} />\n      <TextOverflow>{filename}</TextOverflow>\n    </Filename>\n    <div>\n      <AvatarList users={authors as AvatarUser[]} avatarSize={25} typeMembers=\"authors\" />\n    </div>\n  </FileItem>\n);\n\nconst FileItem = styled(ListGroupItem)`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n`;\n\nconst Filename = styled('div')`\n  font-size: ${p => p.theme.fontSizeMedium};\n  display: grid;\n  gap: ${space(1)};\n  margin-right: ${space(3)};\n  align-items: center;\n  grid-template-columns: max-content 1fr;\n`;\n\nconst StyledFileIcon = styled(FileIcon)`\n  color: ${p => p.theme.gray200};\n  border-radius: 3px;\n`;\n\nexport default FileChange;\n","import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\nimport {Location} from 'history';\n\nimport FileChange from 'sentry/components/fileChange';\nimport {Body, Main} from 'sentry/components/layouts/thirds';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport Pagination from 'sentry/components/pagination';\nimport {Panel, PanelBody, PanelHeader} from 'sentry/components/panels';\nimport {t, tn} from 'sentry/locale';\nimport {CommitFile, Organization, Project, Repository} from 'sentry/types';\nimport {formatVersion} from 'sentry/utils/formatters';\nimport routeTitleGen from 'sentry/utils/routeTitle';\nimport AsyncView from 'sentry/views/asyncView';\n\nimport {getFilesByRepository, getQuery, getReposToRender} from '../utils';\n\nimport EmptyState from './emptyState';\nimport RepositorySwitcher from './repositorySwitcher';\nimport withReleaseRepos from './withReleaseRepos';\n\ntype Props = RouteComponentProps<{orgId: string; release: string}, {}> & {\n  location: Location;\n  orgSlug: Organization['slug'];\n  projectSlug: Project['slug'];\n  release: string;\n  releaseRepos: Repository[];\n  activeReleaseRepo?: Repository;\n} & AsyncView['props'];\n\ntype State = {\n  fileList: CommitFile[];\n} & AsyncView['state'];\n\nclass FilesChanged extends AsyncView<Props, State> {\n  getTitle() {\n    const {params, projectSlug} = this.props;\n    const {orgId} = params;\n\n    return routeTitleGen(\n      t('Files Changed - Release %s', formatVersion(params.release)),\n      orgId,\n      false,\n      projectSlug\n    );\n  }\n\n  getDefaultState(): State {\n    return {\n      ...super.getDefaultState(),\n      fileList: [],\n    };\n  }\n\n  componentDidUpdate(prevProps: Props, prevState: State) {\n    if (prevProps.activeReleaseRepo?.name !== this.props.activeReleaseRepo?.name) {\n      this.remountComponent();\n      return;\n    }\n    super.componentDidUpdate(prevProps, prevState);\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {activeReleaseRepo: activeRepository, location, release, orgSlug} = this.props;\n\n    const query = getQuery({location, activeRepository});\n\n    return [\n      [\n        'fileList',\n        `/organizations/${orgSlug}/releases/${encodeURIComponent(release)}/commitfiles/`,\n        {query},\n      ],\n    ];\n  }\n\n  renderLoading() {\n    return this.renderBody();\n  }\n\n  renderContent() {\n    const {fileList, fileListPageLinks, loading} = this.state;\n    const {activeReleaseRepo} = this.props;\n\n    if (loading) {\n      return <LoadingIndicator />;\n    }\n\n    if (!fileList.length) {\n      return (\n        <EmptyState>\n          {!activeReleaseRepo\n            ? t('There are no changed files associated with this release.')\n            : t(\n                'There are no changed files associated with this release in the %s repository.',\n                activeReleaseRepo.name\n              )}\n        </EmptyState>\n      );\n    }\n\n    const filesByRepository = getFilesByRepository(fileList);\n    const reposToRender = getReposToRender(Object.keys(filesByRepository));\n\n    return (\n      <Fragment>\n        {reposToRender.map(repoName => {\n          const repoData = filesByRepository[repoName];\n          const files = Object.keys(repoData);\n          const fileCount = files.length;\n          return (\n            <Panel key={repoName}>\n              <PanelHeader>\n                <span>{repoName}</span>\n                <span>{tn('%s file changed', '%s files changed', fileCount)}</span>\n              </PanelHeader>\n              <PanelBody>\n                {files.map(filename => {\n                  const {authors} = repoData[filename];\n                  return (\n                    <StyledFileChange\n                      key={filename}\n                      filename={filename}\n                      authors={Object.values(authors)}\n                    />\n                  );\n                })}\n              </PanelBody>\n            </Panel>\n          );\n        })}\n        <Pagination pageLinks={fileListPageLinks} />\n      </Fragment>\n    );\n  }\n\n  renderBody() {\n    const {activeReleaseRepo, releaseRepos, router, location} = this.props;\n    return (\n      <Fragment>\n        {releaseRepos.length > 1 && (\n          <RepositorySwitcher\n            repositories={releaseRepos}\n            activeRepository={activeReleaseRepo}\n            location={location}\n            router={router}\n          />\n        )}\n        {this.renderContent()}\n      </Fragment>\n    );\n  }\n\n  renderComponent() {\n    return (\n      <Body>\n        <Main fullWidth>{super.renderComponent()}</Main>\n      </Body>\n    );\n  }\n}\n\nexport default withReleaseRepos(FilesChanged);\n\nconst StyledFileChange = styled(FileChange)`\n  border-radius: 0;\n  border-left: none;\n  border-right: none;\n  border-top: none;\n  :last-child {\n    border: none;\n    border-radius: 0;\n  }\n`;\n"],"names":["AvatarList","avatarSize","maxVisibleAvatars","typeMembers","tooltipOptions","className","users","renderTooltip","visibleUsers","slice","numCollapsedUsers","length","position","AvatarListWrapper","title","CollapsedUsers","size","Plus","map","user","StyledAvatar","hasTooltip","id","email","Circle","p","css","theme","background","UserAvatar","gray200","gray300","Math","floor","FileIcon","fileName","providedSize","fileExtension","getFileExtension","iconName","fileExtensionToPlatform","src","require","width","height","ListGroupItem","border","space","centered","borderRadius","FileChange","filename","authors","FileItem","Filename","StyledFileIcon","fontSizeMedium","FilesChanged","AsyncView","getTitle","params","projectSlug","this","props","orgId","routeTitleGen","t","formatVersion","release","getDefaultState","super","fileList","componentDidUpdate","prevProps","prevState","activeReleaseRepo","name","remountComponent","getEndpoints","activeRepository","location","orgSlug","query","getQuery","encodeURIComponent","renderLoading","renderBody","renderContent","fileListPageLinks","loading","state","filesByRepository","getFilesByRepository","reposToRender","getReposToRender","Object","keys","Fragment","repoName","repoData","files","fileCount","tn","StyledFileChange","values","pageLinks","releaseRepos","router","repositories","renderComponent","fullWidth","withReleaseRepos"],"sourceRoot":""}