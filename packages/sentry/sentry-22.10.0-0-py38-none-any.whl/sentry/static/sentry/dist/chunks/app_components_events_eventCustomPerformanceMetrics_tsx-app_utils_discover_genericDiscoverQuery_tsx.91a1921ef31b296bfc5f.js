"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_eventCustomPerformanceMetrics_tsx-app_utils_discover_genericDiscoverQuery_tsx"],{"./app/components/events/eventCustomPerformanceMetrics.tsx":(e,t,s)=>{s.d(t,{BB:()=>x,ZP:()=>f,gu:()=>g});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("./app/components/charts/styles.tsx")),o=s("./app/components/dropdownMenuControl.tsx"),i=s("./app/components/panels/index.tsx"),a=s("./app/icons/index.tsx"),c=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),l=s("./app/utils/discover/eventView.tsx"),d=s("./app/utils/discover/fieldRenderers.tsx"),p=s("./app/views/dashboardsV2/utils.tsx"),m=s("./app/views/performance/transactionSummary/utils.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let g;function v(e){return!e.startsWith("mark.")}function f(e){let{event:t,location:s,organization:r,source:o}=e;const i=Object.keys(t.measurements??{}).filter((e=>(0,p.nk)(`measurements.${e}`))).filter(v).sort();return 0===i.length?null:(0,h.BX)(w,{children:[(0,h.tZ)(n.OT,{children:(0,c.t)("Custom Performance Metrics")}),(0,h.tZ)(b,{children:i.map((e=>(0,h.tZ)(y,{event:t,name:e,location:s,organization:r,source:o},e)))})]})}function x(e){return e?d.a_[e]?"duration":d.en[e]?"size":d.eg.includes(e)?"percentage":"none"===e?"integer":"string":"number"}function y(e){let{event:t,name:s,location:r,organization:n,source:o}=e;const{value:i,unit:u}=t.measurements?.[s]??{};if(null===i)return null;const p=x(u),v="string"===p?`${i} ${u}`:i,f=p?d.Yd[p].renderFunc(s,{[s]:v},{location:r,organization:n,unit:u}):v;function y(e){const s=l.ZP.fromLocation(r);switch(s.query=e,o){case g.PERFORMANCE:return(0,m.e1)({orgSlug:n.slug,transaction:t.title,projectID:t.projectID,query:{query:e}});case g.DISCOVER:default:return s.getResultsViewUrlTarget(n.slug)}}let b=i;return"number"==typeof i&&u&&b&&(Object.keys(d.en).includes(u)?b*=d.en[u]:Object.keys(d.a_).includes(u)&&(b*=d.a_[u])),(0,h.BX)(Z,{children:[(0,h.BX)("div",{children:[(0,h.tZ)("div",{children:s}),(0,h.tZ)(E,{children:(0,h.tZ)(D,{children:f})})]}),(0,h.tZ)(_,{items:[{key:"includeEvents",label:(0,c.t)("Show events with this value"),to:y(`measurements.${s}:${b}`)},{key:"excludeEvents",label:(0,c.t)("Hide events with this value"),to:y(`!measurements.${s}:${b}`)},{key:"includeGreaterThanEvents",label:(0,c.t)("Show events with values greater than"),to:y(`measurements.${s}:>${b}`)},{key:"includeLessThanEvents",label:(0,c.t)("Show events with values less than"),to:y(`measurements.${s}:<${b}`)}],triggerProps:{"aria-label":(0,c.t)("Widget actions"),size:"xs",borderless:!0,showChevron:!1,icon:(0,h.tZ)(a.YR,{direction:"down",size:"sm"})},position:"bottom-end"})]})}!function(e){e.PERFORMANCE="performance",e.DISCOVER="discover"}(g||(g={})),f.displayName="EventCustomPerformanceMetrics",y.displayName="EventCustomPerformanceMetric";const b=(0,r.Z)("div",{target:"etadham5"})("display:grid;grid-column-gap:",(0,u.Z)(1),";"),w=(0,r.Z)("div",{target:"etadham4"})("font-size:",(e=>e.theme.fontSizeMedium),";margin-bottom:",(0,u.Z)(4),";"),Z=(0,r.Z)(i.s_,{target:"etadham3"})("padding:",(0,u.Z)(1)," ",(0,u.Z)(1.5),";margin-bottom:",(0,u.Z)(1),";display:flex;"),E=(0,r.Z)("div",{target:"etadham2"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),D=(0,r.Z)("span",{target:"etadham1"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";"),_=(0,r.Z)(o.Z,{target:"etadham0"})({name:"1o3nkn",styles:"margin-left:auto"})},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{AA:()=>v,JC:()=>x,ZP:()=>y,o:()=>m});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@tanstack/react-query/build/umd/index.production.js"),i=s("./app/api.tsx"),a=s("./app/locale.tsx"),c=s("./app/utils/discover/eventView.tsx"),u=s("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=s("./app/views/organizationContext.tsx"),d=s("./app/utils/useApi.tsx"),p=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class m{constructor(e,t){(0,r.Z)(this,"message",void 0),(0,r.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class h extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null,api:new i.KU}),(0,r.Z)(this,"_shouldRefetchData",(e=>{const t=f(this.props),s=f(e);return!(0,c.ze)(t,s)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,r.Z)(this,"_parseError",(e=>{if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const t=e.responseJSON?.detail;if("string"==typeof t)return new m(t,e);const s=t?.message;return new m("string"==typeof s?s:(0,a.t)("An unknown error occurred."),e)})),(0,r.Z)(this,"fetchData",(async()=>{const{queryBatching:e,beforeFetch:t,afterFetch:s,didFetch:r,eventView:n,orgSlug:o,route:i,setError:a}=this.props,{api:c}=this.state;if(!n.isValid())return;const u=`/organizations/${o}/${i}/`,l=Symbol("tableFetchID"),d=f(this.props);this.setState({isLoading:!0,tableFetchID:l}),a?.(void 0),t?.(c),c.clear();try{const[t,,n]=await v(c,u,d,e);if(this.state.tableFetchID!==l)return;const o=s?s(t,this.props):t;r?.(o),this.setState((e=>({isLoading:!1,tableFetchID:void 0,error:null,pageLinks:n?.getResponseHeader("Link")??e.pageLinks,tableData:o})))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),a&&a(t??void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),s=!1===e.eventView.isValid()&&this.props.eventView.isValid(),r=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||s||r)&&this.fetchData()}render(){const{isLoading:e,error:t,tableData:s,pageLinks:r}=this.state,n={isLoading:e,error:t,tableData:s,pageLinks:r};return(0,this.props.children)?.(n)}}function g(e){const t=(0,n.useContext)(l.g)?.slug,s=(0,n.useContext)(u.uL)?.eventView,r=e.orgSlug??t,o=e.eventView??s;if(void 0===r||void 0===o)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const i={...e,orgSlug:r,eventView:o};return(0,p.tZ)(h,{...i})}function v(e,t,s,r){return r?.batchRequest?r.batchRequest(e,t,{query:s,includeAllArgs:!0}):e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...s}})}function f(e){const{cursor:t,limit:s,noPagination:r,referrer:n,getRequestPayload:o,eventView:i,location:a,forceAppendRawQueryString:c}=e,u=o?o(e):i.getEventsAPIPayload(a,c);return t&&(u.cursor=t),s&&(u.per_page=s),r&&(u.noPagination=r),n&&(u.referrer=n),Object.assign(u,e.queryExtras??{}),u}function x(e){const t=(0,d.Z)(),{orgSlug:s,route:r}=e,n=`/organizations/${s}/${r}/`,i=f(e);return(0,o.useQuery)([r,i],(async()=>{const[s]=await v(t,n,i,e.queryBatching);return s}))}h.displayName="_GenericDiscoverQuery",g.displayName="GenericDiscoverQuery";const y=g},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,s)=>{s.d(t,{bq:()=>n,uL:()=>i});var r=s("./app/utils/performance/contexts/utils.tsx");const[n,o,i]=(0,r.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,s)=>{s.d(t,{n:()=>n}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/react/index.js");function n(e){const{strict:t=!0,errorMessage:s=`useContext for "${e.name}" must be inside a Provider with a value`,name:n}=e,o=(0,r.createContext)(void 0);return o.displayName=n,[o.Provider,function(){const e=(0,r.useContext)(o);if(!e&&t)throw new Error(s);return e},o]}}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_eventCustomPerformanceMetrics_tsx-app_utils_discover_genericDiscoverQuery_tsx.6ba7a1aa2298e6bcc2131656c252e531.js.map