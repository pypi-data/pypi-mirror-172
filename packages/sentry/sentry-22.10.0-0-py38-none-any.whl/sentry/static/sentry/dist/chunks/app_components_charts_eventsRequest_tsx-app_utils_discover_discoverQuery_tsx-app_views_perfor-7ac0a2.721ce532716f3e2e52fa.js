(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_eventsRequest_tsx-app_utils_discover_discoverQuery_tsx-app_views_perfor-7ac0a2"],{"./app/actionCreators/events.tsx":(e,t,s)=>{"use strict";s.d(t,{JE:()=>c,eV:()=>d,lI:()=>l});var r=s("../node_modules/lodash/pick.js"),n=s.n(r),a=s("./app/components/charts/utils.tsx"),i=s("./app/utils/getPeriod.tsx"),o=s("./app/utils/performance/constants.tsx");const l=(e,t)=>{let{organization:s,project:r,environment:n,team:o,period:l,start:d,end:c,interval:u,comparisonDelta:p,includePrevious:m,query:h,yAxis:v,field:g,topEvents:f,orderby:x,partial:y,withoutZerofill:Z,referrer:b,queryBatching:w,generatePathname:D,queryExtras:_,excludeOther:j,includeAllArgs:P}=t;const S=D?.(s)??`/organizations/${s.slug}/events-stats/`,C=(0,a.Sw)(m,l),k={includeAllArgs:P,query:{...Object.fromEntries(Object.entries({interval:u,comparisonDelta:p,project:r,environment:n,team:o,query:h,yAxis:v,field:g,topEvents:f,orderby:x,partial:y?"1":void 0,withoutZerofill:Z?"1":void 0,referrer:b||"api.organization-event-stats",excludeOther:j?"1":void 0}).filter((e=>{let[,t]=e;return void 0!==t}))),...(0,i.X)({period:l,start:d,end:c},{shouldDoublePeriod:C}),..._}};return w?.batchRequest?w.batchRequest(e,S,k):e.requestPromise(S,k)};function d(e,t,s){const r={...n()(s,Object.values(o.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-facets/`,{query:r})}function c(e,t,s){const r={...n()(s,Object.values(o.s)),query:s.query};return e.requestPromise(`/organizations/${t}/events-meta/`,{query:r}).then((e=>e.count))}},"./app/components/charts/barChartZoom.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/react/index.js"),a=s("../node_modules/react-router/es/index.js"),i=s("./app/components/charts/components/dataZoomInside.tsx"),o=s("./app/components/charts/components/toolBox.tsx");class l extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"zooming",null),(0,r.Z)(this,"handleChartReady",(e=>{this.props.onChartReady?.(e)})),(0,r.Z)(this,"handleChartFinished",((e,t)=>{"function"==typeof this.zooming&&(this.zooming(),this.zooming=null);const s=t._componentsViews?.find((e=>e._features&&e._features.dataZoom));s&&!s._features.dataZoom._isZoomActive&&t.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:!0})})),(0,r.Z)(this,"handleDataZoom",((e,t)=>{const s=t.getModel(),{startValue:r,endValue:n}=s._payload.batch[0];if(null!==r&&null!==n){const{buckets:e,location:s,paramStart:i,paramEnd:o,minZoomWidth:l,onHistoryPush:d}=this.props,{start:c}=e[r],{end:u}=e[n];if(void 0===l||u-c>l){const e={pathname:s.pathname,query:{...s.query,[i]:c,[o]:u}};d?d(c,u):a.browserHistory.push(e)}else t.dispatchAction({type:"restore"}),this.props.onDataZoomCancelled?.()}else t.dispatchAction({type:"restore"}),this.props.onDataZoomCancelled?.();this.props.onDataZoom?.(e,t)}))}render(){const{children:e,xAxisIndex:t}=this.props;return e({onChartReady:this.handleChartReady,onFinished:this.handleChartFinished,dataZoom:(0,i.Z)({xAxisIndex:t}),toolBox:(0,o.Z)({},{dataZoom:{title:{zoom:"",back:""},iconStyle:{borderWidth:0,color:"transparent",opacity:0}}}),onDataZoom:this.handleDataZoom})}}l.displayName="BarChartZoom";const d=l},"./app/components/charts/components/dataZoomInside.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>n}),s("../node_modules/echarts/lib/component/dataZoomInside.js");const r={type:"inside",zoomOnMouseWheel:!1,zoomLock:!0,throttle:50};function n(e){return e&&Array.isArray(e)?e:[{...r,...e}]}},"./app/components/charts/components/toolBox.tsx":(e,t,s)=>{"use strict";function r(){let{dataZoom:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{...e?{dataZoom:{yAxisIndex:"none",title:{zoom:"zoom",back:"undo"},...e}}:{},...t}}function n(e,t){return{right:0,top:0,itemSize:16,z:-1,feature:r(t),...e}}s.d(t,{Z:()=>n})},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>b});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.includes.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/isEqual.js"),i=s.n(a),o=s("../node_modules/lodash/omitBy.js"),l=s.n(o),d=s("./app/actionCreators/events.tsx"),c=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/charts/loadingPanel.tsx"),p=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("./app/utils.tsx"),v=s("./app/utils/discover/fieldRenderers.tsx"),g=s("./app/utils/discover/fields.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x=["api","children","organization","loading","queryBatching","generatePathname"],y=e=>l()(e,((e,t)=>x.includes(t)));class Z extends n.PureComponent{constructor(){var e;super(...arguments),e=this,(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,onError:s,expired:r,name:n,hideError:a,...i}=this.props;let o,l=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1,errorMessage:void 0}))),r)o=(0,m.t)("%s has an invalid date range. Please try a more recent date range.",n),(0,c.Iw)(o,{append:!0}),this.setState({errored:!0,errorMessage:o});else try{e.clear(),l=await(0,d.lI)(e,i)}catch(e){o=e&&e.responseJSON&&e.responseJSON.detail?e.responseJSON.detail:(0,m.t)("Error loading chart data"),a||(0,c.Iw)(o),s&&s(o),this.setState({errored:!0,errorMessage:o})}this.unmounting||(this.setState({reloading:!1,timeseriesData:l,fetchedWithPrevious:i.includePrevious}),i.dataLoadedCallback&&i.dataLoadedCallback(l))}})),(0,r.Z)(this,"getData",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{fetchedWithPrevious:s}=e.state,{period:r,includePrevious:n}=e.props,a=s||(0,p.Sw)(n,r),i=Math.floor(t.length/2);return{current:a?t.slice(i):t,previous:a?t.slice(0,i):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){i()(y(e),y(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>1e3*e;return e.map(((e,s)=>{let[r,n]=e;return{name:t(r,n,s),value:n.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)}}))}transformPreviousPeriodData(e,t,s){return t?{seriesName:s??"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,r)=>1e3*e[r][0])),stack:"previous"}:null}transformAggregatedTimeseries(e){return{seriesName:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t,s){let r=1;if(s){const e=t?.units?.[(0,g.LY)(s)];r=(e&&(v.a_[e]??v.en[e]))??1}return[{seriesName:s||"Current",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{count:s}=t;return e+s}),0)*r}}))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((e=>{let[t,s]=e;return{name:1e3*t,value:s.reduce(((e,t)=>{let{comparisonCount:s}=t;return e+(s??0)}),0)}}))}]}processData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;const{data:r,isMetricsData:n,totals:a,meta:i}=e,{includeTransformedData:o,includeTimeAggregation:l,timeAggregationSeriesName:d,currentSeriesNames:c,previousSeriesNames:u,comparisonDelta:m}=this.props,{current:h,previous:v}=this.getData(r);return{data:o?this.transformTimeseriesData(h,i,s??c?.[t]):[],comparisonData:o&&m?this.transformComparisonTimeseriesData(h):[],allData:r,originalData:h,totals:a,isMetricsData:n,originalPreviousData:v,previousData:o?this.transformPreviousPeriodData(h,v,(s?(0,p.TE)(s):void 0)??u?.[t]):null,timeAggregatedData:l?this.transformAggregatedTimeseries(h,d||""):{},timeframe:e.start&&e.end?v?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{topEvents:r,yAxis:n}=this.props,{timeseriesData:a,reloading:i,errored:o,errorMessage:l}=this.state,d=this.props.loading||null===a;if(t&&d)return(0,f.tZ)(u.Z,{"data-test-id":"events-request-loading"});if((0,p.Xe)(a,(0,h.ri)(r))){let t;const r={},n=Object.keys(a).map(((e,s)=>{const n=a[e],i=this.processData(n,s,(0,g.bQ)(e));return t||(t=i.timeframe),i.isMetricsData&&(r[e]={isMetricsData:i.isMetricsData}),[n.order||0,i.data[0],i.previousData,{isMetricsData:i.isMetricsData}]})).sort(((e,t)=>e[0]-t[0])),c={};Object.keys(a).forEach((e=>{const t=a[e].meta?.fields[(0,g.LY)(e)];t&&(c[e]=t)}));const u=n.map((e=>e[1])),p=n.some((e=>null===e[2]))?void 0:n.map((e=>e[2]));return e({loading:d,reloading:i,errored:o,errorMessage:l,results:u,timeframe:t,previousTimeseriesData:p,seriesAdditionalInfo:r,timeseriesResultsTypes:c,...s})}if(a){const t=n&&("string"==typeof n?n:n[0]),r=t&&a.meta?.fields[(0,g.LY)(t)],c=r?{[t]:r}:void 0,{data:u,comparisonData:p,allData:m,originalData:h,totals:v,originalPreviousData:f,previousData:x,timeAggregatedData:y,timeframe:Z,isMetricsData:b}=this.processData(a);return e({loading:d,reloading:i,errored:o,errorMessage:l,seriesAdditionalInfo:{[this.props.currentSeriesNames?.[0]??"current"]:{isMetricsData:b}},timeseriesData:u,comparisonTimeseriesData:p,allTimeseriesData:m,originalTimeseriesData:h,timeseriesTotals:v,originalPreviousTimeseriesData:f,previousTimeseriesData:x?[x]:x,timeAggregatedData:y,timeframe:Z,timeseriesResultsTypes:c,...s})}return e({loading:d,reloading:i,errored:o,errorMessage:l,...s})}}Z.displayName="EventsRequest",(0,r.Z)(Z,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const b=Z},"./app/components/charts/loadingPanel.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/loadingMask.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,r.Z)((e=>{let{height:t,...s}=e;return(0,a.tZ)("div",{...s,children:(0,a.tZ)(n.Z,{})})}),{target:"eumb2md0"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");i.defaultProps={height:"200px"};const o=i},"./app/components/charts/transparentLoadingMask.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/loadingMask.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=(0,r.Z)((e=>{let{className:t,visible:s,children:r,...i}=e;const o=s?{...i,"data-test-id":"loading-placeholder"}:i;return(0,a.tZ)(n.Z,{className:t,...o,children:r})}),{target:"ewtkxp50"})((e=>!e.visible&&"display: none;"),";opacity:0.4;z-index:1;")},"./app/components/loadingMask.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});const r=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e1dnwgq10"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>l,_:()=>o});var r=s("./app/utils/discover/genericDiscoverQuery.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function i(e){const t=e.useEvents?"events":"eventsv2",s=e.useEvents?(e,t)=>{const{fields:s,...r}=e.meta??{};return{...e,meta:{...s,...r}}}:void 0;return(0,n.tZ)(r.ZP,{route:t,shouldRefetchData:a,afterFetch:s,...e})}function o(e){const t=e.useEvents?"events":"eventsv2",s=e.useEvents?(e,t)=>{const{fields:s,...r}=e.meta??{};return{...e,meta:{...s,...r}}}:void 0;return(0,r.JC)({route:t,shouldRefetchData:a,afterFetch:s,...e})}i.displayName="DiscoverQuery";const l=i},"./app/utils/getPeriod.tsx":(e,t,s)=>{"use strict";s.d(t,{X:()=>o}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/moment/moment.js"),n=s.n(r),a=s("./app/constants/index.tsx"),i=s("./app/utils/dates.tsx");function o(e){let{period:t,start:s,end:r}=e,{shouldDoublePeriod:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t||s||r||(t=a.GY),t){if(!o)return{statsPeriod:t};const[,e,s]=t.match(/([0-9]+)([mhdw])/);return{statsPeriod:`${2*parseInt(e,10)}${s}`}}if(!s||!r)throw new Error("start and end required");const l=(0,i.v5)(s),d=(0,i.v5)(r);if(o){const e=n()(r).diff(n()(s)),t=n()(s).subtract(e);return{start:(0,i.v5)(t),end:d}}return{start:l,end:d}}},"./app/utils/performance/histogram/constants.tsx":(e,t,s)=>{"use strict";s.d(t,{d:()=>n});var r=s("./app/locale.tsx");const n=[{label:(0,r.t)("Exclude"),value:"exclude_outliers"},{label:(0,r.t)("Include"),value:"all"}]},"./app/utils/performance/histogram/histogramQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s("../node_modules/react/index.js"),n=s("../node_modules/lodash/omit.js"),a=s.n(n),i=s("./app/utils/discover/genericDiscoverQuery.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){const{fields:t,numBuckets:s,min:r,max:n,precision:i,dataFilter:o,eventView:l,location:d}=e,c={field:t,numBuckets:s,min:r,max:n,precision:i,dataFilter:o},u=a()(l.getEventsAPIPayload(d),["field","sort","per_page"]);return Object.assign(c,u)}function d(e){const{children:t,fields:s,didReceiveMultiAxis:n}=e;return 0===s.length?(0,o.tZ)(r.Fragment,{children:t({isLoading:!1,error:null,pageLinks:null,histograms:{}})}):(0,o.tZ)(i.ZP,{route:"events-histogram",getRequestPayload:l,didFetch:function(e){if(n){const t={};Object.entries(e).forEach((e=>{let[s,r]=e;return t[s]=r.length?r.reduce(((e,t)=>e+t.count),0):0})),n(t)}},...a()(e,"children"),children:t=>{let{tableData:s,...r}=t;return e.children({histograms:s,...r})}})}d.displayName="HistogramQuery";const c=d},"./app/utils/performance/histogram/index.tsx":(e,t,s)=>{"use strict";s.d(t,{V:()=>d,Z:()=>c});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/react/index.js"),a=s("../node_modules/react-router/es/index.js"),i=s("./app/utils/queryString.tsx"),o=s("./app/utils/performance/histogram/constants.tsx");class l extends n.Component{constructor(){super(...arguments),(0,r.Z)(this,"handleResetView",(()=>{const{location:e,zoomKeys:t}=this.props;a.browserHistory.push({pathname:e.pathname,query:d(e,t)})})),(0,r.Z)(this,"handleFilterChange",(e=>{const{location:t,zoomKeys:s}=this.props;a.browserHistory.push({pathname:t.pathname,query:{...d(t,s),dataFilter:e}})}))}isZoomed(){const{location:e,zoomKeys:t}=this.props;return t.map((t=>e.query[t])).some((e=>void 0!==e))}getActiveFilter(){const{location:e}=this.props,t=e.query.dataFilter?(0,i.ro)(e.query.dataFilter):o.d[0].value;return o.d.find((e=>e.value===t))||o.d[0]}render(){const e={isZoomed:this.isZoomed(),handleResetView:this.handleResetView,activeFilter:this.getActiveFilter(),handleFilterChange:this.handleFilterChange,filterOptions:o.d};return this.props.children(e)}}function d(e,t){const s={...e.query,cursor:void 0};return delete s.dataFilter,t.forEach((e=>delete s[e])),s}l.displayName="Histogram";const c=l},"./app/utils/performance/quickTrace/utils.tsx":(e,t,s)=>{"use strict";s.d(t,{$J:()=>y,Ci:()=>D,R8:()=>v,S2:()=>Z,_Z:()=>x,eF:()=>f,eW:()=>m,hp:()=>u,q2:()=>p,xB:()=>b,y3:()=>w}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/lodash/omit.js"),n=s.n(r),a=s("../node_modules/moment-timezone/index.js"),i=s.n(a),o=s("./app/components/events/interfaces/spans/utils.tsx"),l=s("./app/constants/pageFilters.tsx"),d=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=s("./app/utils/discover/eventView.tsx");function u(e){return"transaction"===e.type}function p(e,t){return u(t)?e.event_id===t.id:void 0!==e.errors&&e.errors.some((e=>e.event_id===t.id))}function m(e,t){const s=[],r=[],n=[{event:t,path:[]}];for(;n.length;){const t=n.shift();if(p(t.event,e)){for(const e of t.path)s.push(e);r.push(t.event)}else{const e=[...t.path,h(t.event)];for(const s of t.event.children)n.push({event:s,path:e})}}if(!r.length)throw new Error("No relevant path exists!");for(;r.length;){const e=r.shift();for(const t of e.children)r.push(t);s.push(h(e))}return s}function h(e){return n()(e,["children"])}function v(e,t,s){const{type:r,trace:n}=e;if("empty"===r||null===n)throw new Error("Current event not in trace navigator!");const a="full"===r,i=n.find((e=>p(e,t)))??null;if(null===i)throw new Error("Current event not in trace navigator!");const o=i.parent_event_id?n.find((e=>e.event_id===i.parent_event_id))??null:null,l=n.find((e=>e.event_id!==i.event_id&&e.event_id!==o?.event_id&&0===e.generation))??null,c=a?[]:null,u=[],m=a?[]:null,h=new Set;return n.forEach((e=>{h.add(e.project_id),(e=>e.parent_event_id===i.event_id)(e)?u.push(e):a&&((e=>null!==i.generation&&null!==e.generation&&e.generation>0&&i.generation-1>e.generation)(e)?c?.push(e):(e=>null!==i.generation&&null!==e.generation&&i.generation+1<e.generation)(e)&&m?.push(e))})),a&&h.size>1&&function(e,t){(0,d.Z)("quick_trace.connected_services",{organization:e.id,projects:t})}(s,h.size),{root:l,ancestors:null===c?null:g(c),parent:o,current:i,children:g(u),descendants:null===m?null:g(m)}}function g(e){return e.sort(((e,t)=>t["transaction.duration"]-e["transaction.duration"]))}function f(e){let{eventView:t,location:s}=e;return n()(t.getEventsAPIPayload(s),["field","sort","per_page"])}function x(e){let{start:t,end:s,statsPeriod:r}=e;return c.ZP.fromSavedQuery({id:void 0,version:2,name:"",fields:["transaction.duration"],projects:[l.mP],query:"",environment:[],start:t,end:s,range:r??void 0})}function y(e){const t=u(e)?e.startTimestamp:i()(e.dateReceived?e.dateReceived:e.dateCreated).valueOf()/1e3,s=u(e)?e.endTimestamp:t;return(0,o.TC)({start:t,end:s})}function Z(e,t,s){let r=s;const n=[e];for(;n.length;){const e=n.pop();for(const t of e.children)n.push(t);r=t(r,e)}return r}function b(e,t){return Z(e,((e,s)=>(t(s)&&e.push(s),e)),[])}function w(e){return Boolean(e.event_id)}function D(e){return Boolean(e.event_id)}},"./app/utils/performance/urls.ts":(e,t,s)=>{"use strict";s.d(t,{D:()=>a});var r=s("./app/components/events/interfaces/spans/utils.tsx"),n=s("./app/utils.tsx");function a(e,t,s,a,i){const o={...a||{},transaction:s};(0,n.ri)(o.transaction)||delete o.transaction;const l={pathname:`/organizations/${e}/performance/${t}/`,query:o,hash:(0,n.ri)(i)?(0,r.ct)(i):void 0};return(0,n.ri)(l.hash)||delete l.hash,l}},"./app/views/performance/traceDetails/utils.tsx":(e,t,s)=>{"use strict";s.d(t,{Rg:()=>i,YA:()=>a,uM:()=>o});var r=s("./app/constants/pageFilters.tsx"),n=s("./app/utils/performance/quickTrace/utils.tsx");function a(e,t,s,n){const{start:a,end:i,statsPeriod:o}=s;return{pathname:`/organizations/${e.slug}/performance/trace/${t}/`,query:{...n,statsPeriod:o,[r.V.PAGE_START]:a,[r.V.PAGE_END]:i}}}function i(e){const t={projects:new Set,errors:new Set,transactions:new Set,startTimestamp:Number.MAX_SAFE_INTEGER,endTimestamp:0,maxGeneration:0};return e.reduce(((e,t)=>(0,n.S2)(t,((e,t)=>{for(const s of t.errors??[])e.errors.add(s.event_id);return e.transactions.add(t.event_id),e.projects.add(t.project_slug),e.startTimestamp=Math.min(e.startTimestamp,t.start_timestamp),e.endTimestamp=Math.max(e.endTimestamp,t.timestamp),e.maxGeneration=Math.max(e.maxGeneration,t.generation),e}),e)),t)}function o(e){return null===e.parent_span_id}},"./app/views/performance/transactionSummary/transactionVitals/constants.tsx":(e,t,s)=>{"use strict";s.d(t,{GW:()=>o,PE:()=>c,QB:()=>u,sE:()=>i});var r=s("./app/utils/fields/index.ts"),n=s("./app/utils/performance/vitals/constants.tsx"),a=s("./app/utils/theme.tsx");const i=100,o=.75,l=[{vitals:[r.Zl.FP,r.Zl.FCP,r.Zl.LCP],min:0},{vitals:[r.Zl.FID],min:0,precision:2},{vitals:[r.Zl.CLS],min:0,precision:2}],d=[...a.ZP.charts.getColorPalette(l.reduce(((e,t)=>{let{vitals:s}=t;return e+s.length}),0)-1)].reverse(),c=l.map((e=>({...e,colors:d.splice(0,e.vitals.length)}))),u=l.reduce(((e,t)=>{let{vitals:s}=t;return s.forEach((t=>{const s=n.r9[t].slug;e.push(`${s}Start`),e.push(`${s}End`)})),e}),[])},"./app/views/performance/transactionSummary/transactionVitals/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>be});var r=s("./app/locale.tsx"),n=s("./app/utils/discover/eventView.tsx"),a=s("./app/utils/discover/fields.tsx"),i=s("./app/utils/performance/vitals/constants.tsx"),o=s("./app/utils/queryString.tsx"),l=s("./app/utils/tokenizeSearch.tsx"),d=s("./app/utils/withOrganization.tsx"),c=s("./app/utils/withProjects.tsx"),u=s("./app/views/performance/transactionSummary/pageLayout.tsx"),p=s("./app/views/performance/transactionSummary/tabs.tsx"),m=s("./app/views/performance/transactionSummary/transactionVitals/constants.tsx"),h=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),v=s("../node_modules/react/index.js"),g=s("../node_modules/react-router/es/index.js"),f=s("./app/components/alert.tsx"),x=s("./app/components/button.tsx"),y=s("./app/components/compactSelect.tsx"),Z=s("./app/components/datePageFilter.tsx"),b=s("./app/components/environmentPageFilter.tsx"),w=s("./app/components/events/searchBar.tsx"),D=s("./app/components/layouts/thirds.tsx"),_=s("./app/components/links/externalLink.tsx"),j=s("./app/components/organizations/pageFilterBar.tsx"),P=s("./app/components/organizations/pageFilters/parse.tsx"),S=s("./app/styles/space.tsx"),C=s("./app/utils/analytics.tsx"),k=s("./app/utils/performance/histogram/index.tsx"),z=s("./app/utils/performance/histogram/constants.tsx"),q=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),E=s("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),T=s("./app/components/panels/index.tsx"),F=s("./app/utils/performance/histogram/histogramQuery.tsx"),V=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),R=s("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),A=s("../node_modules/lodash/isEqual.js"),M=s.n(A),N=s("../node_modules/lodash/throttle.js"),L=s.n(N),$=s("./app/components/charts/barChart.tsx"),O=s("./app/components/charts/barChartZoom.tsx"),I=s("./app/components/charts/components/markLine.tsx"),B=s("./app/components/charts/transparentLoadingMask.tsx"),W=s("./app/components/placeholder.tsx"),G=s("./app/utils/formatters.tsx"),Q=s("./app/utils/getDynamicText.tsx"),H=s("./app/utils/performance/histogram/utils.tsx"),K=s("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),X=s("./app/views/performance/landing/vitalsCards.tsx"),Y=s("./app/views/performance/vitalDetail/utils.tsx"),J=s("./app/components/charts/styles.tsx");const U=(0,h.Z)(T.Lv,{target:"e1l3pu0z5"})({name:"1slq3zi",styles:"display:grid;grid-template-columns:325px minmax(100px, auto);padding:0"}),ee=(0,h.Z)("div",{target:"e1l3pu0z4"})("padding:",(0,S.Z)(3),";"),te=(0,h.Z)(ee,{target:"e1l3pu0z3"})("position:relative;border-right:1px solid ",(e=>e.theme.border),";grid-column:1/1;display:flex;flex-direction:column;justify-content:space-between;"),se=(0,h.Z)(J.OT,{target:"e1l3pu0z2"})({name:"cfjpzu",styles:"margin:0px"}),re=(0,h.Z)("div",{target:"e1l3pu0z1"})("font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";"),ne=(0,h.Z)("div",{target:"e1l3pu0z0"})({name:"5r9nha",styles:"font-size:32px"});var ae=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class ie extends v.Component{constructor(){super(...arguments),(0,V.Z)(this,"state",{refDataRect:null,refPixelRect:null}),(0,V.Z)(this,"trackOpenInDiscoverClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,C.ec)({eventKey:"performance_views.vitals.open_in_discover",eventName:"Performance Views: Open vitals in discover",organization_id:e.id,vital:t.slug})})),(0,V.Z)(this,"trackOpenAllEventsClicked",(()=>{const{organization:e}=this.props,{vitalDetails:t}=this.props;(0,C.ec)({eventKey:"performance_views.vitals.open_all_events",eventName:"Performance Views: Open vitals in all events",organization_id:e.id,vital:t.slug})})),(0,V.Z)(this,"handleRendered",L()(((e,t)=>{const{chartData:s}=this.props,{refDataRect:r}=this.state;if(null===r||s.length<1)return;const n=null===r?null:(0,E.L0)(t,r);null===n||M()(n,this.state.refPixelRect)||this.setState({refPixelRect:n})}),200,{leading:!0})),(0,V.Z)(this,"handleDataZoomCancelled",(()=>{}))}static getDerivedStateFromProps(e,t){const{isLoading:s,error:r,chartData:n}=e;if(s||null===r)return{...t};const a=(0,E.eH)(n);return null===t.refDataRect||null!==a&&!M()(a,t.refDataRect)?{...t,refDataRect:a}:{...t}}get summary(){const{summaryData:e}=this.props;return e?.p75??null}get failureRate(){const{summaryData:e}=this.props,t=e?.poor??0,s=e?.total??0;return s<=0?0:t/s}getFormattedStatNumber(){const{vitalDetails:e}=this.props,t=this.summary,{type:s}=e;return null===t?"—":"duration"===s?(0,G.g9)(t/1e3,2,!0):(0,G.$1)(t,2)}renderSummary(){const{vitalDetails:e,eventView:t,organization:s,min:n,max:i,dataFilter:o}=this.props,{slug:d,name:c,description:u}=e,p=`measurements.${d}`,h=t.withColumns([{kind:"field",field:"transaction"},{kind:"function",function:["percentile",p,m.GW.toString(),void 0]},{kind:"function",function:["count","","",void 0]}]).withSorts([{kind:"desc",field:(0,a.LY)(`percentile(${p},${m.GW.toString()})`)}]),v=new l.MY(h.query??"");return v.addFilterValues("has",[p]),void 0===n&&void 0===i||(void 0!==n&&v.addFilterValues(p,[`>=${n}`]),void 0!==i&&v.addFilterValues(p,[`<=${i}`])),h.query=v.formatString(),(0,ae.BX)(te,{children:[(0,ae.tZ)(oe,{children:(0,ae.tZ)(se,{children:`${c} (${d.toUpperCase()})`})}),(0,ae.tZ)(ne,{children:(0,Q.Z)({value:this.getFormattedStatNumber(),fixed:"—"})}),(0,ae.tZ)(re,{children:u}),(0,ae.tZ)("div",{children:(0,ae.tZ)(x.ZP,{size:"xs",to:h.withColumns([{kind:"field",field:p}]).withSorts([{kind:"desc",field:p}]).getPerformanceTransactionEventsViewUrlTarget(s.slug,{showTransactions:"all"===o?K.q3.p100:K.q3.p75,webVital:p}),onClick:this.trackOpenAllEventsClicked,children:(0,r.t)("View All Events")})})]})}renderHistogram(){const{theme:e,location:t,isLoading:s,chartData:r,summaryData:n,error:a,colors:i,vital:o,vitalDetails:l,precision:d=0}=this.props,{slug:c}=l,u=this.getSeries(),p={type:"category",truncate:!0,axisTick:{alignWithLabel:!0}},h=u.data.map((e=>e.value)),v={type:"value",max:h.length?Math.max(...h):void 0,axisLabel:{color:e.chartLabel,formatter:G.Du}},g=[u];if(!s&&!a){const e=this.getBaselineSeries();null!==e&&g.push(e)}const f=s||a||null===n?{}:{[o]:n};return(0,ae.tZ)(O.Z,{minZoomWidth:10**-d*m.sE,location:t,paramStart:`${c}Start`,paramEnd:`${c}End`,xAxisIndex:[0],buckets:(0,H._W)(r),onDataZoomCancelled:this.handleDataZoomCancelled,children:e=>(0,ae.BX)(le,{children:[(0,ae.tZ)(B.Z,{visible:s}),(0,ae.tZ)(de,{children:(0,ae.tZ)(X.JO,{isLoading:s,data:f,vital:o,showBar:!1,showStates:!1,showVitalPercentNames:!1,showVitalThresholds:!1,showDurationDetail:!1})}),(0,Q.Z)({value:(0,ae.tZ)($.v,{series:g,xAxis:p,yAxis:v,colors:i,onRendered:this.handleRendered,grid:{left:(0,S.Z)(3),right:(0,S.Z)(3),top:(0,S.Z)(3),bottom:(0,S.Z)(1.5)},stacked:!0,...e}),fixed:(0,ae.tZ)(W.Z,{testId:"skeleton-ui",height:"200px"})})]})})}bucketWidth(){const{chartData:e}=this.props;return e.length>=2?e[1].bin-e[0].bin:0}getSeries(){const{theme:e,chartData:t,precision:s,vitalDetails:n,vital:a}=this.props,i=(0,H.GT)(t,{precision:0===s?void 0:s,type:n.type,additionalFieldsFn:t=>({itemStyle:{color:e[this.getVitalsColor(a,t)]}})});return{seriesName:(0,r.t)("Count"),data:i}}getVitalsColor(e,t){const s=Y.eE[e],r=Y.MN[e];return t>=s?Y.fL[Y.SP.POOR]:t>=r?Y.fL[Y.SP.MEH]:Y.fL[Y.SP.GOOD]}getBaselineSeries(){const{theme:e,chartData:t}=this.props,s=this.summary;if(null===s||null===this.state.refPixelRect)return null;const n=(0,E.oZ)(t,s);if(null===n||-1===n)return null;const a=(0,E.jb)({x:n-.5,y:0},this.state.refDataRect,this.state.refPixelRect);if(null===a)return null;const i=(0,E.jb)({x:n-.5,y:Math.max(...t.map((e=>e.count)))||1},this.state.refDataRect,this.state.refPixelRect);if(null===i)return null;const o=(0,I.Z)({animationDuration:200,data:[[a,i]],label:{show:!1},lineStyle:{color:e.textColor,type:"solid"},tooltip:{formatter:()=>['<div class="tooltip-series tooltip-series-solo">','<span class="tooltip-label">',`<strong>${(0,r.t)("p75")}</strong>`,"</span>","</div>",'<div class="tooltip-arrow"></div>'].join("")}});return{seriesName:(0,r.t)("p75"),data:[],markLine:o}}render(){return(0,ae.BX)(U,{children:[this.renderSummary(),this.renderHistogram()]})}}ie.displayName="VitalCard";const oe=(0,h.Z)("div",{target:"e1yeyzg42"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),le=(0,h.Z)("div",{target:"e1yeyzg41"})({name:"bjn8wh",styles:"position:relative"}),de=(0,h.Z)("div",{target:"e1yeyzg40"})("position:absolute;top:",(0,S.Z)(2),";right:",(0,S.Z)(3),";z-index:2;"),ce=(0,R.b)(ie);class ue extends v.Component{renderVitalCard(e,t,s,r,n,a,o,l,d){const{location:c,organization:u,eventView:p,dataFilter:h}=this.props,v=i.r9[e],g=void 0!==o||void 0!==l;return(0,ae.tZ)(F.Z,{location:c,orgSlug:u.slug,eventView:p,numBuckets:m.sE,fields:g?[e]:[],min:o,max:l,precision:d,dataFilter:h,children:i=>{const m=g?i.isLoading:t,f=g?null!==i.error:s,x=g?i.histograms?.[e]??n:n;return(0,ae.tZ)(ce,{location:c,isLoading:m,error:f,vital:e,vitalDetails:v,summaryData:r,chartData:x,colors:a,eventView:p,organization:u,min:o,max:l,precision:d,dataFilter:h})}})}renderVitalGroup(e,t){const{location:s,organization:r,eventView:n,dataFilter:a}=this.props,{vitals:l,colors:d,min:c,max:u,precision:p}=e,h=l.reduce(((e,t)=>{const r=i.r9[t].slug;return e[t]={start:(0,o.ro)(s.query[`${r}Start`]),end:(0,o.ro)(s.query[`${r}End`])},e}),{});return(0,ae.tZ)(F.Z,{location:s,orgSlug:r.slug,eventView:n,numBuckets:m.sE,fields:l,min:c,max:u,precision:p,dataFilter:a,children:e=>{const s=t.isLoading||e.isLoading,r=null!==t.error||null!==e.error;return(0,ae.tZ)(v.Fragment,{children:l.map(((n,a)=>{const i=t?.vitalsData?.[n]??null,o=e.histograms?.[n]??[],{start:l,end:c}=h[n]??{};return(0,ae.tZ)(v.Fragment,{children:this.renderVitalCard(n,s,r,i,o,[d[a]],pe(l,p),pe(c,p),p)},n)}))})}})}render(){const{results:e}=this.props;return(0,ae.tZ)(T.s_,{children:(0,ae.tZ)(v.Fragment,{children:m.PE.map((t=>(0,ae.tZ)(v.Fragment,{children:this.renderVitalGroup(t,e)},t.vitals.join(""))))})})}}function pe(e,t){if(void 0!==e)return void 0===t||0===t?parseInt(e,10):parseFloat(e)}ue.displayName="VitalsPanel";const me=ue;function he(e){const{location:t,organization:s,eventView:n}=e,a=(0,o.ro)(t.query.query,""),i=e=>{const s=(0,P.fK)({...t.query||{},query:e});delete s.cursor,g.browserHistory.push({pathname:t.pathname,query:s})},l=m.PE.reduce(((e,t)=>{let{vitals:s}=t;return e.concat(s)}),[]);return(0,ae.tZ)(k.Z,{location:t,zoomKeys:m.QB,children:e=>{let{activeFilter:o,handleFilterChange:d,handleResetView:c,isZoomed:u}=e;return(0,ae.tZ)(D.or,{fullWidth:!0,children:(0,ae.tZ)(q.Z,{eventView:n,orgSlug:s.slug,location:t,vitals:l,children:e=>{const p=!e.isLoading&&(0,E.A1)(e.vitalsData,l);return(0,ae.BX)(v.Fragment,{children:[p&&(0,ae.tZ)(f.Z,{type:"info",showIcon:!0,children:(0,r._N)("If this page is looking a little bare, keep in mind not all browsers support these vitals. [link]",{link:(0,ae.tZ)(_.Z,{href:"https://docs.sentry.io/product/performance/web-vitals/#browser-support",children:(0,r.t)("Read more about browser support.")})})}),(0,ae.BX)(ve,{children:[(0,ae.BX)(j.Z,{condensed:!0,children:[(0,ae.tZ)(b.Z,{}),(0,ae.tZ)(Z.Z,{alignDropdown:"left"})]}),(0,ae.tZ)(ge,{organization:s,projectIds:n.project,query:a,fields:n.fields,onSearch:i}),(0,ae.tZ)(y.Z,{value:o.value,options:z.d,onChange:e=>{(0,C.ec)({eventKey:"performance_views.vitals.filter_changed",eventName:"Performance Views: Change vitals filter",organization_id:s.id,value:e.value}),d(e.value)},triggerProps:{prefix:(0,r.t)("Outliers")},triggerLabel:o.label}),(0,ae.tZ)(x.ZP,{onClick:()=>{(0,C.ec)({eventKey:"performance_views.vitals.reset_view",eventName:"Performance Views: Reset vitals view",organization_id:s.id}),c()},disabled:!u,"data-test-id":"reset-view",children:(0,r.t)("Reset View")})]}),(0,ae.tZ)(me,{organization:s,location:t,eventView:n,dataFilter:o.value,results:e})]})}})})}})}he.displayName="VitalsContent";const ve=(0,h.Z)("div",{target:"ekvr84z1"})("display:grid;gap:",(0,S.Z)(2),";margin-bottom:",(0,S.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(3, min-content);}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:auto 1fr auto auto;}"),ge=(0,h.Z)(w.Z,{target:"ekvr84z0"})("@media (min-width: ",(e=>e.theme.breakpoints.small),"){order:1;grid-column:1/5;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){order:initial;grid-column:auto;}"),fe=he;function xe(e){const{location:t,organization:s,projects:r}=e;return(0,ae.tZ)(u.ZP,{location:t,organization:s,projects:r,tab:p.Z.WebVitals,getDocumentTitle:ye,generateEventView:Ze,childComponent:fe})}function ye(e){return"string"==typeof e&&String(e).trim().length>0?[String(e).trim(),(0,r.t)("Vitals")].join(" — "):[(0,r.t)("Summary"),(0,r.t)("Vitals")].join(" — ")}function Ze(e){let{location:t,transactionName:s}=e;const r=(0,o.ro)(t.query.query,""),d=new l.MY(r);d.setFilterValues("event.type",["transaction"]),d.setFilterValues("transaction",[s]),Object.keys(d.filters).forEach((e=>{(0,a.h1)(e)&&d.removeFilter(e)}));const c=m.PE.reduce(((e,t)=>e.concat(t.vitals)),[]);return n.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:s,fields:[...c.map((e=>`percentile(${e}, ${m.GW})`)),...c.map((e=>`count_at_least(${e}, 0)`)),...c.map((e=>`count_at_least(${e}, ${i.r9[e].poorThreshold})`))],query:d.formatString(),projects:[]},t)}xe.displayName="TransactionVitals";const be=(0,c.Z)((0,d.Z)(xe))},"./app/views/performance/transactionSummary/utils.tsx":(e,t,s)=>{"use strict";s.d(t,{K0:()=>c,MF:()=>g,PU:()=>p,Z6:()=>h,e1:()=>m,uI:()=>f,vd:()=>v,xf:()=>u});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/styles/space.tsx"),a=s("./app/utils/discover/urls.tsx"),i=s("./app/utils/getRouteStringFromRoutes.tsx"),o=s("./app/utils/performance/urls.ts"),l=s("./app/utils/tokenizeSearch.tsx"),d=s("./app/views/performance/traceDetails/utils.tsx");let c;function u(e){const t=p(e);return t.removeFilter("transaction"),t}function p(e){const t=new l.MY(e);return t.removeFilter("event.type"),t}function m(e){let{orgSlug:t,transaction:s,projectID:r,query:n,unselectedSeries:a="p100()",display:i,trendFunction:o,trendColumn:l,showTransactions:d,additionalQuery:c}=e;const p=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let m;return m="string"==typeof n.query?u(n.query).formatString():n.query,{pathname:p,query:{transaction:s,project:r,environment:n.environment,statsPeriod:n.statsPeriod,start:n.start,end:n.end,query:m,unselectedSeries:a,showTransactions:d,display:i,trendFunction:o,trendColumn:l,...c}}}function h(e){return(t,s,r)=>{const n=`${s.trace}`;return n?(0,d.YA)(t,n,e,{}):{}}}function v(e){return(t,s,r,n)=>{const i=(0,a.JE)(s);return(0,o.D)(t.slug,i,e,r,n)}}function g(e){return(t,s,r)=>{const n=s.replayId;if(!n)return{};const a=`${s["project.name"]}:${n}`,o=encodeURIComponent((0,i.Z)(e));return{pathname:`/organizations/${t.slug}/replays/${a}`,query:{referrer:o}}}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(c||(c={}));const f=(0,r.Z)("div",{target:"e1radvp0"})("margin-top:",(0,n.Z)(3),";")},"../node_modules/lodash/_baseExtremum.js":(e,t,s)=>{var r=s("../node_modules/lodash/isSymbol.js");e.exports=function(e,t,s){for(var n=-1,a=e.length;++n<a;){var i=e[n],o=t(i);if(null!=o&&(void 0===l?o==o&&!r(o):s(o,l)))var l=o,d=i}return d}},"../node_modules/lodash/_baseGt.js":e=>{e.exports=function(e,t){return e>t}},"../node_modules/lodash/throttle.js":(e,t,s)=>{var r=s("../node_modules/lodash/debounce.js"),n=s("../node_modules/lodash/isObject.js");e.exports=function(e,t,s){var a=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return n(s)&&(a="leading"in s?!!s.leading:a,i="trailing"in s?!!s.trailing:i),r(e,t,{leading:a,maxWait:t,trailing:i})}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsRequest_tsx-app_utils_discover_discoverQuery_tsx-app_views_perfor-7ac0a2.15ecd0b1ef8404691f08c680d6aa2863.js.map