"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboardsV2_widgetBuilder_index_tsx-app_views_performance_transactionSummary_utils_tsx"],{"./app/utils/performance/urls.ts":(e,t,i)=>{i.d(t,{D:()=>a});var s=i("./app/components/events/interfaces/spans/utils.tsx"),r=i("./app/utils.tsx");function a(e,t,i,a,n){const o={...a||{},transaction:i};(0,r.ri)(o.transaction)||delete o.transaction;const d={pathname:`/organizations/${e}/performance/${t}/`,query:o,hash:(0,r.ri)(n)?(0,s.ct)(n):void 0};return(0,r.ri)(d.hash)||delete d.hash,d}},"./app/views/dashboardsV2/widgetBuilder/index.tsx":(e,t,i)=>{i.r(t),i.d(t,{default:()=>It});var s=i("./app/components/acl/feature.tsx"),r=i("./app/components/alert.tsx"),a=i("./app/locale.tsx"),n=i("./app/styles/organization.tsx"),o=i("./app/utils/useOrganization.tsx"),d=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),l=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/react/index.js")),u=i("../node_modules/lodash/cloneDeep.js"),c=i.n(u),p=i("../node_modules/lodash/isEmpty.js"),g=i.n(p),m=i("../node_modules/lodash/omit.js"),h=i.n(m),y=i("../node_modules/lodash/set.js"),f=i.n(y),b=i("./app/actionCreators/dashboards.tsx"),Z=i("./app/actionCreators/indicator.tsx"),w=i("./app/actionCreators/members.tsx"),v=i("./app/actionCreators/tags.tsx"),T=i("./app/components/datePageFilter.tsx"),x=i("./app/components/environmentPageFilter.tsx"),S=i("./app/components/layouts/thirds.tsx"),E=i("./app/components/list/index.tsx"),q=i("./app/components/list/listItem.tsx"),C=i("./app/components/loadingError.tsx"),O=i("./app/components/organizations/pageFilterBar.tsx"),F=i("./app/components/organizations/pageFilters/container.tsx"),A=i("./app/components/projectPageFilter.tsx"),_=i("./app/components/sentryDocumentTitle.tsx"),R=i("./app/styles/space.tsx"),k=i("./app/utils.tsx"),B=i("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),D=i("./app/utils/customMeasurements/customMeasurementsProvider.tsx"),L=i("./app/utils/discover/eventView.tsx"),I=i("./app/utils/discover/fields.tsx"),N=i("./app/utils/handleXhrErrorResponse.tsx"),z=i("./app/utils/performance/contexts/metricsCardinality.tsx"),P=i("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),V=i("./app/utils/useApi.tsx"),M=i("./app/utils/withPageFilters.tsx"),j=i("./app/utils/withTags.tsx"),W=i("./app/views/dashboardsV2/layoutUtils.tsx"),U=i("./app/views/dashboardsV2/types.tsx"),H=i("./app/views/performance/landing/metricsDataSwitcher.tsx"),X=i("./app/views/dashboardsV2/data.tsx"),$=i("./app/views/dashboardsV2/datasetConfig/base.tsx"),Q=i("./app/views/dashboardsV2/widgetCard/dashboardsMEPContext.tsx"),G=i("./app/components/links/externalLink.tsx"),Y=i("./app/utils/useCustomMeasurements.tsx"),J=i("./app/views/dashboardsV2/widgetBuilder/utils.tsx"),K=i("./app/views/dashboardsV2/widgetBuilder/buildSteps/buildStep.tsx"),ee=i("./app/components/forms/field/index.tsx"),te=i("./app/views/eventsV2/table/columnEditCollection.tsx"),ie=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function se(e){let{displayType:t,fieldOptions:i,widgetType:s,fields:r,organization:a,errors:n,onChange:o,filterAggregateParameters:d,filterPrimaryOptions:l,noFieldsMessage:u}=e;return(0,ie.tZ)(ee.Z,{inline:!1,error:n?.find((e=>e?.fields))?.fields,flexibleControlStateSize:!0,stacked:!0,children:t===U.FO.TABLE?(0,ie.tZ)(re,{columns:r,onChange:o,fieldOptions:i,organization:a,source:s,showAliasField:!0,filterAggregateParameters:d,filterPrimaryOptions:l,noFieldsMessage:u}):(0,ie.tZ)(re,{columns:r.slice(0,r.length-1),onChange:e=>{o([...e,r[r.length-1]])},fieldOptions:i,organization:a,source:s,filterPrimaryOptions:l,noFieldsMessage:u})})}se.displayName="ColumnFields";const re=(0,d.Z)(te.Z,{target:"e2w4m990"})("margin-top:",(0,R.Z)(1),";");function ae(e){let{dataSet:t,displayType:i,organization:s,widgetType:r,handleColumnFieldChange:n,queryErrors:o,explodedFields:d,tags:l}=e;const{customMeasurements:u}=(0,Y.Z)(),c=(0,$.v)(r);return(0,ie.tZ)(K.F,{title:(0,a.t)("Choose your columns"),description:t===J.qg.ISSUES?(0,a._N)("[fieldTagLink: Field and tag] columns will help you view more details about the issues (e.g., title).",{fieldTagLink:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}):t===J.qg.RELEASES?(0,a._N)("To stack sessions, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the sessions (e.g., releases).",{functionLink:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#release-properties"})}):(0,a._N)("To stack events, add [functionLink: functions] f(x) that may take in additional parameters. [fieldTagLink: Field and tag] columns will help you view more details about the events (e.g., title).",{functionLink:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/discover-queries/query-builder/#filter-by-table-columns"}),fieldTagLink:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/sentry-basics/search/searchable-properties/#event-properties"})}),children:(0,ie.tZ)(se,{displayType:i,organization:s,widgetType:r,fields:d,errors:o,fieldOptions:c.getTableFieldOptions(s,l,u),filterAggregateParameters:c.filterAggregateParams,filterPrimaryOptions:c.filterTableOptions,onChange:n})})}ae.displayName="ColumnsStep";var ne=i("./app/components/featureBadge.tsx"),oe=i("./app/components/forms/controls/radioGroup.tsx");const de=[[J.qg.EVENTS,(0,a.t)("Errors and Transactions")],[J.qg.ISSUES,(0,a.t)("Issues (States, Assignment, Time, etc.)")]];function le(e){let{dataSet:t,onChange:i,hasReleaseHealthFeature:s,displayType:r}=e;const n=[];return r!==U.FO.TABLE&&(n.push([J.qg.ISSUES,(0,a.t)("This dataset is restricted to tabular visualization.")]),r===U.FO.WORLD_MAP&&n.push([J.qg.RELEASES,(0,a.t)("This dataset is restricted to big number, tabular and time series visualizations.")])),(0,ie.tZ)(K.F,{title:(0,a.t)("Choose your dataset"),description:(0,a._N)("This reflects the type of information you want to use. To learn more, [link: read the docs].",{link:(0,ie.tZ)(G.Z,{href:"https://docs.sentry.io/product/dashboards/widget-builder/#choose-your-dataset"})}),children:(0,ie.tZ)(ue,{label:"dataSet",value:t,choices:s?[...de,[J.qg.RELEASES,(0,ie.BX)(l.Fragment,{children:[(0,a.t)("Releases (Sessions, Crash rates)")," ",(0,ie.tZ)(ne.Z,{type:"new"})]},"releases-dataset")]]:de,disabledChoices:n,onChange:e=>{i(e)}})})}le.displayName="DataSetStep";const ue=(0,d.Z)(oe.Z,{target:"e1eujfdx0"})("display:flex;flex-wrap:wrap;gap:",(0,R.Z)(2),";");var ce=i("./app/components/button.tsx"),pe=i("./app/components/buttonBar.tsx"),ge=i("./app/components/input.tsx"),me=i("./app/icons/index.tsx"),he=i("./app/utils/queryString.tsx"),ye=i("./app/utils/releases/releasesProvider.tsx"),fe=i("./app/views/dashboardsV2/releasesSelectControl.tsx");function be(e){let{canAddSearchConditions:t,dashboardFilters:i,location:r,queries:n,onQueryRemove:o,onAddSearchConditions:d,onQueryChange:u,organization:c,hideLegendAlias:p,queryErrors:g,widgetType:m,selection:h,onQueryConditionChange:y}=e;const[f,b]=(0,l.useState)([]),Z=(0,l.useCallback)((e=>t=>{const i={...n[e],conditions:t};u(e,i)}),[u,n]),w=(0,l.useCallback)((e=>(t,i)=>{let{validSearch:s}=i;f[e]=s,b(f),y(!f.some((e=>!e)));const r={...n[e],conditions:t};u(e,r)}),[u,y,f,n]),v=e=>()=>{f.splice(e,1),b(f),y(!f.some((e=>!e))),o(e)},S=(0,$.v)(m);return(0,ie.BX)(K.F,{title:(0,a.t)("Filter your results"),description:t?(0,a.t)("This is how you filter down your search. You can add multiple queries to compare data for each overlay."):(0,a.t)("This is how you filter down your search."),children:[(0,ie.BX)(s.Z,{features:["dashboards-top-level-filter"],children:[(0,ie.BX)(ve,{children:[(0,ie.tZ)(A.Z,{disabled:!0}),(0,ie.tZ)(x.Z,{disabled:!0}),(0,ie.tZ)(T.Z,{alignDropdown:"left",disabled:!0})]}),(0,ie.tZ)(Te,{children:(0,ie.tZ)(ye.lR,{organization:c,selection:h,children:(0,ie.tZ)(xe,{selectedReleases:(U.qA.RELEASE in r.query?(0,he.qP)(r.query[U.qA.RELEASE]):i?.[U.qA.RELEASE])??[],isDisabled:!0,className:"widget-release-select"})})})]}),(0,ie.BX)("div",{children:[n.map(((e,t)=>(0,ie.tZ)(we,{inline:!1,flexibleControlStateSize:!0,stacked:!0,error:g?.[t]?.conditions,children:(0,ie.BX)(Se,{children:[(0,ie.tZ)(S.SearchBar,{organization:c,pageFilters:h,onClose:w(t),onSearch:Z(t),widgetQuery:e}),!p&&(0,ie.tZ)(Ze,{type:"text",name:"name",value:e.name,placeholder:(0,a.t)("Legend Alias"),onChange:e=>{const i={...n[t],name:e.target.value};u(t,i)}}),n.length>1&&(0,ie.tZ)(ce.ZP,{size:"zero",borderless:!0,onClick:v(t),icon:(0,ie.tZ)(me.Fz,{}),title:(0,a.t)("Remove query"),"aria-label":(0,a.t)("Remove query")})]})},t))),t&&(0,ie.tZ)(ce.ZP,{size:"sm",icon:(0,ie.tZ)(me.N_,{isCircled:!0}),onClick:d,children:(0,a.t)("Add Query")})]})]})}be.displayName="FilterResultsStep";const Ze=(0,d.Z)(ge.Z,{target:"e12061i95"})({name:"1f6lq61",styles:"width:33%"}),we=(0,d.Z)(ee.Z,{target:"e12061i94"})("padding-bottom:",(0,R.Z)(1),";"),ve=(0,d.Z)(O.Z,{target:"e12061i93"})("margin-bottom:",(0,R.Z)(1),";margin-right:",(0,R.Z)(2),";"),Te=(0,d.Z)(pe.ZP,{target:"e12061i92"})("grid-template-columns:1fr;margin-bottom:",(0,R.Z)(1),";margin-right:",(0,R.Z)(2),";justify-content:space-between;"),xe=(0,d.Z)(fe.Z,{target:"e12061i91"})({name:"f0iau4",styles:"button{width:100%;}"}),Se=(0,d.Z)("div",{target:"e12061i90"})("display:flex;align-items:center;>*+*{margin-left:",(0,R.Z)(1),";}");var Ee=i("../node_modules/@dnd-kit/core/dist/core.esm.js"),qe=i("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js"),Ce=i("./app/views/eventsV2/table/types.tsx"),Oe=i("./app/views/eventsV2/table/queryField.tsx");function Fe(e){let{onDelete:t,onChange:i,fieldOptions:s,value:r,forwardRef:n,listeners:o,attributes:d,canDelete:u,canDrag:c,style:p,isDragging:g}=e;return(0,ie.tZ)(_e,{ref:n,style:p,children:g?null:(0,ie.BX)(l.Fragment,{children:[c&&(0,ie.tZ)(Ae,{...o,...d,"aria-label":(0,a.t)("Drag to reorder"),icon:(0,ie.tZ)(me.LS,{size:"xs"}),size:"zero",borderless:!0}),(0,ie.tZ)(Oe.q,{placeholder:(0,a.t)("Select group"),fieldValue:r,fieldOptions:s,onChange:i,filterPrimaryOptions:e=>e.value.kind!==Ce.L.FUNCTION}),u&&(0,ie.tZ)(ce.ZP,{size:"zero",borderless:!0,onClick:t,icon:(0,ie.tZ)(me.Fz,{}),title:(0,a.t)("Remove group"),"aria-label":(0,a.t)("Remove group")})]})})}Fe.displayName="QueryField";const Ae=(0,d.Z)(ce.ZP,{target:"epp8h3j1"})({name:"1k18kha",styles:"height:40px"}),_e=(0,d.Z)("div",{target:"epp8h3j0"})("display:flex;align-items:center;justify-content:space-between;width:100%;>*+*{margin-left:",(0,R.Z)(1),";}");var Re=i("../node_modules/@dnd-kit/utilities/dist/utilities.esm.js"),ke=i("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js");function Be(e){let{dragId:t,...i}=e;const s=(0,ke.u)(),{listeners:r,setNodeRef:a,transform:n,transition:o,attributes:d,isDragging:l}=(0,qe.nB)({id:t,transition:null});let u={transform:Re.ux.Transform.toString(n),transition:o,zIndex:"auto"};return l&&(u={...u,zIndex:100,height:"40px",border:`2px dashed ${s.border}`,borderRadius:s.borderRadius}),(0,ie.tZ)(Fe,{forwardRef:a,listeners:r,attributes:d,isDragging:l,style:u,...i})}Be.displayName="SortableQueryField";const De={kind:Ce.L.FIELD,field:""};function Le(e){let{fieldOptions:t,columns:i=[],onChange:s}=e;const[r,n]=(0,l.useState)(null);function o(e,t){const r=[...i];0===i.length?r.push(e):(0,k.ri)(t)&&(r[t]=e),s(r)}const d=1===i.length&&i[0].kind===Ce.L.FIELD&&""!==i[0]?.field,u=i.length>1,c=u||d,p=i.map(I.sN),{filteredFieldOptions:g,columnsAsFieldOptions:m}=(0,l.useMemo)((()=>Object.keys(t).reduce(((e,i)=>{const s=t[i],r=p.findIndex((e=>e===s.value.meta.name));return-1===r?(e.filteredFieldOptions[i]=s,e):(e.columnsAsFieldOptions[r]={[i]:s},e)}),{filteredFieldOptions:{},columnsAsFieldOptions:[]})),[t,i]),h=(0,l.useMemo)((()=>i.reduce(((e,t,i)=>(e.push(String(i)),e)),[])),[i]);return(0,ie.BX)(l.Fragment,{children:[(0,ie.tZ)(Ie,{inline:!1,flexibleControlStateSize:!0,stacked:!0,children:0===i.length?(0,ie.tZ)(Fe,{value:De,fieldOptions:g,onChange:e=>o(e,0),canDelete:c}):(0,ie.BX)(Ee.LB,{collisionDetection:Ee.pE,onDragStart:e=>{let{active:t}=e;n(t.id)},onDragEnd:e=>{let{over:t,active:r}=e;if(n(null),t){const e=h.indexOf.bind(h),a=e(r.id),n=e(t.id);a!==n&&s((0,qe.Rp)(i,a,n))}},onDragCancel:()=>{n(null)},children:[(0,ie.tZ)(qe.Fo,{items:h,strategy:qe.qw,children:(0,ie.tZ)(ze,{children:i.map(((e,t)=>(0,ie.tZ)(Be,{dragId:h[t],value:e,fieldOptions:{...g,...m[t]},onChange:e=>o(e,t),onDelete:()=>function(e){const t=[...i];t.splice(e,1),s(t)}(t),canDrag:u,canDelete:c},h[t])))})}),(0,ie.tZ)(Ee.y9,{dropAnimation:null,children:r?(0,ie.tZ)(Pe,{children:(0,ie.tZ)(Fe,{value:i[Number(r)],fieldOptions:{...g,...m[Number(r)]},onChange:e=>o(e,Number(r)),canDrag:u,canDelete:c})}):null})]})}),i.length<20&&(0,ie.tZ)(Ne,{size:"sm",icon:(0,ie.tZ)(me.N_,{isCircled:!0}),onClick:function(){const e=0===i.length?[{...De},{...De}]:[...i,{...De}];s(e)},children:(0,a.t)("Add Group")})]})}Le.displayName="GroupBySelector";const Ie=(0,d.Z)(ee.Z,{target:"esrd23w3"})("padding-bottom:",(0,R.Z)(1),";"),Ne=(0,d.Z)(ce.ZP,{target:"esrd23w2"})({name:"b9l38d",styles:"width:min-content"}),ze=(0,d.Z)("div",{target:"esrd23w1"})("display:grid;grid-auto-flow:row;gap:",(0,R.Z)(1),";"),Pe=(0,d.Z)("div",{target:"esrd23w0"})("position:absolute;background:",(e=>e.theme.background),";padding:",(0,R.Z)(.5),";border-radius:",(e=>e.theme.borderRadius),";box-shadow:0 0 15px rgba(0, 0, 0, 0.15);opacity:0.8;cursor:grabbing;padding-right:",(0,R.Z)(2),";width:100%;button{cursor:grabbing;}@media (min-width: ",(e=>e.theme.breakpoints.small),"){width:710px;}");function Ve(e){let{dataSet:t,columns:i,onGroupByChange:s,organization:r,tags:n}=e;const o=(0,$.v)(qt[t]);return(0,ie.tZ)(K.F,{title:(0,a.t)("Group your results"),description:(0,a.t)("This is how you can group your data result by field or tag."),children:(0,ie.tZ)(Le,{columns:i,fieldOptions:o.getGroupByFieldOptions?o.getGroupByFieldOptions(r,n):{},onChange:s})})}Ve.displayName="GroupByStep";var Me=i("./app/views/dashboardsV2/widgetBuilder/buildSteps/sortByStep/index.tsx"),je=i("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),We=i("../node_modules/lodash/debounce.js"),Ue=i.n(We),He=i("../node_modules/lodash/isEqual.js"),Xe=i.n(He),$e=i("./app/components/charts/simpleTableChart.tsx"),Qe=i("./app/components/forms/controls/selectControl.tsx"),Ge=i("./app/components/panels/index.tsx"),Ye=i("./app/constants/index.tsx"),Je=i("./app/utils/usePrevious.tsx"),Ke=i("./app/views/dashboardsV2/utils.tsx"),et=i("./app/views/dashboardsV2/widgetCard/index.tsx");function tt(e){let{organization:t,pageFilters:i,displayType:s,error:r,onChange:n,widget:o,noDashboardsMEPProvider:d,dashboardFilters:u,location:c,isWidgetInvalid:p}=e;const[g,m]=(0,l.useState)(o),h=(0,Je.Z)(o),y=(0,l.useCallback)(Ue()(((e,t)=>{t||m(e)}),Ye.Dk),[]);(0,l.useEffect)((()=>{let e=!1;return Xe()(h,o)||y(o,e),()=>{e=!0}}),[o,h,y]);const f=Object.keys(J.hV).map((e=>({label:J.hV[e],value:e})));return(0,ie.BX)(K.F,{title:(0,a.t)("Choose your visualization"),description:(0,a.t)("This is a preview of how your widget will appear in the dashboard."),children:[(0,ie.tZ)(ee.Z,{error:r,inline:!1,flexibleControlStateSize:!0,stacked:!0,children:(0,ie.tZ)(Qe.Z,{name:"displayType",options:f,value:s,onChange:e=>{n(e.value)},styles:{singleValue:e=>({...e,width:`calc(100% - ${(0,R.Z)(1)})`})}})}),(0,ie.tZ)(it,{displayType:s,children:(0,ie.tZ)(et.Z,{organization:t,selection:i,widget:g,dashboardFilters:(0,Ke.lM)(c)??u,isEditing:!1,widgetLimitReached:!1,renderErrorMessage:e=>"string"==typeof e&&(0,ie.tZ)(Ge.aU,{type:"error",children:e}),isSorting:!1,currentWidgetDragging:!1,noLazyLoad:!0,showStoredAlert:!0,noDashboardsMEPProvider:d,isWidgetInvalid:p})})]})}tt.displayName="VisualizationStep";const it=(0,d.Z)("div",{target:"e1huhsf60"})("padding-right:",(0,R.Z)(2),";",et._,"{height:initial;}",(e=>e.displayType===U.FO.TABLE&&(0,je.iv)("overflow:hidden;",$e.p,"{height:41px;}",et._,"{height:301px;}","")),";");function st(e){let{title:t,onAdd:i}=e;return(0,ie.tZ)(ce.ZP,{size:"sm",onClick:i,icon:(0,ie.tZ)(me.N_,{isCircled:!0}),children:t})}function rt(e){let{onDelete:t}=e;return(0,ie.tZ)(ce.ZP,{size:"zero",borderless:!0,onClick:t,icon:(0,ie.tZ)(me.Fz,{}),title:(0,a.t)("Remove this Y-Axis"),"aria-label":(0,a.t)("Remove this Y-Axis")})}function at(e){let{displayType:t,widgetType:i,aggregates:s,tags:r,onChange:n,errors:d,noFieldsMessage:l}=e;const u=(0,o.Z)(),c=(0,$.v)(i),{customMeasurements:p}=(0,Y.Z)(),g=d?.find((e=>e?.aggregates))?.aggregates,m=s.length>1,h=[U.FO.WORLD_MAP,U.FO.BIG_NUMBER].includes(t)&&1===s.length||[U.FO.LINE,U.FO.AREA,U.FO.BAR].includes(t)&&3===s.length;return(0,ie.BX)(ee.Z,{inline:!1,flexibleControlStateSize:!0,error:g,stacked:!0,children:[s.map(((e,i)=>(0,ie.BX)(nt,{children:[(0,ie.tZ)(Oe.q,{fieldValue:e,fieldOptions:c.getTableFieldOptions(u,r,p),onChange:e=>function(e,t){const i=[...s];i[t]=e,n(i)}(e,i),filterPrimaryOptions:c.filterYAxisOptions?.(t),filterAggregateParameters:c.filterYAxisAggregateParams?.(e,t),otherColumns:s,noFieldsMessage:l}),s.length>1&&(m||e.kind===Ce.L.EQUATION)&&(0,ie.tZ)(rt,{onDelete:e=>function(e,t){e.preventDefault();const i=[...s];i.splice(t,1),n(i)}(e,i)})]},`${e}:${i}`))),!h&&(0,ie.BX)(ot,{gap:1,children:[(0,ie.tZ)(st,{title:(0,a.t)("Add Overlay"),onAdd:function(e){e.preventDefault();const t=[...s,{kind:Ce.L.FIELD,field:""}];n(t)}}),c.enableEquations&&(0,ie.tZ)(st,{title:(0,a.t)("Add an Equation"),onAdd:function(e){e.preventDefault();const t=[...s,{kind:Ce.L.EQUATION,field:""}];n(t)}})]})]})}st.displayName="AddButton",rt.displayName="DeleteButton",at.displayName="YAxisSelector";const nt=(0,d.Z)("div",{target:"ew36myz1"})("display:flex;align-items:center;justify-content:space-between;:not(:last-child){margin-bottom:",(0,R.Z)(1),";}>*+*{margin-left:",(0,R.Z)(1),";}"),ot=(0,d.Z)(pe.ZP,{target:"ew36myz0"})({name:"11g6mpt",styles:"justify-content:flex-start"});function dt(e){let{displayType:t,queryErrors:i,aggregates:s,onYAxisChange:r,tags:n,widgetType:o}=e;return(0,ie.tZ)(K.F,{title:t===U.FO.BIG_NUMBER?(0,a.t)("Choose what to plot"):(0,a.t)("Choose what to plot in the y-axis"),description:[U.FO.AREA,U.FO.BAR,U.FO.LINE].includes(t)?(0,a.t)("This is the data you'd be visualizing in the display. If the overlay units conflict, the charts will always base it off of the first line."):(0,a.t)("This is the data you'd be visualizing in the display."),children:(0,ie.tZ)(at,{widgetType:o,displayType:t,aggregates:s,onChange:r,tags:n,errors:i})})}dt.displayName="YAxisStep";var lt=i("./app/components/confirm.tsx");function ut(e){let{goBackLocation:t,onSave:i,onDelete:s,invalidForm:r,isEditing:n}=e;return(0,ie.tZ)(pt,{children:(0,ie.BX)(ct,{gap:1,children:[(0,ie.tZ)(ce.ZP,{to:t,children:(0,a.t)("Cancel")}),n&&s&&(0,ie.tZ)(lt.Z,{priority:"danger",message:(0,a.t)("Are you sure you want to delete this widget?"),onConfirm:s,children:(0,ie.tZ)(ce.ZP,{priority:"danger",children:(0,a.t)("Delete")})}),(0,ie.tZ)(ce.ZP,{priority:"primary",onClick:i,disabled:r,title:r?(0,a.t)("Required fields must be filled out and contain valid inputs"):void 0,children:n?(0,a.t)("Update Widget"):(0,a.t)("Add Widget")})]})})}ut.displayName="Footer";const ct=(0,d.Z)(pe.ZP,{target:"e1golk021"})("justify-content:flex-end;max-width:1000px;padding:",(0,R.Z)(4)," ",(0,R.Z)(2),";padding-right:calc(",(0,R.Z)(2)," + ",(0,R.Z)(2),");@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,R.Z)(4),";padding-right:calc(",(0,R.Z)(4)," + ",(0,R.Z)(2),");}"),pt=(0,d.Z)("div",{target:"e1golk020"})("background:",(e=>e.theme.background),";border-top:1px solid ",(e=>e.theme.gray200),";");var gt=i("./app/components/breadcrumbs.tsx"),mt=i("./app/components/editableText.tsx"),ht=i("./app/components/featureFeedback/index.tsx");function yt(e){let{title:t,orgSlug:i,goBackLocation:s,dashboardTitle:r,onChangeTitle:n}=e;return(0,ie.BX)(S.h4,{children:[(0,ie.BX)(S.oB,{children:[(0,ie.tZ)(gt.Z,{crumbs:[{to:`/organizations/${i}/dashboards/`,label:(0,a.t)("Dashboards")},{to:s,label:r},{label:(0,a.t)("Widget Builder")}]}),(0,ie.tZ)(S.Dx,{children:(0,ie.tZ)(mt.Z,{"aria-label":(0,a.t)("Widget title"),value:t,onChange:n,errorMessage:(0,a.t)("Widget title is required"),maxLength:255})})]}),(0,ie.tZ)(S.kP,{children:(0,ie.BX)(pe.ZP,{gap:1,children:[(0,ie.tZ)(ht.z,{featureName:"widget-builder"}),(0,ie.tZ)(ce.ZP,{external:!0,href:"https://docs.sentry.io/product/dashboards/custom-dashboards/#widget-builder",children:(0,a.t)("Read the docs")})]})})]})}yt.displayName="Header";var ft=i("./app/actionCreators/modal.tsx"),bt=i("./app/utils/discover/types.tsx");const Zt=[{id:"duration-distribution",title:(0,a.t)("Duration Distribution"),description:(0,a.t)("Compare transaction durations across different percentiles."),displayType:U.FO.LINE,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],aggregates:["p50(transaction.duration)","p75(transaction.duration)","p95(transaction.duration)"],columns:[],orderby:""}]},{id:"high-throughput-transactions",title:(0,a.t)("High Throughput Transactions"),description:(0,a.t)("Top 5 transactions with the largest volume."),displayType:U.FO.TOP_N,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["transaction","count()"],aggregates:["count()"],columns:["transaction"],orderby:"-count()"}]},{id:"crash-rates-recent-releases",title:(0,a.t)("Crash Rates for Recent Releases"),description:(0,a.t)("Percentage of crashed sessions for latest releases."),displayType:U.FO.LINE,widgetType:U.l9.RELEASE,interval:"5m",limit:8,queries:[{name:"",conditions:"",fields:["crash_rate(session)","release"],aggregates:["crash_rate(session)"],columns:["release"],orderby:"-release"}]},{id:"session-health",title:(0,a.t)("Session Health"),description:(0,a.t)("Number of abnormal, crashed, errored and healthy sessions."),displayType:U.FO.TABLE,widgetType:U.l9.RELEASE,interval:"5m",queries:[{name:"",conditions:"",fields:["session.status","sum(session)"],aggregates:["sum(session)"],columns:["session.status"],orderby:""}]},{id:"lcp-country",title:(0,a.t)("LCP by Country"),description:(0,a.t)("Density map showing page load times by country."),displayType:U.FO.WORLD_MAP,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"has:geo.country_code",fields:["p75(measurements.lcp)"],aggregates:["p75(measurements.lcp)"],columns:[],orderby:""}]},{id:"miserable-users",title:(0,a.t)("Miserable Users"),description:(0,a.t)("Unique users who have experienced slow load times."),displayType:U.FO.BIG_NUMBER,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"",fields:["count_miserable(user,300)"],aggregates:["count_miserable(user,300)"],columns:[],orderby:""}]},{id:"slow-vs-fast",title:(0,a.t)("Slow vs. Fast Transactions"),description:(0,a.t)("Percentage breakdown of transaction durations over and under 300ms."),displayType:U.FO.BAR,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:transaction",fields:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],aggregates:["equation|(count_if(transaction.duration,greater,300) / count()) * 100","equation|(count_if(transaction.duration,lessOrEquals,300) / count()) * 100"],columns:[],orderby:""}]},{id:"issue-for-review",title:(0,a.t)("Issues For Review"),description:(0,a.t)("Most recently seen unresolved issues for review."),displayType:U.FO.TABLE,widgetType:U.l9.ISSUE,interval:"5m",queries:[{name:"",conditions:"is:unresolved is:for_review",fields:["issue","assignee","events","title"],aggregates:[],columns:["issue","assignee","events","title"],orderby:"date"}]},{id:"top-unhandled",title:(0,a.t)("Top Unhandled Error Types"),description:(0,a.t)("Most frequently encountered unhandled errors."),displayType:U.FO.TOP_N,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"error.unhandled:true",fields:["error.type","count()"],aggregates:["count()"],columns:["error.type"],orderby:"-count()"}]},{id:"users-affected",title:(0,a.t)("Users Affected by Errors"),description:(0,a.t)("Footprint of unique users affected by errors."),displayType:U.FO.LINE,widgetType:U.l9.DISCOVER,interval:"5m",queries:[{name:"",conditions:"event.type:error",fields:["count_unique(user)","count()"],aggregates:["count_unique(user)","count()"],columns:[],orderby:""}]}];var wt=i("./app/views/dashboardsV2/widgetBuilder/widgetLibrary/card.tsx");function vt(e){let{bypassOverwriteModal:t,onWidgetSelect:i,organization:s,selectedWidgetId:r}=e;const n=(0,ke.u)();let o=Zt.map((e=>e.displayType===U.FO.TOP_N?{...e,displayType:U.FO.AREA,limit:bt.hY}:e));function d(e,s){return function(){t?i(e):(0,ft.openWidgetBuilderOverwriteModal)({onConfirm:()=>i(e),widget:e,iconColor:s})}}return s.features.includes("dashboards-releases")||(o=o.filter((e=>!(e.widgetType===U.l9.RELEASE)))),(0,ie.BX)(l.Fragment,{children:[(0,ie.tZ)(xt,{children:(0,a.t)("Widget Library")}),(0,ie.tZ)(Tt,{children:o.map(((e,t)=>{const i=n.charts.getColorPalette(o.length-2)[t],s=e.displayType===U.FO.TOP_N?U.FO.TABLE:e.displayType,a=(0,J.Zi)({displayType:s,queries:e.queries,widgetType:e.widgetType}),l={...e,displayType:s,queries:a};return(0,ie.tZ)(St,{selected:r===e.id,onClick:d(l,i),children:(0,ie.tZ)(wt.Z,{widget:l,iconColor:i})},e.title)}))})]})}vt.displayName="WidgetLibrary";const Tt=(0,d.Z)("div",{target:"ess72gf2"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),xt=(0,d.Z)("h5",{target:"ess72gf1"})("padding-left:calc(",(0,R.Z)(2)," - ",(0,R.Z)(.25),");"),St=(0,d.Z)("div",{target:"ess72gf0"})("padding:calc(",(0,R.Z)(2)," - 3px);border:1px solid transparent;border-radius:",(e=>e.theme.borderRadius),";transition:border-color 0.3s ease;cursor:pointer;&:hover{border-color:",(e=>e.theme.gray100),";}",(e=>e.selected&&`border-color: ${e.theme.gray200};`),";"),Et={[U.l9.DISCOVER]:J.qg.EVENTS,[U.l9.ISSUE]:J.qg.ISSUES,[U.l9.RELEASE]:J.qg.RELEASES},qt={[J.qg.EVENTS]:U.l9.DISCOVER,[J.qg.ISSUES]:U.l9.ISSUE,[J.qg.RELEASES]:U.l9.RELEASE};function Ct(e){let{dashboard:t,params:i,location:s,organization:r,selection:o,start:d,end:u,statsPeriod:p,onSave:m,route:y,router:S,tags:E}=e;const{widgetIndex:q,orgId:O,dashboardId:R}=i,{source:M,displayType:j,defaultTitle:G,limit:Y}=s.query,K=(0,J.eQ)(s.query.defaultWidgetQuery);let{defaultTableColumns:ee}=s.query;"string"==typeof ee&&(ee=[ee]);const te=r.features.includes("dashboards-releases"),se=t.widgets.filter((e=>{let{widgetType:t}=e;return t!==U.l9.RELEASE||te})),re=(0,k.ri)(q),ne=Number(q),oe=ne>=0&&ne<se.length&&Number.isInteger(ne),de=r.slug,ue=p?{...o,datetime:{start:null,end:null,period:p,utc:null}}:d&&u?{...o,datetime:{start:d,end:u,period:null,utc:null}}:o,ce=[U.EN.DISCOVERV2,U.EN.ISSUE_DETAILS].includes(M),pe=(0,V.Z)(),[ge,me]=(0,l.useState)(!1),[he,ye]=(0,l.useState)((0,$.v)(U.l9.DISCOVER)),[fe,Ze]=(0,l.useState)((()=>{const e={title:G??(0,a.t)("Custom Widget"),displayType:(j===U.FO.TOP_N?U.FO.AREA:j)??U.FO.TABLE,interval:"5m",queries:[],limit:Y?Number(Y):void 0,errors:void 0,loading:!!ce,dashboards:[],userHasModified:!1,prebuiltWidgetId:null,dataSet:J.qg.EVENTS,queryConditionsValid:!0};return K?(e.queries=[{...K,orderby:K.orderby||(he.getTableSortOptions?he.getTableSortOptions(r,K)[0].value:"")}],[U.FO.TABLE,U.FO.TOP_N].includes(e.displayType)||(0,J.V0)(e.displayType)&&e.queries[0].columns.length||(e.queries[0].orderby="")):e.queries=[{...he.defaultWidgetQuery}],e})),[we,ve]=(0,l.useState)(null),[Te,xe]=(0,l.useState)(null);(0,l.useEffect)((()=>{if((0,B.Z)("dashboards_views.widget_builder.opened",{organization:r,new_widget:!re}),(0,k.z)(E)&&(0,v.QK)(pe,r.slug,{...o,datetime:{period:"14d",start:null,end:null,utc:null}}),re&&oe){const e=se[ne];let t,i=e.displayType,s=e.limit;e.displayType===U.FO.TOP_N?(s=J._k,i=U.FO.AREA,t=(0,J.Zi)({displayType:i,queries:e.queries,widgetType:e.widgetType??U.l9.DISCOVER}).map((e=>({...e,aggregates:e.aggregates.length?[e.aggregates[e.aggregates.length-1]]:[]})))):t=(0,J.Zi)({displayType:i,queries:e.queries,widgetType:e.widgetType??U.l9.DISCOVER}),Ze({title:e.title,displayType:i,interval:e.interval,queries:t,errors:void 0,loading:!1,dashboards:[],userHasModified:!1,dataSet:e.widgetType?Et[e.widgetType]:J.qg.EVENTS,limit:s,prebuiltWidgetId:null,queryConditionsValid:!0}),ye((0,$.v)(e.widgetType)),ve(e)}}),[]),(0,l.useEffect)((()=>{ce&&async function(){const e=pe.requestPromise(`/organizations/${r.slug}/dashboards/`,{method:"GET",query:{sort:"myDashboardsAndRecentlyViewed"}});try{const t=await e;Ze((e=>({...e,dashboards:t,loading:!1})))}catch(e){const t=(0,a.t)("Unable to fetch dashboards");(0,Z.Iw)(t),(0,N.Z)(t)(e),Ze((e=>({...e,loading:!1})))}}(),Ze((e=>({...e,selectedDashboard:{label:t.title,value:t.id||J.i0}})))}),[pe,t.id,t.title,ce,r.slug,M]),(0,l.useEffect)((()=>{(0,w.MA)(pe,r.slug,o.projects?.map(String))}),[o.projects,pe,r.slug]),(0,l.useEffect)((()=>{S.setRouteLeaveHook(y,(()=>{if(!ge&&fe.userHasModified)return(0,a.t)("You have unsaved changes, are you sure you want to leave?")}))}),[ge,fe.userHasModified,y,S]);const Se=fe.dataSet===J.qg.EVENTS?U.l9.DISCOVER:fe.dataSet===J.qg.ISSUES?U.l9.ISSUE:U.l9.RELEASE,Ee={title:fe.title,displayType:fe.displayType,interval:fe.interval,queries:fe.queries,limit:fe.limit,widgetType:Se},qe=fe.selectedDashboard?.value??R,Ce=h()(s.query,"source"),Oe={pathname:(0,k.ri)(qe)&&qe!==J.i0?`/organizations/${O}/dashboard/${qe}/`:`/organizations/${O}/dashboards/${J.i0}/`,query:g()(Ce)?void 0:Ce},Fe=(0,J.V0)(fe.displayType),Ae=[U.FO.TABLE,U.FO.TOP_N].includes(fe.displayType);function _e(){return we?t.widgets.findIndex((e=>(0,k.ri)(e.id)?e.id===we.id:!!(0,k.ri)(e.tempId)&&e.tempId===we.tempId)):-1}function Re(e,t){var i;(0,B.Z)("dashboards_views.widget_builder.change",{from:M,field:e,value:t,widget_type:Se,organization:r,new_widget:!re}),Ze((i=>{const s=c()(i);return f()(s,e,t),"title"===e&&f()(s,"userHasModified",!0),{...s,errors:void 0}})),"displayType"===e&&t!==fe.displayType&&(i=t,Ze((e=>{const t=c()(e);if(!he.supportedDisplayTypes.includes(i))return f()(t,"queries",(0,J.Zi)({displayType:i,queries:[{...(0,$.v)(U.l9.DISCOVER).defaultWidgetQuery}],widgetType:U.l9.DISCOVER})),f()(t,"dataSet",J.qg.EVENTS),ye((0,$.v)(U.l9.DISCOVER)),{...t,errors:void 0};const s=(0,J.Zi)({displayType:i,queries:e.queries,widgetType:qt[e.dataSet]});return i===U.FO.TOP_N&&s.splice(1),e.userHasModified||K&&ee&&(i===U.FO.TABLE?s.forEach((e=>{const t=(0,I.n0)(ee);e.columns=[...t.columns],e.aggregates=[...t.aggregates],e.fields=[...ee],e.orderby=K.orderby??(e.fields.length?`${e.fields[0]}`:"-")})):i===j&&s.forEach((e=>{e.fields=[...K.columns,...K.aggregates],e.aggregates=[...K.aggregates],e.columns=[...K.columns],K.orderby&&(j===U.FO.TOP_N||K.columns.length)&&(e.orderby=K.orderby)}))),f()(t,"queries",s),(0,J.V0)(i)&&s[0].columns.filter((e=>!!e)).length?t.limit=e.limit??Math.min((0,J.oA)(s.length,s[0].columns.length),J._k):t.limit=void 0,f()(t,"userHasModified",!0),{...t,errors:void 0}})))}function ke(e){(0,B.Z)("dashboards_views.widget_builder.change",{from:M,field:"dataSet",value:e,widget_type:Se,organization:r,new_widget:!re}),Ze((t=>{const i=c()(t);i.queries.splice(0,i.queries.length),f()(i,"dataSet",e),e===J.qg.ISSUES&&f()(i,"displayType",U.FO.TABLE);const s=(0,$.v)(qt[e]);return ye(s),i.queries.push(...we?.widgetType&&Et[we.widgetType]===e?we.queries:[{...s.defaultWidgetQuery}]),f()(i,"userHasModified",!0),{...i,errors:void 0}}))}function Be(){Ze((e=>{const t=c()(e),i=(0,$.v)(qt[e.dataSet]),s=c()(i.defaultWidgetQuery);return s.fields=e.queries[0].fields,s.aggregates=e.queries[0].aggregates,s.columns=e.queries[0].columns,s.orderby=e.queries[0].orderby,t.queries.push(s),t}))}function De(e){Ze((t=>{const i=c()(t);return i.queries.splice(e,1),{...i,errors:void 0}}))}function Le(e,t){Ze((i=>{const s=c()(i);return f()(s,`queries.${e}`,t),f()(s,"userHasModified",!0),{...s,errors:void 0}}))}function Ie(e){return function(t){const i=t.map(I.sN),s=(0,I.KZ)(t),r=c()(fe);let a=c()(r.queries[0]);a.fields=i,a.aggregates=s.aggregates,a.columns=s.columns,a.fieldAliases=s.fieldAliases,he.handleColumnFieldChangeOverride&&(a=he.handleColumnFieldChangeOverride(a)),he.handleOrderByReset&&(a=e&&i.some((e=>!["transaction","title"].includes(e)))?he.handleOrderByReset(a,i.filter((e=>!["transaction","title"].includes(e)))):he.handleOrderByReset(a,i)),f()(r,"queries",[a]),f()(r,"userHasModified",!0),Ze(r)}}function Ne(e){const t=e.map(I.sN),i=c()(fe),s=fe.queries.map((e=>{const i=c()(e);if(i.columns=t,t.length){if(!i.orderby){const t=(0,J._4)({widgetType:Se??U.l9.DISCOVER,columns:e.columns,aggregates:e.aggregates});let s;t.length?(s=t[0].value,i.orderby=`-${s}`):i.orderby=""}}else i.orderby="";return i}));f()(i,"userHasModified",!0),f()(i,"queries",s);const r=i.queries[0].columns.filter((e=>!("equation|"===e)));0===r.length?f()(i,"limit",void 0):f()(i,"limit",Math.min(i.limit??J._k,(0,J.oA)(s.length,s[0].aggregates.length))),Ze(i)}function ze(e){Ze((t=>({...t,limit:e})))}function Pe(e){const t=c()(fe);fe.queries.forEach(((i,s)=>{const r=c()(i);r.orderby=e,f()(t,`queries.${s}`,r)})),f()(t,"userHasModified",!0),Ze(t)}function je(){if(!re)return;me(!0);let e=[...t.widgets];const i=_e();e.splice(i,1),e=(0,W.Bb)(e),m(e),S.push(Oe)}async function We(){const e=(0,W.TE)(Ee);if(we&&(e.layout=we?.layout),Fe||(e.limit=void 0),await async function(e){if(ce&&(!fe.selectedDashboard||!fe.dashboards.find((e=>{let{title:t,id:i}=e;return t===fe.selectedDashboard?.label&&i===fe.selectedDashboard?.value}))&&fe.selectedDashboard.value!==J.i0))return Ze({...fe,errors:{...fe.errors,dashboard:(0,a.t)("This field may not be blank")}}),!1;Ze({...fe,loading:!0});try{return await(0,b.QL)(pe,r.slug,e),!0}catch(e){return Ze({...fe,loading:!1,errors:{...fe.errors,...(0,J.wc)(e?.responseJSON??{},{})}}),!1}}(e))if(Te&&(0,B.Z)("dashboards_views.widget_library.add_widget",{organization:r,title:Te}),me(!0),ce)!function(e){if(!fe.selectedDashboard)return;const t={queryNames:[],queryConditions:[],queryFields:[...e.queries[0].columns,...e.queries[0].aggregates],queryOrderby:e.queries[0].orderby};e.queries.forEach((e=>{t.queryNames.push(e.name),t.queryConditions.push(e.conditions)}));const i={displayType:e.displayType,interval:e.interval,title:e.title,...t,project:ue.projects,environment:ue.environments,...h()(ue.datetime,"period"),statsPeriod:ue.datetime?.period};(0,Z.S9)((0,a.t)("Added widget.")),Ue(fe.selectedDashboard.value,i)}(e);else{if(we){let i=[...t.widgets];const s=_e(),n={...e,id:we.id};return(0,W.I_)(we.displayType)!==(0,W.I_)(e.displayType)?(i[s]=(0,W.W8)(n),i=(0,W.Bb)(i)):i[s]=n,m(i),(0,Z.S9)((0,a.t)("Updated widget.")),Ue(R??J.i0),void(0,B.Z)("dashboards_views.widget_builder.save",{organization:r,data_set:e.widgetType??U.l9.DISCOVER,new_widget:!1})}m([...t.widgets,e]),(0,Z.S9)((0,a.t)("Added widget.")),Ue(R??J.i0),(0,B.Z)("dashboards_views.widget_builder.save",{organization:r,data_set:e.widgetType??U.l9.DISCOVER,new_widget:!0})}}function Ue(e,t){const i=!g()(Ce)||t?{...Ce,...t}:void 0;e!==J.i0?S.push({pathname:`/organizations/${r.slug}/dashboard/${e}/`,query:i}):S.push({pathname:`/organizations/${r.slug}/dashboards/new/`,query:i})}function He(e){Ze({...fe,queryConditionsValid:e})}const Xe=[U.FO.LINE,U.FO.AREA,U.FO.BAR].includes(fe.displayType)&&fe.queries.length<3,$e=[U.FO.TABLE,U.FO.WORLD_MAP,U.FO.BIG_NUMBER].includes(fe.displayType),{columns:Qe,aggregates:Ge,fields:Ye,fieldAliases:Je=[]}=fe.queries[0],Ke=(0,l.useMemo)((()=>Qe.map(((e,t)=>(0,I.HM)({field:e,alias:Je[t]})))),[Qe,Je]),et=(0,l.useMemo)((()=>Ge.map(((e,t)=>(0,I.HM)({field:e,alias:Je[t]})))),[Ge,Je]),it=(0,k.ri)(Ye)?Ye.map(((e,t)=>(0,I.HM)({field:e,alias:Je[t]}))):[...Ke,...et],st=Ee.queries.some((e=>e.columns.filter((e=>!!e)).length>0)),rt=Fe&&st||Ae;return re&&!oe?(0,ie.tZ)(_.Z,{title:t.title,orgSlug:de,children:(0,ie.tZ)(n.JH,{children:(0,ie.tZ)(C.Z,{message:(0,a.t)("The widget you want to edit was not found.")})})}):(0,ie.tZ)(_.Z,{title:t.title,orgSlug:de,children:(0,ie.tZ)(F.Z,{defaultSelection:{datetime:{start:null,end:null,utc:null,period:X.GY}},children:(0,ie.tZ)(D.L,{organization:r,selection:o,children:(0,ie.tZ)(Q.KC,{children:(0,ie.tZ)(z.BT,{organization:r,location:s,children:(0,ie.tZ)(H.d,{organization:r,eventView:L.ZP.fromLocation(s),location:s,hideLoadingIndicator:!0,children:e=>(0,ie.tZ)(P.kP,{location:s,forceTransactions:e.forceTransactionsOnly,children:(0,ie.BX)(Ft,{children:[(0,ie.tZ)(yt,{orgSlug:de,title:fe.title,dashboardTitle:t.title,goBackLocation:Oe,onChangeTitle:e=>{Re("title",e)}}),(0,ie.BX)(Rt,{children:[(0,ie.BX)(Dt,{children:[(0,ie.BX)(kt,{children:[!r.features.includes("dashboards-top-level-filter")&&(0,ie.BX)(At,{condensed:!0,children:[(0,ie.tZ)(A.Z,{}),(0,ie.tZ)(x.Z,{}),(0,ie.tZ)(T.Z,{alignDropdown:"left"})]}),(0,ie.BX)(_t,{symbol:"colored-numeric",children:[(0,ie.tZ)(tt,{location:s,widget:Ee,dashboardFilters:t.filters,organization:r,pageFilters:ue,displayType:fe.displayType,error:fe.errors?.displayType,onChange:e=>{Re("displayType",e)},noDashboardsMEPProvider:!0,isWidgetInvalid:!fe.queryConditionsValid}),(0,ie.tZ)(le,{dataSet:fe.dataSet,displayType:fe.displayType,onChange:ke,hasReleaseHealthFeature:te}),Ae&&(0,ie.tZ)(Q.k,{children:e=>{let{isMetricsData:t}=e;return(0,ie.tZ)(ae,{dataSet:fe.dataSet,queries:fe.queries,displayType:fe.displayType,widgetType:Se,queryErrors:fe.errors?.queries,onQueryChange:Le,handleColumnFieldChange:Ie(t),explodedFields:it,tags:E,organization:r})}}),![U.FO.TABLE].includes(fe.displayType)&&(0,ie.tZ)(dt,{dataSet:fe.dataSet,displayType:fe.displayType,widgetType:Se,queryErrors:fe.errors?.queries,onYAxisChange:e=>{!function(e){const t=e.map(I.sN),i=c()(fe),s=fe.queries.map((e=>{let i=c()(e);return fe.displayType===U.FO.TOP_N?(i.fields=[...i.fields?.slice(0,i.fields.length-1)??[],...t],i.aggregates=[...i.aggregates.slice(0,i.aggregates.length-1),...t]):(i.fields=[...i.columns,...t],i.aggregates=t),he.handleOrderByReset&&(i=he.handleOrderByReset(i,t)),i}));f()(i,"queries",s),f()(i,"userHasModified",!0);const r=i.queries[0].columns.filter((e=>!("equation|"===e)));0===r.length?f()(i,"limit",void 0):f()(i,"limit",Math.min(i.limit??J._k,(0,J.oA)(s.length,s[0].aggregates.length))),Ze(i)}(e)},aggregates:et,tags:E,organization:r}),(0,ie.tZ)(be,{queries:fe.queries,hideLegendAlias:$e,canAddSearchConditions:Xe,organization:r,queryErrors:fe.errors?.queries,onAddSearchConditions:Be,onQueryChange:Le,onQueryRemove:De,selection:ue,widgetType:Se,dashboardFilters:t.filters,location:s,onQueryConditionChange:He}),Fe&&(0,ie.tZ)(Ve,{columns:Qe.filter((e=>!("equation|"===e))).map(((e,t)=>(0,I.HM)({field:e,alias:Je[t]}))),onGroupByChange:Ne,organization:r,tags:E,dataSet:fe.dataSet}),rt&&(0,ie.tZ)(Me.j,{limit:fe.limit,displayType:fe.displayType,queries:fe.queries,dataSet:fe.dataSet,error:fe.errors?.orderby,onSortByChange:Pe,onLimitChange:ze,organization:r,widgetType:Se,tags:E})]})]}),(0,ie.tZ)(ut,{goBackLocation:Oe,isEditing:re,onSave:We,onDelete:je,invalidForm:!((!ce||fe.selectedDashboard)&&fe.queryConditionsValid)})]}),(0,ie.tZ)(Bt,{children:(0,ie.tZ)(vt,{organization:r,selectedWidgetId:fe.userHasModified?null:fe.prebuiltWidgetId,onWidgetSelect:e=>{xe(e.title),ye((0,$.v)(e.widgetType||U.l9.DISCOVER));const{id:t,...i}=e;Ze({...fe,...i,dataSet:e.widgetType?Et[e.widgetType]:J.qg.EVENTS,userHasModified:!1,prebuiltWidgetId:t||null})},bypassOverwriteModal:!fe.userHasModified})})]})]})})})})})})})})}Ct.displayName="WidgetBuilder";const Ot=(0,M.Z)((0,j.Z)(Ct)),Ft=(0,d.Z)(n.JH,{target:"e1rwomk16"})({name:"1hcx8jb",styles:"padding:0"}),At=(0,d.Z)(O.Z,{target:"e1rwomk15"})("margin-bottom:",(0,R.Z)(2),";"),_t=(0,d.Z)(E.Z,{target:"e1rwomk14"})("gap:",(0,R.Z)(4),";max-width:100%;"),Rt=(0,d.Z)(S.uT,{target:"e1rwomk13"})("&&{gap:0;padding:0;}grid-template-rows:1fr;@media (min-width: ",(e=>e.theme.breakpoints.large),"){grid-template-columns:minmax(100px, auto) 400px;}@media (min-width: ",(e=>e.theme.breakpoints.xlarge),"){grid-template-columns:1fr;}"),kt=(0,d.Z)(S.or,{target:"e1rwomk12"})("max-width:1000px;flex:1;padding:",(0,R.Z)(4)," ",(0,R.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints.medium),"){padding:",(0,R.Z)(4),";}@media (max-width: calc(",(e=>e.theme.breakpoints.large)," + ",(0,R.Z)(4),")){",q.Z,"{width:calc(100% - ",(0,R.Z)(4),");}}"),Bt=(0,d.Z)(S.MF,{target:"e1rwomk11"})("padding:",(0,R.Z)(4)," ",(0,R.Z)(2),";@media (max-width: ",(e=>e.theme.breakpoints.large),"){border-top:1px solid ",(e=>e.theme.gray200),";grid-row:2/2;grid-column:1/-1;max-width:100%;}@media (min-width: ",(e=>e.theme.breakpoints.large),"){border-left:1px solid ",(e=>e.theme.gray200),";padding-right:",(0,R.Z)(4),";max-width:400px;}"),Dt=(0,d.Z)("div",{target:"e1rwomk10"})("display:flex;flex-direction:column;@media (max-width: ",(e=>e.theme.breakpoints.large),"){grid-column:1/-1;}");function Lt(e){const t=(0,o.Z)();return(0,ie.tZ)(s.Z,{features:["dashboards-edit"],organization:t,renderDisabled:()=>(0,ie.tZ)(n.JH,{children:(0,ie.tZ)(r.Z,{type:"warning",children:(0,a.t)("You don't have access to this feature")})}),children:(0,ie.tZ)(Ot,{...e,organization:t})})}Lt.displayName="WidgetBuilderContainer";const It=Lt},"./app/views/dashboardsV2/widgetBuilder/widgetLibrary/card.tsx":(e,t,i)=>{i.d(t,{Z:()=>c});var s=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("./app/styles/space.tsx"),a=(i("../node_modules/core-js/modules/es.array.includes.js"),i("../node_modules/react/index.js"),i("./app/components/panels/index.tsx"),i("./app/icons/index.tsx")),n=i("./app/icons/iconGraphArea.tsx"),o=i("./app/icons/iconGraphBar.tsx"),d=i("./app/views/dashboardsV2/types.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){switch(e){case d.FO.TABLE:return a.dc;case d.FO.WORLD_MAP:return a.vc;case d.FO.BIG_NUMBER:return a.A8;case d.FO.BAR:return o.U;case d.FO.TOP_N:return a.CC;case d.FO.AREA:return n.g;case d.FO.LINE:default:return a.TX}}(0,r.Z)(1),(0,r.Z)(1.5),(0,r.Z)(2),(0,r.Z)(.5),(0,r.Z)(1),(0,r.Z)(1.5);function c(e){let{widget:t,iconColor:i}=e;const{title:s,description:r,displayType:a}=t,n=u(a);return(0,l.BX)(p,{children:[(0,l.tZ)(y,{backgroundColor:i,children:(0,l.tZ)(n,{color:"white"})}),(0,l.BX)(g,{children:[(0,l.tZ)(m,{children:s}),(0,l.tZ)(h,{children:r})]})]})}c.displayName="Card";const p=(0,s.Z)("div",{target:"e1kr3ej04"})("display:flex;flex-direction:row;gap:",(0,r.Z)(1),";"),g=(0,s.Z)("div",{target:"e1kr3ej03"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),m=(0,s.Z)("div",{target:"e1kr3ej02"})("font-size:",(e=>e.theme.fontSizeLarge),";font-weight:500;margin-bottom:0;color:",(e=>e.theme.gray500),";"),h=(0,s.Z)("small",{target:"e1kr3ej01"})("color:",(e=>e.theme.gray300),";"),y=(0,s.Z)("div",{target:"e1kr3ej00"})("display:flex;justify-content:center;align-items:center;padding:",(0,r.Z)(1),";min-width:40px;height:40px;border-radius:",(e=>e.theme.borderRadius),";background:",(e=>e.backgroundColor),";")},"./app/views/performance/transactionSummary/utils.tsx":(e,t,i)=>{i.d(t,{K0:()=>u,MF:()=>y,PU:()=>p,Z6:()=>m,e1:()=>g,uI:()=>f,vd:()=>h,xf:()=>c});var s=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=i("./app/styles/space.tsx"),a=i("./app/utils/discover/urls.tsx"),n=i("./app/utils/getRouteStringFromRoutes.tsx"),o=i("./app/utils/performance/urls.ts"),d=i("./app/utils/tokenizeSearch.tsx"),l=i("./app/views/performance/traceDetails/utils.tsx");let u;function c(e){const t=p(e);return t.removeFilter("transaction"),t}function p(e){const t=new d.MY(e);return t.removeFilter("event.type"),t}function g(e){let{orgSlug:t,transaction:i,projectID:s,query:r,unselectedSeries:a="p100()",display:n,trendFunction:o,trendColumn:d,showTransactions:l,additionalQuery:u}=e;const p=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/`}({orgSlug:t});let g;return g="string"==typeof r.query?c(r.query).formatString():r.query,{pathname:p,query:{transaction:i,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:g,unselectedSeries:a,showTransactions:l,display:n,trendFunction:o,trendColumn:d,...u}}}function m(e){return(t,i,s)=>{const r=`${i.trace}`;return r?(0,l.YA)(t,r,e,{}):{}}}function h(e){return(t,i,s,r)=>{const n=(0,a.JE)(i);return(0,o.D)(t.slug,n,e,s,r)}}function y(e){return(t,i,s)=>{const r=i.replayId;if(!r)return{};const a=`${i["project.name"]}:${r}`,o=encodeURIComponent((0,n.Z)(e));return{pathname:`/organizations/${t.slug}/replays/${a}`,query:{referrer:o}}}}!function(e){e.FASTEST="fastest",e.SLOW="slow",e.OUTLIER="outlier",e.RECENT="recent"}(u||(u={}));const f=(0,s.Z)("div",{target:"e1radvp0"})("margin-top:",(0,r.Z)(3),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_widgetBuilder_index_tsx-app_views_performance_transactionSummary_utils_tsx.8668153a9b1e3236e986d1822b4248d6.js.map