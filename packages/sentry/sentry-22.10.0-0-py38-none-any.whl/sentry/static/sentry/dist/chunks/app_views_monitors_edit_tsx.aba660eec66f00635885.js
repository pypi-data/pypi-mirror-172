"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_edit_tsx"],{"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>r});var s=n("./app/components/asyncComponent.tsx"),i=n("./app/components/sentryDocumentTitle.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class r extends s.Z{getTitle(){return""}render(){return(0,o.tZ)(i.Z,{title:this.getTitle(),children:this.renderComponent()})}}r.displayName="AsyncView"},"./app/views/monitors/edit.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/react/index.js"),o=n("../node_modules/react-router/es/index.js"),r=n("./app/views/asyncView.tsx"),l=n("./app/views/monitors/monitorForm.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class c extends r.Z{constructor(){super(...arguments),(0,s.Z)(this,"onUpdate",(e=>this.setState((t=>({monitor:{...t.monitor,...e}}))))),(0,s.Z)(this,"onSubmitSuccess",(e=>o.browserHistory.push(`/organizations/${this.props.params.orgId}/monitors/${e.id}/`)))}getEndpoints(){const{params:e}=this.props;return[["monitor",`/monitors/${e.monitorId}/`]]}getTitle(){return this.state.monitor?`${this.state.monitor.name} - Monitors - ${this.props.params.orgId}`:`Monitors - ${this.props.params.orgId}`}renderBody(){const{monitor:e}=this.state;return null===e?null:(0,a.BX)(i.Fragment,{children:[(0,a.tZ)("h1",{children:"Edit Monitor"}),(0,a.tZ)(l.Z,{monitor:e,apiMethod:"PUT",apiEndpoint:`/monitors/${e.id}/`,onSubmitSuccess:this.onSubmitSuccess})]})}}},"./app/views/monitors/monitorForm.tsx":(e,t,n)=>{n.d(t,{Z:()=>v});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=n("../node_modules/react/index.js"),o=n("../node_modules/mobx-react-lite/es/index.js"),r=n("./app/components/acl/access.tsx"),l=n("./app/components/forms/field/index.tsx"),a=n("./app/components/forms/fields/numberField.tsx"),c=n("./app/components/forms/fields/selectField.tsx"),d=n("./app/components/forms/fields/textField.tsx"),p=n("./app/components/forms/form.tsx"),m=n("./app/components/forms/model.tsx"),u=n("./app/components/panels/index.tsx"),h=n("./app/components/textCopyInput.tsx"),g=n("./app/locale.tsx"),f=n("./app/utils/withPageFilters.tsx"),b=n("./app/utils/withProjects.tsx"),x=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Z=[{value:"crontab",label:"Crontab"},{value:"interval",label:"Interval"}],y=[{value:"cron_job",label:"Cron Job"}],w=[{value:"minute",label:"minute(s)"},{value:"hour",label:"hour(s)"},{value:"day",label:"day(s)"},{value:"week",label:"week(s)"},{value:"month",label:"month(s)"},{value:"year",label:"year(s)"}];function _(e,t){return t.fields.toJSON().reduce(((e,t)=>{let[n,s]=t;return 0!==n.indexOf("config.")?(e[n]=s,e):(e.config||(e.config={}),"config.schedule.frequency"!==n&&"config.schedule.interval"!==n||Array.isArray(e.config.schedule)||(e.config.schedule=[null,null]),"config.schedule.frequency"===n?e.config.schedule[0]=parseInt(s,10):"config.schedule.interval"===n?e.config.schedule[1]=s:e.config[n.substr(7)]=s,e)}),{})}class j extends i.Component{constructor(){super(...arguments),(0,s.Z)(this,"form",new m.Z({transformData:_}))}formDataFromConfig(e,t){const n={};return"cron_job"===e&&(n["config.schedule_type"]=t.schedule_type,n["config.checkin_margin"]=t.checkin_margin,n["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(n["config.schedule.frequency"]=t.schedule[0],n["config.schedule.interval"]=t.schedule[1]):n["config.schedule"]=t.schedule),n}render(){const{monitor:e}=this.props,t=this.props.selection.projects[0],n=t?this.props.projects.find((e=>e.id===t+"")):null;return(0,x.tZ)(r.Z,{access:["project:write"],children:t=>{let{hasAccess:s}=t;return(0,x.BX)(p.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:this.props.apiEndpoint,apiMethod:this.props.apiMethod,model:this.form,initialData:e?{name:e.name,type:e.type,project:e.project.slug,...this.formDataFromConfig(e.type,e.config)}:{project:n?n.slug:null},onSubmitSuccess:this.props.onSubmitSuccess,children:[(0,x.BX)(u.s_,{children:[(0,x.tZ)(u.V9,{children:(0,g.t)("Details")}),(0,x.BX)(u.N,{children:[e&&(0,x.tZ)(l.Z,{label:(0,g.t)("ID"),children:(0,x.tZ)("div",{className:"controls",children:(0,x.tZ)(h.ZP,{children:e.id})})}),(0,x.tZ)(c.Z,{name:"project",label:(0,g.t)("Project"),disabled:!s,options:this.props.projects.filter((e=>e.isMember)).map((e=>({value:e.slug,label:e.slug}))),required:!0}),(0,x.tZ)(d.Z,{name:"name",placeholder:(0,g.t)("My Cron Job"),label:(0,g.t)("Name"),disabled:!s,required:!0})]})]}),(0,x.BX)(u.s_,{children:[(0,x.tZ)(u.V9,{children:(0,g.t)("Config")}),(0,x.BX)(u.N,{children:[(0,x.tZ)(c.Z,{name:"type",label:(0,g.t)("Type"),disabled:!s,options:y,required:!0}),(0,x.tZ)(o.Qj,{children:()=>"cron_job"===this.form.getValue("type")?(0,x.BX)(i.Fragment,{children:[(0,x.tZ)(a.Z,{name:"config.max_runtime",label:(0,g.t)("Max Runtime"),disabled:!s,help:(0,g.t)("The maximum runtime (in minutes) a check-in is allowed before it's marked as a failure."),placeholder:"e.g. 30"}),(0,x.tZ)(c.Z,{name:"config.schedule_type",label:(0,g.t)("Schedule Type"),disabled:!s,options:Z,required:!0})]}):null}),(0,x.tZ)(o.Qj,{children:()=>{switch(this.form.getValue("config.schedule_type")){case"crontab":return(0,x.BX)(i.Fragment,{children:[(0,x.tZ)(d.Z,{name:"config.schedule",label:(0,g.t)("Schedule"),disabled:!s,placeholder:"*/5 * * * *",required:!0,help:(0,g._N)("Changes to the schedule will apply on the next check-in. See [link:Wikipedia] for crontab syntax.",{link:(0,x.tZ)("a",{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,x.tZ)(a.Z,{name:"config.checkin_margin",label:(0,g.t)("Check-in Margin"),disabled:!s,help:(0,g.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});case"interval":return(0,x.BX)(i.Fragment,{children:[(0,x.tZ)(a.Z,{name:"config.schedule.frequency",label:(0,g.t)("Frequency"),disabled:!s,placeholder:"e.g. 1",required:!0}),(0,x.tZ)(c.Z,{name:"config.schedule.interval",label:(0,g.t)("Interval"),disabled:!s,options:w,required:!0}),(0,x.tZ)(a.Z,{name:"config.checkin_margin",label:(0,g.t)("Check-in Margin"),disabled:!s,help:(0,g.t)("The margin (in minutes) a check-in is allowed to exceed it's scheduled window before being treated as missed."),placeholder:"e.g. 30"})]});default:return null}}})]})]})]})}})}}j.displayName="MonitorForm";const v=(0,f.Z)((0,b.Z)(j))}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_edit_tsx.8fdae111428a2e162004743af031582c.js.map