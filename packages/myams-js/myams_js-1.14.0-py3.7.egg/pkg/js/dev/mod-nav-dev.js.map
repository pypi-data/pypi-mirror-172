{"version":3,"file":"mod-nav-dev.js","names":["$","MyAMS","MenuHeader","constructor","props","render","text","header","MenuDivider","Menu","items","menu","item","label","link","attr","href","key","val","Object","entries","attrs","icon","addClass","appendTo","badge","status","value","append","children","NavigationMenu","menus","parent","settings","getMenus","nav","undefined","init","find","each","idx","elt","menuItem","length","firstLink","sign","closedSign","on","evt","preventDefault","click","subMenu","slideDown","speed","html","openedSign","activeParent","parents","activeItem","currentTarget","hasClass","removeClass","replace","parentUL","accordion","visibleMenus","visibleIndex","visibleElt","close","parentIndex","parentElt","visibleItem","slideUp","delay","firstUL","is","_initialized","_hammer","_openPage","location","startsWith","hash","toString","reload","window","linkClickHandler","Promise","resolve","reject","handlers","data","stopPropagation","url","target","params","indexOf","split","unserialize","hrefGetter","core","getFunctionByName","ctrlKey","open","linkTarget","form","confirmChangedForm","then","result","skin","loadURL","fn","extend","navigationMenu","options","defaults","amsMenuAccordion","config","useSVGIcons","downIcon","FontAwesome","findIconDefinition","iconName","upIcon","menuFactory","getObject","amsMenuFactory","amsMenuConfig","require","ajax","get","checkURL","ajaxNav","document","handler","tagName","table","stats","logEvent","exists","amsUrl","amsTabLoaded","amsTabLoadOnce","remove","isMobile","dom","root","enableFastclick","check","noClickDelay","env","baseURL","extext","Hammer","Manager","add","Pan","direction","DIRECTION_HORIZONTAL","threshold","switchMenu","restoreState","initElement","element","menuSpeed","setActiveMenu","show","scroll","scrollTop","position","top","height","drawBreadcrumbs","crumb","not","template","i18n","HOME","trim","clone","end","minifyMenu","toggleClass","switchIcon","localStorage","setItem","state","getItem","bundle","modules","push","console","debug"],"sources":["mod-nav.js"],"sourcesContent":["/* global MyAMS, FontAwesome, Hammer */\n/**\n * MyAMS navigation module\n */\n\nconst $ = MyAMS.$;\n\n\n/**\n * Dynamic navigation menu class\n */\nclass MenuHeader {\n\n\tconstructor(props) {\n\t\tthis.props = props;\n\t}\n\n\trender() {\n\t\treturn $('<li class=\"header\"></li>')\n\t\t\t.text(this.props.header || '');\n\t}\n}\n\nclass MenuDivider {\n\n\trender() {\n\t\treturn $('<li class=\"divider\"></li>');\n\t}\n}\n\nclass Menu {\n\n\tconstructor(items) {\n\t\tthis.items = items;\n\t}\n\n\trender() {\n\t\tconst menu = $('<div></div>');\n\t\tfor (const item of this.items) {\n\t\t\tif (item.label) {\n\t\t\t\tconst\n\t\t\t\t\tprops = $('<li></li>'),\n\t\t\t\t\tlink = $('<a></a>')\n\t\t\t\t\t\t.attr('href', item.href || '#')\n\t\t\t\t\t\t.attr('title', item.label);\n\t\t\t\tfor (const [key, val] of Object.entries(item.attrs || {})) {\n\t\t\t\t\tlink.attr(key, val);\n\t\t\t\t}\n\t\t\t\tif (item.icon) {\n\t\t\t\t\t$('<i class=\"fa-lg fa-fw mr-1\"></i>')\n\t\t\t\t\t\t.addClass(item.icon)\n\t\t\t\t\t\t.appendTo(link);\n\t\t\t\t}\n\t\t\t\t$('<span class=\"menu-item-parent\"></span>')\n\t\t\t\t\t.text(item.label)\n\t\t\t\t\t.appendTo(link);\n\t\t\t\tif (item.badge) {\n\t\t\t\t\t$('<span class=\"badge ml-1 mr-3 float-right\"></span>')\n\t\t\t\t\t\t.addClass(`bg-${item.badge.status}`)\n\t\t\t\t\t\t.text(item.badge.value)\n\t\t\t\t\t\t.appendTo(link);\n\t\t\t\t}\n\t\t\t\tlink.appendTo(props);\n\t\t\t\tif (item.items) {\n\t\t\t\t\t$('<ul></ul>')\n\t\t\t\t\t\t.append(new Menu(item.items).render())\n\t\t\t\t\t\t.appendTo(props);\n\t\t\t\t}\n\t\t\t\tprops.appendTo(menu);\n\t\t\t} else {\n\t\t\t\tnew MenuDivider().render().appendTo(menu);\n\t\t\t}\n\t\t}\n\t\treturn menu.children();\n\t}\n}\n\nexport class NavigationMenu {\n\n\tconstructor(menus, parent, settings) {\n\t\tthis.menus = menus;\n\t\tthis.parent = parent;\n\t\tthis.settings = settings;\n\t}\n\n\tgetMenus() {\n\t\tconst nav = $('<ul></ul>');\n\t\tfor (const props of this.menus) {\n\t\t\tif (props.header !== undefined) {\n\t\t\t\tnav.append(new MenuHeader(props).render());\n\t\t\t}\n\t\t\tnav.append(new Menu(props.items).render());\n\t\t}\n\t\treturn nav;\n\t}\n\n\trender() {\n\t\tconst menus = this.getMenus();\n\t\tthis.init(menus);\n\t\tthis.parent.append(menus);\n\t}\n\n\tinit(menus) {\n\t\tconst settings = this.settings;\n\t\t// add mark to menus with children\n\t\tmenus.find('li').each((idx, elt) => {\n\t\t\tconst menuItem = $(elt);\n\t\t\tif (menuItem.find('ul').length > 0) {\n\t\t\t\tconst firstLink = menuItem.find('a:first');\n\t\t\t\t// add multi-level sign next to link\n\t\t\t\tconst sign = $(`<b class=\"collapse-sign\">${settings.closedSign}</b>`);\n\t\t\t\tsign.on('click', (evt) => {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t});\n\t\t\t\tfirstLink.append(sign);\n\t\t\t\t// avoid jumping to top of page when href is a #\n\t\t\t\tif (firstLink.attr('href') === '#') {\n\t\t\t\t\tfirstLink.click(() => {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t// slide down open menus\n\t\tmenus.find('li.open').each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tmenu = $(elt),\n\t\t\t\tsubMenu = $('> ul', menu);\n\t\t\tsubMenu.slideDown(settings.speed);\n\t\t\tmenu.find('>a b.collapse-sign').html(settings.openedSign);\n\t\t});\n\t\t// open active level\n\t\tmenus.find('li.active').each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tactiveParent = $(elt).parents('ul'),\n\t\t\t\tactiveItem = activeParent.parent('li');\n\t\t\tactiveParent.slideDown(settings.speed);\n\t\t\tactiveItem.find('b:first').html(settings.openedSign);\n\t\t\tactiveItem.addClass('open');\n\t\t});\n\t\t// handle click event\n\t\tmenus.find(\"li a\").on('click', (evt) => {\n\t\t\tconst link = $(evt.currentTarget);\n\t\t\tif (link.hasClass('active')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlink.parents('li').removeClass('active');\n\t\t\tconst\n\t\t\t\thref = link.attr('href').replace(/^#/, ''),\n\t\t\t\tparentUL = link.parent().find(\"ul\");\n\t\t\tif (settings.accordion) {\n\t\t\t\tconst\n\t\t\t\t\tparents = link.parent().parents(\"ul\"),\n\t\t\t\t\tvisibleMenus = menus.find(\"ul:visible\");\n\t\t\t\tvisibleMenus.each((visibleIndex, visibleElt) => {\n\t\t\t\t\tlet close = true;\n\t\t\t\t\tparents.each((parentIndex, parentElt) => {\n\t\t\t\t\t\tif (parentElt === visibleElt) {\n\t\t\t\t\t\t\tclose = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (close && (parentUL !== visibleElt)) {\n\t\t\t\t\t\tconst visibleItem = $(visibleElt);\n\t\t\t\t\t\tif (href || !visibleItem.hasClass('active')) {\n\t\t\t\t\t\t\tvisibleItem.slideUp(settings.speed, () => {\n\t\t\t\t\t\t\t\tvisibleItem.parent(\"li\")\n\t\t\t\t\t\t\t\t\t.removeClass('open')\n\t\t\t\t\t\t\t\t\t.find(\"b:first\")\n\t\t\t\t\t\t\t\t\t.delay(settings.speed)\n\t\t\t\t\t\t\t\t\t.html(settings.closedSign);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst firstUL = link.parent().find(\"ul:first\");\n\t\t\tif (!href && firstUL.is(\":visible\") && !firstUL.hasClass(\"active\")) {\n\t\t\t\tfirstUL.slideUp(settings.speed, () => {\n\t\t\t\t\tlink.parent(\"li\")\n\t\t\t\t\t\t.removeClass(\"open\")\n\t\t\t\t\t\t.find(\"b:first\")\n\t\t\t\t\t\t.delay(settings.speed)\n\t\t\t\t\t\t.html(settings.closedSign);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfirstUL.slideDown(settings.speed, () => {\n\t\t\t\t\tlink.parent(\"li\")\n\t\t\t\t\t\t.addClass(\"open\")\n\t\t\t\t\t\t.find(\"b:first\")\n\t\t\t\t\t\t.delay(settings.speed)\n\t\t\t\t\t\t.html(settings.openedSign);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n}\n\n\nlet _initialized = false,\n\t_hammer = null;\n\n\n/**\n * Main navigation module\n */\n\nfunction _openPage(href) {\n\tif (location && href.startsWith('#')) {\n\t\tif (href !== location.hash) {\n\t\t\tlocation.hash = href;\n\t\t}\n\t} else {\n\t\tif (location.toString() === href) {\n\t\t\tlocation.reload();\n\t\t} else {\n\t\t\twindow.location = href;\n\t\t}\n\t}\n}\n\n/**\n * Main link click event handler\n *\n * @param evt\n */\nexport function linkClickHandler(evt) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst\n\t\t\tlink = $(evt.currentTarget),\n\t\t\thandlers = link.data('ams-disabled-handlers');\n\t\tif ((handlers === true) || (handlers === 'click') || (handlers === 'all')) {\n\t\t\treturn;\n\t\t}\n\t\tlet href = link.attr('href') || link.data('ams-url');\n\t\tif (!href ||\n\t\t\thref.startsWith('javascript:') ||\n\t\t\tlink.attr('target') ||\n\t\t\t(link.data('ams-context-menu') === true)) {\n\t\t\treturn;\n\t\t}\n\t\tevt.preventDefault();\n\t\tevt.stopPropagation();\n\n\t\tlet url,\n\t\t\ttarget,\n\t\t\tparams;\n\t\tif (href.indexOf('?') >= 0) {\n\t\t\turl = href.split('?');\n\t\t\ttarget = url[0];\n\t\t\tparams = url[1].unserialize();\n\t\t} else {\n\t\t\ttarget = href;\n\t\t\tparams = undefined;\n\t\t}\n\t\tconst hrefGetter = MyAMS.core.getFunctionByName(target);\n\t\tif (typeof hrefGetter === 'function') {\n\t\t\thref = hrefGetter(link, params);\n\t\t}\n\t\tif (!href) {\n\t\t\tresolve(null);\n\t\t}\n\t\telse if (typeof href === 'function') {\n\t\t\tresolve(href(link, params));\n\t\t} else {\n\t\t\t// Standard AJAX or browser URL call\n\t\t\t// Convert %23 characters to #\n\t\t\thref = href.replace(/%23/, '#');\n\t\t\tif (evt.ctrlKey) {\n\t\t\t\twindow.open && window.open(href);\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\tconst linkTarget = link.data('ams-target') || link.attr('target');\n\t\t\t\tif (linkTarget) {\n\t\t\t\t\tif (linkTarget === '_blank') {\n\t\t\t\t\t\twindow.open && window.open(href);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else if (linkTarget === '_top') {\n\t\t\t\t\t\twindow.location = href;\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (MyAMS.form) {\n\t\t\t\t\t\t\tMyAMS.form.confirmChangedForm().then((result) => {\n\t\t\t\t\t\t\t\tif (result !== 'success') {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tMyAMS.skin && MyAMS.skin.loadURL(href, linkTarget,\n\t\t\t\t\t\t\t\t\tlink.data('ams-link-options'),\n\t\t\t\t\t\t\t\t\tlink.data('ams-link-callback')).then(resolve, reject);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tMyAMS.skin && MyAMS.skin.loadURL(href, linkTarget,\n\t\t\t\t\t\t\t\tlink.data('ams-link-options'),\n\t\t\t\t\t\t\t\tlink.data('ams-link-callback')).then(resolve, reject);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (MyAMS.form) {\n\t\t\t\t\t\tMyAMS.form.confirmChangedForm().then((result) => {\n\t\t\t\t\t\t\tif (result !== 'success') {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_openPage(href);\n\t\t\t\t\t\t}).then(resolve);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t_openPage(href);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n\nexport const nav = {\n\n\t/**\n\t * initialize navigation through data attributes\n\t */\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\t$.fn.extend({\n\n\t\t\tnavigationMenu: function(options) {\n\t\t\t\tif (this.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst data = this.data();\n\t\t\t\tconst defaults = {\n\t\t\t\t\taccordion: data.amsMenuAccordion !== false,\n\t\t\t\t\tspeed: 200\n\t\t\t\t}\n\t\t\t\tif (MyAMS.config.useSVGIcons) {\n\t\t\t\t\tconst\n\t\t\t\t\t\tdownIcon = FontAwesome.findIconDefinition({iconName: 'angle-down'}),\n\t\t\t\t\t\tupIcon = FontAwesome.findIconDefinition({iconName: 'angle-up'});\n\t\t\t\t\t$.extend(defaults, {\n\t\t\t\t\t\tclosedSign: `<em data-fa-i2svg>${FontAwesome.icon(downIcon).html}</em>`,\n\t\t\t\t\t\topenedSign: `<em data-fa-i2svg>${FontAwesome.icon(upIcon).html}</em>`\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$.extend(defaults, {\n\t\t\t\t\t\tclosedSign: '<em class=\"fa fa-angle-down\"></em>',\n\t\t\t\t\t\topenedSign: '<em class=\"fa fa-angle-up\"></em>'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tconst\n\t\t\t\t\tsettings = $.extend({}, defaults, options),\n\t\t\t\t\tmenuFactory = MyAMS.core.getObject(data.amsMenuFactory) || NavigationMenu;\n\t\t\t\tif (data.amsMenuConfig) {\n\t\t\t\t\tMyAMS.require('ajax', 'skin').then(() => {\n\t\t\t\t\t\tMyAMS.ajax.get(data.amsMenuConfig).then(result => {\n\t\t\t\t\t\t\tnew menuFactory(result, $(this), settings).render();\n\t\t\t\t\t\t\tMyAMS.skin.checkURL();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {  // static menus\n\t\t\t\t\tconst menus = $('ul', this);\n\t\t\t\t\tnew menuFactory(null, $(this), settings).init(menus);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (MyAMS.config.ajaxNav) {\n\n\t\t\t// Disable clicks on # hrefs\n\t\t\t$(document).on('click', 'a[href=\"#\"]', (evt) => {\n\t\t\t\tevt.preventDefault();\n\t\t\t});\n\n\t\t\t// Activate clicks\n\t\t\t$(document).on('click',\n\t\t\t\t'a[href!=\"#\"]:not([data-toggle]), [data-ams-url]:not([data-toggle])', (evt) => {\n\t\t\t\t// check for specific click handler\n\t\t\t\tconst handler = $(evt).data('ams-click-handler');\n\t\t\t\tif (handler) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// check for DataTable collapse handler\n\t\t\t\tif (evt.target.tagName === 'TD') {\n\t\t\t\t\tconst target = $(evt.target);\n\t\t\t\t\tif (target.hasClass('dtr-control')) {\n\t\t\t\t\t\tconst table = target.parents('table.datatable');\n\t\t\t\t\t\tif (table.hasClass('collapsed')) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn linkClickHandler(evt);\n\t\t\t});\n\n\t\t\t// Blank target clicks\n\t\t\t$(document).on('click', 'a[target=\"_blank\"]', (evt) => {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tconst target = $(evt.currentTarget);\n\t\t\t\twindow.open && window.open(target.attr('href'));\n\t\t\t\tMyAMS.stats && MyAMS.stats.logEvent(\n\t\t\t\t\ttarget.data('ams-stats-category') || 'Navigation',\n\t\t\t\t\ttarget.data('ams-stats-action') || 'External',\n\t\t\t\t\ttarget.data('ams-stats-label') || target.attr('href'));\n\t\t\t});\n\n\t\t\t// Top target clicks\n\t\t\t$(document).on('click', 'a[target=\"_top\"]', (evt) => {\n\t\t\t\tevt.preventDefault();\n\t\t\t\tMyAMS.form && MyAMS.form.confirmChangedForm().then((result) => {\n\t\t\t\t\tif (result !== 'success') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twindow.location = $(evt.currentTarget).attr('href');\n\t\t\t\t})\n\t\t\t});\n\n\t\t\t// Disable clicks on disabled tabs\n\t\t\t$(document).on(\"click\", '.nav-tabs a[data-toggle=tab]', (evt) => {\n\t\t\t\tif ($(evt.currentTarget).parent('li').hasClass(\"disabled\")) {\n\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Enable tabs dynamic loading\n\t\t\t$(document).on('show.bs.tab', (evt) => {\n\t\t\t\tlet link = $(evt.target);\n\t\t\t\tif (link.exists() && (link.get(0).tagName !== 'A')) {\n\t\t\t\t\tlink = $('a[href]', link);\n\t\t\t\t}\n\t\t\t\tconst data = link.data();\n\t\t\t\tif (data && data.amsUrl) {\n\t\t\t\t\tif (data.amsTabLoaded) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlink.append('<i class=\"fa fa-spin fa-cog ml-1\"></i>');\n\t\t\t\t\tMyAMS.require('skin').then(() => {\n\t\t\t\t\t\tMyAMS.skin.loadURL(data.amsUrl, link.attr('href')).then(() => {\n\t\t\t\t\t\t\tif (data.amsTabLoadOnce) {\n\t\t\t\t\t\t\t\tdata.amsTabLoaded = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$('i', link).remove();\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t$('i', link).remove();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!MyAMS.config.isMobile) {\n\t\t\t\tMyAMS.dom.root.addClass('desktop-detected');\n\t\t\t} else {\n\t\t\t\tMyAMS.dom.root.addClass('mobile-detected');\n\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\tif (MyAMS.config.enableFastclick) {\n\t\t\t\t\t\tMyAMS.ajax.check($.fn.noClickDelay,\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/js-smartclick${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t$('a', MyAMS.dom.nav).noClickDelay();\n\t\t\t\t\t\t\t$('a', '#hide-menu').noClickDelay();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (MyAMS.dom.root.exists()) {\n\t\t\t\t\t\tMyAMS.ajax.check(window.Hammer,\n\t\t\t\t\t\t\t`${MyAMS.env.baseURL}../ext/hammer${MyAMS.env.extext}.js`).then(() => {\n\t\t\t\t\t\t\t_hammer = new Hammer.Manager(MyAMS.dom.root.get(0));\n\t\t\t\t\t\t\t_hammer.add(new Hammer.Pan({\n\t\t\t\t\t\t\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t\t\t\t\t\t\t\tthreshold: 200\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t_hammer.on('panright', () => {\n\t\t\t\t\t\t\t\tif (!MyAMS.dom.root.hasClass('hidden-menu')) {\n\t\t\t\t\t\t\t\t\tMyAMS.nav.switchMenu();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t_hammer.on('panleft', () => {\n\t\t\t\t\t\t\t\tif (MyAMS.dom.root.hasClass('hidden-menu')) {\n\t\t\t\t\t\t\t\t\tMyAMS.nav.switchMenu();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tnav.restoreState();\n\t},\n\n\tinitElement: (element) => {\n\n\t\t$('nav', element).navigationMenu({\n\t\t\tspeed: MyAMS.config.menuSpeed\n\t\t});\n\t},\n\n\t/**\n\t * Display current active menu\n\t *\n \t * @param menu: current active menu\n\t */\n\tsetActiveMenu: (menu) => {\n\t\tconst nav = MyAMS.dom.nav;\n\t\t$('.active', nav).removeClass('active');\n\t\tmenu.addClass('open')\n\t\t\t.addClass('active');\n\t\tmenu.parents('li').addClass('open active')\n\t\t\t.children('ul').addClass('active')\n\t\t\t.show();\n\t\tmenu.parents('li:first').removeClass('open');\n\t\tmenu.parents('ul').addClass(menu.attr('href').replace(/^#/, '') ? 'active' : '')\n\t\t\t.show();\n\t\tif (menu.exists()) {\n\t\t\tconst\n\t\t\t\tscroll = nav.scrollTop(),\n\t\t\t\tposition = $(menu).parents('li:last').position();\n\t\t\tif (position.top < scroll) {\n\t\t\t\tnav.scrollTop(position.top);\n\t\t\t} else if (position.top > nav.height() + scroll) {\n\t\t\t\tnav.scrollTop(position.top);\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Internal breadcrumbs drawing function\n\t *\n\t * @private\n\t */\n\tdrawBreadcrumbs: () => {\n\t\tconst crumb = $('ol.breadcrumb', '#ribbon');\n\t\t$('li', crumb).not('.persistent').remove();\n\t\tif (!$('li', crumb).exists()) {\n\t\t\tconst template = `<li class=\"breadcrumb-item\">\n\t\t\t\t\t<a class=\"p-r-1\" href=\"${$('a[href!=\"#\"]:first', MyAMS.dom.nav).attr('href')}\">\n\t\t\t\t\t\t${MyAMS.i18n.HOME}\n\t\t\t\t\t</a>\n\t\t\t\t</li>`;\n\t\t\tcrumb.append($(template));\n\t\t}\n\t\t$('li.active >a', MyAMS.dom.nav).each((idx, elt) => {\n\t\t\tconst\n\t\t\t\tmenu = $(elt),\n\t\t\t\ttext = $.trim(menu.clone()\n\t\t\t\t\t.children('.badge')\n\t\t\t\t\t.remove()\n\t\t\t\t\t.end()\n\t\t\t\t\t.text()),\n\t\t\t\thref = menu.attr('href'),\n\t\t\t\titem = $('<li class=\"breadcrumb-item\"></li>').append(href.replace(/^#/, '') ?\n\t\t\t\t\t$('<a></a>').html(text).attr('href', href) : text);\n\t\t\tcrumb.append(item);\n\t\t});\n\t},\n\n\t/**\n\t * Click handler for navigation menu \"minify\" button\n\t *\n\t * @param evt: original click event\n\t */\n\tminifyMenu: (evt) => {\n\t\tevt && evt.preventDefault();\n\t\tMyAMS.dom.root.toggleClass('minified');\n\t\tif (MyAMS.dom.root.hasClass('minified')) {\n\t\t\tMyAMS.core.switchIcon($('i', evt.currentTarget),\n\t\t\t\t'arrow-circle-left', 'arrow-circle-right');\n\t\t} else {\n\t\t\tMyAMS.core.switchIcon($('i', evt.currentTarget),\n\t\t\t\t'arrow-circle-right', 'arrow-circle-left');\n\t\t}\n\t\tif (window.localStorage) {\n\t\t\tif (MyAMS.dom.root.hasClass('minified')) {\n\t\t\t\tlocalStorage.setItem('window-state', 'minified');\n\t\t\t} else {\n\t\t\t\tlocalStorage.setItem('window-state', '');\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Click handler for menu hide button\n\t *\n\t * @param evt: original click event\n\t */\n\tswitchMenu: (evt) => {\n\t\tevt && evt.preventDefault();\n\t\tMyAMS.dom.root.toggleClass('hidden-menu');\n\t\tif (window.localStorage) {\n\t\t\tif (MyAMS.dom.root.hasClass('hidden-menu')) {\n\t\t\t\tlocalStorage.setItem('window-state', 'hidden-menu');\n\t\t\t} else {\n\t\t\t\tlocalStorage.setItem('window-state', '');\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Restore window state on application startup\n\t *\n\t * Previous window state is stored in local storage.\n\t */\n\trestoreState: () => {\n\t\t// restore window state\n\t\tif (window.localStorage) {\n\t\t\tconst state = localStorage.getItem('window-state');\n\t\t\tif (state === 'minified') {\n\t\t\t\tMyAMS.nav.minifyMenu({\n\t\t\t\t\tcurrentTarget: $('#minifyme'),\n\t\t\t\t\tpreventDefault: () => {}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tMyAMS.dom.root.addClass(state);\n\t\t\t}\n\t\t}\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (MyAMS.env.bundle) {\n\tMyAMS.config.modules.push('nav');\n} else {\n\tMyAMS.nav = nav;\n\tconsole.debug(\"MyAMS: nav module loaded...\");\n}\n"],"mappings":"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"}