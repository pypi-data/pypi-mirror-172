{"version":3,"file":"mod-skin-dev.js","names":["$","MyAMS","_initialized","skin","init","config","enableTooltips","dom","root","tooltip","selector","html","enableHtmlTooltips","mousedown","evt","currentTarget","document","on","remove","checkURL","window","initElement","element","Promise","resolve","reject","nav","hash","location","url","replace","tag","tagPosition","indexOf","substring","menu","container","exists","loadURL","then","prefix","data","fullPrefix","title","attr","text","trim","anchor","require","helpers","scrollTo","offset","setActiveMenu","drawBreadcrumbs","activeUrl","first","href","target","options","startsWith","substr","core","executeFunctionByName","clearContent","status","defaults","type","dataType","cache","beforeSend","i18n","LOADING","preLoadCallback","preLoadCallbackOptions","animate","scrollTop","settings","extend","veto","trigger","ajax","result","xhr","isArray","response","getResponse","contentType","handleJSON","parents","removeClass","css","opacity","delay","initContent","form","setFocus","afterLoadCallback","afterLoadCallbackOptions","stats","logPageview","error","ERROR","responseText","env","bundle","modules","push","console","debug"],"sources":["mod-skin.js"],"sourcesContent":["/* global MyAMS */\n/**\n * MyAMS generic skin features\n */\n\nconst $ = MyAMS.$;\n\n\nlet _initialized = false;\n\n\nexport const skin = {\n\n\t/**\n\t * Main *skin* module initialization\n\t */\n\tinit: () => {\n\n\t\tif (_initialized) {\n\t\t\treturn;\n\t\t}\n\t\t_initialized = true;\n\n\t\t// handle tooltips\n\t\tif (MyAMS.config.enableTooltips) {\n\t\t\tMyAMS.dom.root.tooltip({\n\t\t\t\tselector: '.hint',\n\t\t\t\thtml: MyAMS.config.enableHtmlTooltips\n\t\t\t});\n\t\t}\n\t\t$('.hint').mousedown((evt) => {\n\t\t\t$(evt.currentTarget).tooltip('hide');\n\t\t});\n\t\t$(document).on('clear.ams.content', () => {\n\t\t\t$('.tooltip').remove();\n\t\t});\n\n\t\t// check URL when hash is changed\n\t\tskin.checkURL();\n\t\t$(window).on('hashchange', skin.checkURL);\n\t},\n\n\t/**\n\t * Specific content initialization\n\t *\n\t * @param element: the element to initialize\n\t */\n\tinitElement: (element) => {\n\t\tif (!MyAMS.config.enableTooltips) {\n\t\t\t$('.hint', element).tooltip({\n\t\t\t\thtml: MyAMS.config.enableHtmlTooltips\n\t\t\t});\n\t\t}\n\t},\n\n\t/**\n\t * URL checking function.\n\t *\n\t * This function is an event handler for window's \"hashchange\" event, which is\n\t * triggered when the window location hash is modified; this can notably occur when a\n\t * navigation menu, for example, is clicked.\n\t */\n\tcheckURL: () => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst nav = MyAMS.dom.nav;\n\t\t\tlet hash = location.hash,\n\t\t\t\turl = hash.replace(/^#/, ''),\n\t\t\t\ttag = null;\n\t\t\tconst tagPosition = url.indexOf('!');\n\t\t\tif (tagPosition > 0) {\n\t\t\t\thash = hash.substring(0, tagPosition + 1);\n\t\t\t\ttag = url.substring(tagPosition + 1);\n\t\t\t\turl = url.substring(0, tagPosition);\n\t\t\t}\n\t\t\tlet menu;\n\t\t\tif (url) {\n\t\t\t\t// new hash\n\t\t\t\tlet container = $('#content');\n\t\t\t\tif (!container.exists()) {\n\t\t\t\t\tcontainer = MyAMS.dom.root;\n\t\t\t\t}\n\t\t\t\tmenu = $(`a[href=\"${hash}\"]`, nav);\n\t\t\t\t// load specified URL into '#content'\n\t\t\t\tMyAMS.skin.loadURL(url, container).then(() => {\n\t\t\t\t\tconst\n\t\t\t\t\t\tprefix = $('html head title').data('ams-title-prefix'),\n\t\t\t\t\t\tfullPrefix = prefix ? `${prefix} > ` : '';\n\t\t\t\t\tdocument.title = `${fullPrefix}${$('[data-ams-page-title]:first', container).data('ams-page-title') ||\n\t\t\t\t\t\tmenu.attr('title') || menu.text().trim() || document.title}`;\n\t\t\t\t\tif (tag) {\n\t\t\t\t\t\tconst anchor = $(`#${tag}`);\n\t\t\t\t\t\tif (anchor.exists()) {\n\t\t\t\t\t\t\tMyAMS.require('helpers').then(() => {\n\t\t\t\t\t\t\t\tMyAMS.helpers.scrollTo('#main', anchor, { offset: -15 });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// try to activate matching navigation menu\n\t\t\t\t\tif (menu.exists()) {\n\t\t\t\t\t\tMyAMS.require('nav').then(() => {\n\t\t\t\t\t\t\tMyAMS.nav.setActiveMenu(menu);\n\t\t\t\t\t\t\tMyAMS.nav.drawBreadcrumbs();\n\t\t\t\t\t\t}).then(resolve);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t}, reject);\n\t\t\t} else {\n\t\t\t\t// empty hash! We try to check if a specific menu was activated with a custom\n\t\t\t\t// data attribute, otherwise we go to the first navigation menu!\n\t\t\t\tconst activeUrl = $('[data-ams-active-menu]').data('ams-active-menu');\n\t\t\t\tif (activeUrl) {\n\t\t\t\t\tmenu = $(`a[href=\"${activeUrl}\"]`, nav);\n\t\t\t\t} else {\n\t\t\t\t\tmenu = $('ul li a[href!=\"#\"]', nav).first();\n\t\t\t\t}\n\t\t\t\tif (menu.exists()) {\n\t\t\t\t\tMyAMS.require('nav').then(() => {\n\t\t\t\t\t\tMyAMS.nav.setActiveMenu(menu);\n\t\t\t\t\t\tif (activeUrl) {\n\t\t\t\t\t\t\tMyAMS.nav.drawBreadcrumbs();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// we use location.replace to avoid storing intermediate URL\n\t\t\t\t\t\t\t// into browser's history\n\t\t\t\t\t\t\twindow.location.replace(window.location.href + menu.attr('href'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(resolve, reject);\n\t\t\t\t} else {\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * Load specific URL into given container target.\n\t *\n\t * The function returns a Promise which is resolved when the remote content is actually\n\t * loaded and initialized\n\t *\n\t * @param url: remote content URL\n\t * @param target: jQuery selector or target container\n\t * @param options: additional options to AJAX call\n\t * @returns {Promise<string>}\n\t */\n\tloadURL: (url, target, options={}) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (url.startsWith('#')) {\n\t\t\t\turl = url.substr(1);\n\t\t\t}\n\t\t\ttarget = $(target);\n\t\t\tMyAMS.core.executeFunctionByName(MyAMS.config.clearContent, document, target).then((status) => {\n\t\t\t\tif (!status) {  // applied veto!\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst defaults = {\n\t\t\t\t\ttype: 'GET',\n\t\t\t\t\turl: url,\n\t\t\t\t\tdataType: 'html',\n\t\t\t\t\tcache: false,\n\t\t\t\t\tbeforeSend: () => {\n\t\t\t\t\t\ttarget.html(`<h1 class=\"loading\"><i class=\"fa fa-cog fa-spin\"></i> ${MyAMS.i18n.LOADING}</h1>`);\n\t\t\t\t\t\tif (options && options.preLoadCallback) {\n\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(options.preLoadCallback, this, options.preLoadCallbackOptions);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (target.attr('id') === 'content') {\n\t\t\t\t\t\t\tMyAMS.require('nav').then(() => {\n\t\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\t\tprefix = $('html head title').data('ams-title-prefix'),\n\t\t\t\t\t\t\t\t\tfullPrefix = prefix ? `${prefix} > ` : '';\n\t\t\t\t\t\t\t\tdocument.title = `${fullPrefix}${$('.breadcrumb li:last-child').text()}`;\n\t\t\t\t\t\t\t\tMyAMS.dom.root.animate({scrollTop: 0}, 'fast');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tconst\n\t\t\t\t\tsettings = $.extend({}, defaults, options),\n\t\t\t\t\tveto = { veto: false };\n\t\t\t\ttarget.trigger('before-load.ams.content', [settings, veto]);\n\t\t\t\tif (veto.veto) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t$.ajax(settings).then((result, status, xhr) => {\n\t\t\t\t\tif ($.isArray(result)) {\n\t\t\t\t\t\t[result, status, xhr] = result;\n\t\t\t\t\t}\n\t\t\t\t\tMyAMS.require('ajax').then(() => {\n\t\t\t\t\t\tconst response = MyAMS.ajax.getResponse(xhr);\n\t\t\t\t\t\tif (response) {\n\t\t\t\t\t\t\tconst\n\t\t\t\t\t\t\t\tdataType = response.contentType,\n\t\t\t\t\t\t\t\tresult = response.data;\n\t\t\t\t\t\t\t$('.loading', target).remove();\n\t\t\t\t\t\t\tswitch (dataType) {\n\t\t\t\t\t\t\t\tcase 'json':\n\t\t\t\t\t\t\t\t\tMyAMS.ajax.handleJSON(result, target);\n\t\t\t\t\t\t\t\t\tresolve(result, status, xhr);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\t\tcase 'xml':\n\t\t\t\t\t\t\t\t\tresolve(result, status, xhr);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'html':\n\t\t\t\t\t\t\t\tcase 'text':\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\ttarget.parents('.hidden').removeClass('hidden');\n\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(target.data('ams-clear-content') ||\n\t\t\t\t\t\t\t\t\t\tMyAMS.config.clearContent, document, target).then(() => {\n\t\t\t\t\t\t\t\t\t\ttarget.css({opacity: '0.0'})\n\t\t\t\t\t\t\t\t\t\t\t.html(result)\n\t\t\t\t\t\t\t\t\t\t\t.removeClass('hidden')\n\t\t\t\t\t\t\t\t\t\t\t.delay(30)\n\t\t\t\t\t\t\t\t\t\t\t.animate({opacity: '1.0'}, 300);\n\t\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(target.data('ams-init-content') ||\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.config.initContent, window, target).then(() => {\n\t\t\t\t\t\t\t\t\t\t\tMyAMS.form && MyAMS.form.setFocus(target);\n\t\t\t\t\t\t\t\t\t\t\tif (options && options.afterLoadCallback) {\n\t\t\t\t\t\t\t\t\t\t\t\tMyAMS.core.executeFunctionByName(options.afterLoadCallback, this, options.afterLoadCallbackOptions).then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.trigger('after-load.ams.content');\n\t\t\t\t\t\t\t\t\t\t\t\t\tresolve(result, status, xhr);\n\t\t\t\t\t\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\ttarget.trigger('after-load.ams.content');\n\t\t\t\t\t\t\t\t\t\t\t\tresolve(result, status, xhr);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t\t\t\t}, reject);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tMyAMS.stats && MyAMS.stats.logPageview();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}, (xhr, status, error) => {\n\t\t\t\t\ttarget.html(`<h3 class=\"error\"><i class=\"fa fa-exclamation-triangle text-danger\"></i> \n\t\t\t\t\t\t\t\t${MyAMS.i18n.ERROR} ${error}</h3>${xhr.responseText}`);\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('skin');\n\t} else {\n\t\tMyAMS.skin = skin;\n\t\tconsole.debug(\"MyAMS: skin module loaded...\");\n\t}\n}\n"],"mappings":"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"}