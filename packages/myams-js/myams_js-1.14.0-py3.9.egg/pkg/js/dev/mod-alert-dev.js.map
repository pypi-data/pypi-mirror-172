{"version":3,"file":"mod-alert-dev.js","names":["$","MyAMS","templates","jsrender","require","ALERT_TEMPLATE_STRING","ALERT_TEMPLATE","markup","allowCode","MESSAGE_TEMPLATE_STRING","MESSAGE_TEMPLATE","SMALLBOX_TEMPLATE_STRING","SMALLBOX_TEMPLATE","BIGBOX_TEMPLATE_STRING","BIGBOX_TEMPLATE","alert","props","status","parent","not","remove","render","prependTo","then","helpers","scrollTo","offset","messageBox","wrapper","config","alertsContainerClass","length","addClass","appendTo","dom","root","toast","on","evt","currentTarget","smallBox","bigBox","Promise","resolve","reject","target","focus","data","modal","window","env","bundle","modules","push","console","debug"],"sources":["mod-alert.js"],"sourcesContent":["/* global MyAMS */\n/**\n * MyAMS alerts management\n */\n\nconst $ = MyAMS.$;\n\nif (!$.templates) {\n\tconst jsrender = require('jsrender');\n\t$.templates = jsrender.templates;\n}\n\n\n/**\n * Alert template\n */\nconst ALERT_TEMPLATE_STRING = `\n\t<div class=\"alert alert-{{:status}}\" role=\"alert\">\n\t\t<button type=\"button\" class=\"close\" data-dismiss=\"alert\" \n\t\t\t\taria-label=\"{{*: MyAMS.i18n.BTN_CLODE }}\">\n\t\t\t<i class=\"fa fa-times\" aria-hidden=\"true\"></i>\t\n\t\t</button>\n\t\t{{if header}}\n\t\t<h5 class=\"alert-heading\">{{:header}}</h5>\n\t\t{{/if}}\n\t\t{{* if (typeof message === 'string') { }}\n\t\t<ul>\n\t\t\t<li>{{:message}}</li>\n\t\t</ul>\n\t\t{{* } else { }}\n\t\t<ul>\n\t\t{{for message}}\n\t\t\t<li>{{:}}</li>\n\t\t{{/for}}\n\t\t</ul>\n\t\t{{* } }}\n\t</div>`;\n\nconst ALERT_TEMPLATE = $.templates({\n\tmarkup: ALERT_TEMPLATE_STRING,\n\tallowCode: true\n});\n\n\n/**\n * Standard message template\n */\n\nconst MESSAGE_TEMPLATE_STRING = `\n\t<div role=\"alert\" class=\"toast toast-{{:status}} fade hide\"\n\t\t data-autohide=\"{{*: Boolean(data.timeout !== 0).toString() }}\"\n\t\t data-delay=\"{{: timeout || 5000}}\">\n\t\t<div class=\"toast-header\">\n\t\t{{if icon}}\n\t\t\t<i class=\"fa {{:icon}} mr-2\"></i>\n\t\t{{/if}}\n\t\t\t<strong class=\"mr-auto\">{{:title}}</strong>\n\t\t{{if !hideTimestamp}}\n\t\t\t<small>{{*: new Date().toLocaleTimeString() }}</small>\n\t\t{{/if}}\n\t\t\t<button type=\"button\" class=\"ml-2 mb-1 close\" data-dismiss=\"toast\">\n\t\t\t\t<i class=\"fa fa-times text-white\"></i>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class=\"toast-body\">\n\t\t\t<div>\n\t\t\t{{if content}}\n\t\t\t\t{{:content}}\n\t\t\t{{else}}\n\t\t\t\t<p>{{:message}}</p>\n\t\t\t{{/if}}\n\t\t\t</div>\n\t\t</div>\n\t</div>`;\n\nconst MESSAGE_TEMPLATE = $.templates({\n\tmarkup: MESSAGE_TEMPLATE_STRING,\n\tallowCode: true\n});\n\n\n/**\n * Small box message template\n */\n\nconst SMALLBOX_TEMPLATE_STRING = `\n\t<div role=\"alert\" class=\"toast toast-{{:status}} fade hide\"\n\t\t data-autohide=\"true\"\n\t\t data-delay=\"{{: timeout || 5000}}\">\n\t\t<div class=\"toast-body\">\n\t\t\t<div>\n\t\t\t{{if content}}\n\t\t\t\t{{:content}}\n\t\t\t{{else}}\n\t\t\t\t<span>\n\t\t\t\t\t{{if icon}}\n\t\t\t\t\t<i class=\"fa {{:icon}} mr-2\"></i>\n\t\t\t\t\t{{/if}}\n\t\t\t\t\t{{:message}}\n\t\t\t\t</span>\n\t\t\t{{/if}}\n\t\t\t</div>\n\t\t</div>\n\t</div>`;\n\nconst SMALLBOX_TEMPLATE = $.templates({\n\tmarkup: SMALLBOX_TEMPLATE_STRING,\n\tallowCode: true\n});\n\n\n/**\n * Big box message template\n */\n\nconst BIGBOX_TEMPLATE_STRING = `\n\t<div class=\"modal fade\" data-backdrop=\"static\" role=\"dialog\">\n\t\t<div class=\"modal-dialog\">\n\t\t\t<div class=\"modal-content\">\n\t\t\t\t<div class=\"modal-header alert-{{:status}}\">\n\t\t\t\t\t<h5 class=\"modal-title\">\n\t\t\t\t\t{{if icon}}\n\t\t\t\t\t\t<i class=\"fa {{:icon}} mr-2\"></i>\n\t\t\t\t\t{{/if}}\n\t\t\t\t\t{{:title}}\n\t\t\t\t\t</h5>\n\t\t\t\t\t<button type=\"button\" class=\"close\" \n\t\t\t\t\t\t\tdata-dismiss=\"modal\" data-modal-dismiss-value=\"cancel\">\n\t\t\t\t\t\t<i class=\"fa fa-times\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-body\">\n\t\t\t\t\t<p>{{:message}}</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary\" \n\t\t\t\t\t\t\tdata-dismiss=\"modal\" data-modal-dismiss-value=\"success\">\n\t\t\t\t\t\t{{*: data.successLabel || MyAMS.i18n.BTN_OK }}\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type=\"button\" class=\"btn btn-secondary\" \n\t\t\t\t\t\t\tdata-dismiss=\"modal\" data-modal-dismiss-value=\"cancel\">\n\t\t\t\t\t\t{{*: data.cancelLabel || MyAMS.i18n.BTN_CANCEL }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>`;\n\nconst BIGBOX_TEMPLATE = $.templates({\n\tmarkup: BIGBOX_TEMPLATE_STRING,\n\tallowCode: true\n});\n\n\n/**\n * Main alert object\n */\n\nexport const alert = {\n\n\t/**\n\t * Display alert message into current document\n\t *\n\t * @param props:\n\t *  - parent: DOM element which should receive the alert\n\t *  - status: alert status ('info', 'success', 'warning', 'danger'...)\n\t *  - header: alert header\n\t *  - subtitle: message sub-title\n\t *  - message: main alert message\n\t */\n\talert: (props={}) => {\n\t\tlet status = props.status || 'info';\n\t\tif (status === 'error') {\n\t\t\tstatus = 'danger';\n\t\t}\n\t\tprops.status = status;\n\t\t$(`.alert-${status}`, props.parent).not('.persistent').remove();\n\t\t$(ALERT_TEMPLATE.render(props)).prependTo(props.parent);\n\t\tMyAMS.require('helpers').then(() => {\n\t\t\tMyAMS.helpers.scrollTo('#content', props.parent, { offset: -15 });\n\t\t});\n\t},\n\n\t/**\n\t * Display notification message on bottom right\n\t *\n\t * @param props: message properties:\n\t *  - status: message status: 'info', 'success', 'warning', 'danger'\n\t *  - title: message title\n\t *  - icon: message icon\n\t *  - content: full HTML content\n\t *  - message: simple string message\n\t *  - hideTimestamp: boolean value to specify if timestamp must be hidden\n\t *  - timeout: timeout in ms; default to 5000, set to 0 to disable auto-hide\n\t */\n\tmessageBox: (props={}) => {\n\t\tlet status = props.status || 'info';\n\t\tif (status === 'error') {\n\t\t\tstatus = 'danger';\n\t\t}\n\t\tprops.status = status;\n\t\tlet wrapper = $(`.${MyAMS.config.alertsContainerClass}`);\n\t\tif (wrapper.length === 0) {\n\t\t\twrapper = $('<div></div>')\n\t\t\t\t.addClass(MyAMS.config.alertsContainerClass)\n\t\t\t\t.appendTo(MyAMS.dom.root);\n\t\t}\n\t\t$(MESSAGE_TEMPLATE.render(props))\n\t\t\t.appendTo(wrapper)\n\t\t\t.toast('show')\n\t\t\t.on('hidden.bs.toast', (evt) => {\n\t\t\t\t$(evt.currentTarget).remove();\n\t\t\t});\n\t},\n\n\t/**\n\t * Display small notification message on top right\n\t *\n\t * @param props\n\t */\n\tsmallBox: (props={}) => {\n\t\tlet status = props.status || 'info';\n\t\tif (status === 'error') {\n\t\t\tstatus = 'danger';\n\t\t}\n\t\tprops.status = status;\n\t\tlet wrapper = $(`.${MyAMS.config.alertsContainerClass}`);\n\t\tif (wrapper.length === 0) {\n\t\t\twrapper = $('<div></div>')\n\t\t\t\t.addClass(MyAMS.config.alertsContainerClass)\n\t\t\t\t.appendTo(MyAMS.dom.root);\n\t\t}\n\t\t$(SMALLBOX_TEMPLATE.render(props))\n\t\t\t.appendTo(wrapper)\n\t\t\t.toast('show')\n\t\t\t.on('hidden.bs.toast', (evt) => {\n\t\t\t\t$(evt.currentTarget).remove();\n\t\t\t});\n\t},\n\n\t/**\n\t * Modal message box\n\t *\n\t * @param props\n\t * @returns {Promise<unknown>}\n\t */\n\tbigBox: (props={}) => {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet status = props.status || 'info';\n\t\t\tif (status === 'error') {\n\t\t\t\tstatus = 'danger';\n\t\t\t}\n\t\t\tprops.status = status;\n\t\t\tMyAMS.require('modal').then(() => {\n\t\t\t\tconst alert = $(BIGBOX_TEMPLATE.render(props)).appendTo(MyAMS.dom.root);\n\t\t\t\talert.on('shown.bs.modal', (evt) => {\n\t\t\t\t\t$('.btn-primary', evt.target).focus();\n\t\t\t\t});\n\t\t\t\talert.on('hidden.bs.modal', () => {\n\t\t\t\t\tresolve(alert.data('modal-result'));\n\t\t\t\t\talert.remove();\n\t\t\t\t});\n\t\t\t\talert.modal('show');\n\t\t\t}, () => {\n\t\t\t\treject(\"Missing 'modal' module!\");\n\t\t\t});\n\t\t});\n\t}\n};\n\n\n/**\n * Global module initialization\n */\nif (window.MyAMS) {\n\tif (MyAMS.env.bundle) {\n\t\tMyAMS.config.modules.push('alert');\n\t} else {\n\t\tMyAMS.alert = alert;\n\t\tconsole.debug(\"MyAMS: alert module loaded...\");\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;EAAA;;EACA;AACA;AACA;EAEA,MAAMA,CAAC,GAAGC,KAAK,CAACD,CAAhB;;EAEA,IAAI,CAACA,CAAC,CAACE,SAAP,EAAkB;IACjB,MAAMC,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;IACAJ,CAAC,CAACE,SAAF,GAAcC,QAAQ,CAACD,SAAvB;EACA;EAGD;AACA;AACA;;;EACA,MAAMG,qBAAqB,GAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QApBA;EAsBA,MAAMC,cAAc,GAAGN,CAAC,CAACE,SAAF,CAAY;IAClCK,MAAM,EAAEF,qBAD0B;IAElCG,SAAS,EAAE;EAFuB,CAAZ,CAAvB;EAMA;AACA;AACA;;EAEA,MAAMC,uBAAuB,GAAI;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAzBA;EA2BA,MAAMC,gBAAgB,GAAGV,CAAC,CAACE,SAAF,CAAY;IACpCK,MAAM,EAAEE,uBAD4B;IAEpCD,SAAS,EAAE;EAFyB,CAAZ,CAAzB;EAMA;AACA;AACA;;EAEA,MAAMG,wBAAwB,GAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAlBA;EAoBA,MAAMC,iBAAiB,GAAGZ,CAAC,CAACE,SAAF,CAAY;IACrCK,MAAM,EAAEI,wBAD6B;IAErCH,SAAS,EAAE;EAF0B,CAAZ,CAA1B;EAMA;AACA;AACA;;EAEA,MAAMK,sBAAsB,GAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QA/BA;EAiCA,MAAMC,eAAe,G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"}