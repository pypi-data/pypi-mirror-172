(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{8573:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/bridges/setup",function(){return n(3249)}])},311:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(6042),i=n(9396),a=n(5893),o=n(7294),s=n(1163),c=n(9008),l=n.n(c),u=n(562),d=n(8849),p=n(3648),h=n(2971),g=n(2097),x=n(5050),y=n(6336),f=n(784),m=n(9072),v=n(5084),Z=n(9630),b=n(1953);function j(e){var t=e.children,n=(0,h.Z)({disableHysteresis:!0,threshold:24});return(0,o.cloneElement)(t,{elevation:n?4:0})}var w=function(){var e=(0,o.useState)(!1),t=e[0],n=e[1],r=((0,o.useCallback)((function(){n(!t)}),[t]),(0,g.Z)());return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(j,{children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.Z,{color:"transparent",elevation:0,children:(0,a.jsx)(y.Z,{maxWidth:"xl",sx:{padding:0},children:(0,a.jsx)(f.Z,{sx:{minHeight:50,maxHeight:50,padding:0,flex:1,alignItems:"center",justifyContent:"space-between",display:"flex",flexWrap:"nowrap"},children:(0,a.jsx)(m.ZP,{item:!0,children:(0,a.jsx)(v.Z,{href:"https://system-bridge.timmo.dev",target:"_blank",children:(0,a.jsx)(Z.Z,{component:"div",variant:"h4",sx:{textTransform:"none",userSelect:"none",color:r.palette.primary.contrastText},children:"System Bridge"})})})})})}),(0,a.jsx)(b.Z,{sx:{height:r.spacing(18)}})]})})})},k=!1;var P=function(e){var t=(0,s.useRouter)();return(0,o.useEffect)((function(){if(t.isReady&&!k){var e,n,a,o;k=!0;var s=(null===(e=t.query)||void 0===e?void 0:e.apiKey)||"",c=(null===(n=t.query)||void 0===n?void 0:n.apiPort)||"9170",l=!1;if((null===(a=t.query)||void 0===a?void 0:a.apiKey)||(l=!0,s=window.prompt("Please enter your API key",s)),(null===(o=t.query)||void 0===o?void 0:o.apiPort)||(l=!0,c=window.prompt("Please enter your API port (default: 9170)",c)),l&&s&&c){var u=t.asPath.split("?")[0];t.replace({pathname:u.includes(".html")?u:"".concat(u,".html"),query:(0,i.Z)((0,r.Z)({},t.query),{apiKey:s,apiPort:c})})}}}),[t]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,a.jsx)("link",{rel:"canonical",href:e.url}),(0,a.jsx)("meta",{name:"description",content:e.description?"".concat(e.description):e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,a.jsx)("meta",{name:"keywords",content:e.keywords?"".concat(e.keywords):"system-bridge, system, bridge, typescript"})]}),!e.noHeader&&(0,a.jsx)(w,{}),e.closeButton&&(0,a.jsx)(u.Z,{size:"small",sx:{position:"absolute",top:4,right:4,zIndex:1e3},onClick:function(){window.location.href="http://close.window"},children:(0,a.jsx)(d.Icon,{id:"close",path:p.r5M,size:1})}),e.children]})}},3249:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return H}});var r=n(5893),i=n(7294),a=n(311),o=n(7568),s=n(603),c=n(655),l=n(1163),u=n(2097),d=n(6336),p=n(9072),h=n(754),g=n(9630),x=n(5214),y=n(8746),f=n(4548),m=n(196),v=n(1946),Z=n(4924),b=n(6042),j=n(9396),w=n(1225),k=n(1890),P=n(7745),_=n(5398),C=n(8769),S=n(6779),K=n(5084);var E=function(e){var t=(0,i.useState)(e.bridgeEdit.bridge),n=t[0],a=t[1],s=(0,i.useState)({text:"",error:!1}),d=s[0],p=s[1],h=(0,l.useRouter)().query,x=function(e){return function(t){a((0,j.Z)((0,b.Z)({},n),(0,Z.Z)({},e,t.target.value)))}};function y(){return(y=(0,o.Z)((function(){var t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,m.ZP.delete("http://".concat((h.apiHost,window.location.hostname),":").concat(h.apiPort||9170,"/bridges/").concat(n.key),{headers:{"api-key":h.apiKey}})];case 1:return(t=r.sent())&&t.status<400?e.handleClose():p({text:"Failed to delete bridge",error:!0}),[2]}}))}))).apply(this,arguments)}function f(){return(f=(0,o.Z)((function(){var t,r,i,a,o,s;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return[4,v()];case 1:if(!(t=c.sent())||!t.uuid)return[3,8];r=(0,j.Z)((0,b.Z)({},n),{key:t.uuid}),i="http://".concat((h.apiHost,window.location.hostname),":").concat(h.apiPort||9170,"/bridges"),console.log("Save:",{url:i,bridgeData:r}),c.label=2;case 2:return c.trys.push([2,7,,8]),e.bridgeEdit.edit?[4,m.ZP.put("".concat(i,"/").concat(n.key),r,{headers:{"api-key":h.apiKey}})]:[3,4];case 3:return o=c.sent(),[3,6];case 4:return[4,m.ZP.post(i,r,{headers:{"api-key":h.apiKey}})];case 5:o=c.sent(),c.label=6;case 6:return(a=o)&&a.status<400?e.handleClose():p({text:"Failed to save bridge",error:!0}),[3,8];case 7:return s=c.sent(),console.error(s),[3,8];case 8:return[2]}}))}))).apply(this,arguments)}function v(){return E.apply(this,arguments)}function E(){return(E=(0,o.Z)((function(){var e,t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(p({text:"Testing bridge..",error:!1}),!(null===n||void 0===n?void 0:n.apiKey))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,m.ZP.get("http://".concat(n.host,":").concat(n.port,"/information"),{headers:{"api-key":n.apiKey}})];case 2:return(e=r.sent())&&e.status<400?(console.log("Information:",e.data),p({text:"Successfully connected to bridge.",error:!1}),[2,e.data]):(p({text:"Error testing bridge: ".concat(e.status," - ").concat(e.data),error:!0}),[3,4]);case 3:return t=r.sent(),console.error("Error:",t),p({text:"Error testing bridge: ".concat(t.message),error:!0}),[3,4];case 4:return[2,null]}}))}))).apply(this,arguments)}var B=(0,u.Z)(),F=(0,w.Z)(B.breakpoints.down("lg"));return(0,r.jsxs)(k.Z,{"aria-labelledby":"form-dialog-title",fullScreen:F,maxWidth:"md",open:!0,children:[(0,r.jsxs)(P.Z,{id:"form-dialog-title",children:[e.bridgeEdit.edit?"Edit":""," ",n.name]}),(0,r.jsxs)(_.Z,{children:[(0,r.jsx)(C.Z,{autoFocus:!0,fullWidth:!0,id:"name",label:"Name",onChange:x("name"),type:"text",value:n.name||"",variant:"outlined",sx:{margin:B.spacing(1,0)}}),(0,r.jsx)(C.Z,{fullWidth:!0,id:"host",label:"Host",onChange:x("host"),type:"text",value:n.host||"",variant:"outlined",sx:{margin:B.spacing(1,0)}}),(0,r.jsx)(C.Z,{fullWidth:!0,id:"port",label:"Port",onChange:x("port"),type:"number",value:n.port||9170,variant:"outlined",sx:{margin:B.spacing(1,0)}}),(0,r.jsx)(C.Z,{fullWidth:!0,id:"apiKey",label:"API Key",onChange:x("apiKey"),type:"text",value:n.apiKey||"",variant:"outlined",sx:{margin:B.spacing(1,0)}})]}),(0,r.jsxs)(S.Z,{children:[(0,r.jsx)(K.Z,{onClick:function(){return y.apply(this,arguments)},color:"inherit",variant:"contained",sx:{margin:B.spacing(1,0)},children:"Delete"}),(0,r.jsx)(g.Z,{color:d.error?"error":"textPrimary",variant:"subtitle2",sx:{margin:B.spacing(0,1),flex:1,textAlign:"right"},children:d.text}),(0,r.jsx)(K.Z,{autoFocus:!0,onClick:function(){p({text:"",error:!1}),e.handleClose()},variant:"contained",children:"Cancel"}),(0,r.jsx)(K.Z,{onClick:function(){return f.apply(this,arguments)},color:"primary",variant:"contained",children:"Save"})]})]})},B={port:9170};var F=function(){var e=function(e,t){a({bridge:e,edit:t})},t=(0,i.useState)(),n=t[0],a=t[1],Z=(0,i.useState)(),b=Z[0],j=Z[1],w=(0,s.Z)((0,v.r)(),1)[0],k=(0,i.useState)(!1),P=k[0],_=k[1],C=(0,l.useRouter)().query,S=(0,i.useCallback)((0,o.Z)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return console.log("Setup Bridges"),[4,m.ZP.get("http://".concat((C.apiHost,window.location.hostname),":").concat(C.apiPort||9170,"/bridges"),{headers:{"api-key":C.apiKey}})];case 1:return(e=t.sent())&&e.status<400&&j(e.data),[2]}}))})),[C.apiHost,C.apiPort,C.apiKey]);function K(){return(K=(0,o.Z)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return _(!0),[4,S()];case 1:return e.sent(),a(void 0),[2]}}))}))).apply(this,arguments)}(0,i.useEffect)((function(){!P&&C&&C.apiKey&&(_(!0),S())}),[P,S,C]);var F=(0,u.Z)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{maxWidth:"lg",children:w||b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.Z,{component:"h2",variant:"h3",sx:{margin:F.spacing(2,1.5,6)},children:"Bridges"}),b?(0,r.jsx)(x.Z,{children:b.map((function(t){return(0,r.jsx)(y.ZP,{button:!0,onClick:function(){return e(t,!0)},children:(0,r.jsx)(f.Z,{primary:"".concat(t.name," ").concat(t.apiKey?"":"(Not Configured)"),secondary:"".concat(t.host,":").concat(t.port),color:t.apiKey?"primary":"error"})},t.key)}))}):"",(0,r.jsx)(y.ZP,{button:!0,onClick:function(){return e(B,!1)},children:(0,r.jsx)(f.Z,{primary:"Add Bridge",secondary:"Add a new bridge",color:"primary"})})]}):(0,r.jsx)(p.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:F.spacing(10,0,8)},children:(0,r.jsx)(h.Z,{})})}),n?(0,r.jsx)(E,{bridgeEdit:n,handleClose:function(){return K.apply(this,arguments)}}):""]})};var H=function(){return(0,r.jsx)(a.Z,{title:"Bridges",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",noHeader:!0,children:(0,r.jsx)(F,{})})}}},function(e){e.O(0,[702,127,913,598,769,196,93,774,888,179],(function(){return t=8573,e(e.s=t);var t}));var t=e.O();_N_E=t}]);