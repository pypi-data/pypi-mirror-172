
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MIDAS Powergrid Module &#8212; MIDAS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="MIDAS Timesim Module" href="timesim.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="midas-powergrid-module">
<h1>MIDAS Powergrid Module<a class="headerlink" href="#midas-powergrid-module" title="Permalink to this headline">¶</a></h1>
<p>The <em>powergrid</em> module, provided by the <cite>midas-powergrid</cite> package, contains a simulator for pandapower networks, which will be called <em>grids</em> in the context of MIDAS.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This package will usually installed automatically together with <cite>midas-mosaik</cite>. It is available on pypi, so you can install it manually with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install midas-powergrids
</pre></div>
</div>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The intended use-case for the time simulator is to be used inside of MIDAS.
However, it only depends on the <cite>midas-util</cite> package and be used in any mosaik simulation scenario.</p>
<section id="inside-of-midas">
<h3>Inside of MIDAS<a class="headerlink" href="#inside-of-midas" title="Permalink to this headline">¶</a></h3>
<p>To use the store inside of MIDAS, simply add <cite>powergrid</cite> to your modules</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_scenario</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">powergrid</span><span class="w"></span>
<span class="w">    </span><span class="c1"># - ...</span><span class="w"></span>
</pre></div>
</div>
<p>and provide a <em>scope</em> and a <em>gridfile</em>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_scenario</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># ...</span><span class="w"></span>
<span class="w">  </span><span class="nt">powergrid_params</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">my_grid_scope</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">gridfile</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">midasmv</span><span class="w"></span>
</pre></div>
</div>
<p>Other, data-providing simulators with the same scope will output their data to this grid.
Possible values for <em>gridfile</em> will be described in the <em>Keys</em> section below.</p>
</section>
<section id="any-mosaik-scenario">
<h3>Any Mosaik Scenario<a class="headerlink" href="#any-mosaik-scenario" title="Permalink to this headline">¶</a></h3>
<p>If you don’t use MIDAS, you can add the <cite>powergrid</cite> manually to your mosaik scenario file. First, the entry in the <cite>sim_config</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Powergrid&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;python&quot;</span><span class="p">:</span> <span class="s2">&quot;midas.modules.powergrid:PandapowerSimulator&quot;</span><span class="p">},</span>
    <span class="c1"># ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, you need to start the simulator (assuming a <cite>step_size</cite> of 900):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid_sim</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s2">&quot;Powergrid&quot;</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the model needs to be started:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">grid_sim</span><span class="o">.</span><span class="n">Grid</span><span class="p">(</span><span class="n">gridfile</span><span class="o">=</span><span class="s2">&quot;midasmv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To connect the output of the grids’ buses to another model, you have to get the list of bus models from the powergrids’ children like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bus_models</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">grid</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="s2">&quot;bus&quot;</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">eid</span><span class="p">]</span>
</pre></div>
</div>
<p>and then connect those models either individually or in a loop, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">bus</span> <span class="ow">in</span> <span class="n">bus_models</span><span class="p">:</span>
    <span class="n">world</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span> <span class="n">other_entity</span><span class="p">,</span> <span class="s2">&quot;vm_pu&quot;</span><span class="p">,</span> <span class="s2">&quot;va_degree&quot;</span><span class="p">,</span> <span class="s2">&quot;p_mw&quot;</span><span class="p">,</span> <span class="s2">&quot;q_mvar&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The inputs are generally handled in the same way.
Have a look at <cite>grid.children</cite> to get the required entity eids.</p>
</section>
</section>
<section id="the-keys-of-the-powergrid-simulator">
<h2>The Keys of the Powergrid Simulator<a class="headerlink" href="#the-keys-of-the-powergrid-simulator" title="Permalink to this headline">¶</a></h2>
<p>This section gives a short description for all of the keys of the <em>powergrid</em> module.
Keys that are part of every upgrade module will only be mentioned if the actual behavior might be unexpected.</p>
<dl class="simple">
<dt>step_size</dt><dd><p>This key is mainly ignored by the grid model itself, since the model has no time-based internal state.</p>
</dd>
<dt>plotting</dt><dd><p>This key allows to enable grid plotting for certain grids.
The value is of type bool and defaults to <cite>false</cite>.</p>
</dd>
<dt>plot_path</dt><dd><p>This key specifies where the plotted grid images will be stored.
The value is of type string and the default value is <cite>plots</cite>, which will create a directory called <em>plots</em> in the <em>_outputs</em> directory defined in <em>midas-runtime-conf.yaml</em>.</p>
</dd>
<dt>save_grid_json</dt><dd><p>The value of this key is of type bool.
If set to true, the grid model will serialize the pandapower grid to json and send it to the database.
Since the resulting string is rather long, this option is set to <cite>false</cite> by default.</p>
</dd>
<dt>use_constraints</dt><dd><p>This key allows to enable the experimental feature of grid constraints.
The value is of type bool and defaults to <cite>false</cite>.</p>
</dd>
<dt>constraints</dt><dd><p>If <em>use_constraints</em> is set to <cite>true</cite>, this key allows to define the constraints to be used.
Once the feature is more evaluated, it will get its own section.
The <cite>constrainted_grids.yml</cite> scenario file in the MIDAS source code contains examples for different grids.</p>
</dd>
</dl>
<p>All above keys can be overwritten (or solely defined) within a certain scope.
However, available on scope level only are the following keys:</p>
<dl class="simple">
<dt>gridfile</dt><dd><p>This keys defines the grid topology to be loaded.
The type of the value is string but there are different semantics to that string.
First, there are a few pandapower grid topologies that can be directly accessed with aliases.
Those are <cite>cigre_hv</cite>, <cite>cigre_mv</cite> and <cite>cigre_lv</cite> for the corresponding grids.
Second, a few more aliases are <cite>midasmv</cite>, <cite>midaslv</cite>, and <cite>bhv</cite>, which load certain custom grids defined inside of MIDAS (<em>bhv</em> is the Bremerhaven Grid developed by a students’ project group at the University of Oldenburg).
Next, any Simbench code can be entered to load the corresponding grid (to get the data set of that grid, you have to modify the <em>midas-runtime-conf.yaml</em>, see the <em>sbdata</em> module for more information).
Finally, a python import string to a function can be entered that returns a pandapower grid.
This allows to define custom grids even outside of MIDAS.
The last segment of the import string needs to be the function to be called.
Parameters to that function can be passed with the <em>grid_params</em> key.
Additionally, grids can be loaded from <cite>.json</cite> or <cite>.xlsx</cite> files can be loaded.
The full (absolute or relative) path to those files needs to be entered.</p>
</dd>
<dt>grid_params</dt><dd><p>This key allows to pass additional parameters to grids that are neither .json nor .xlsx nor Simbench grids.
The value is of type dictionary and the values will be passed without further checking.
The default value is an empty dictionary.</p>
</dd>
</dl>
</section>
<section id="inputs-of-the-powergrid-simulator">
<h2>Inputs of the Powergrid Simulator<a class="headerlink" href="#inputs-of-the-powergrid-simulator" title="Permalink to this headline">¶</a></h2>
<p>The exact number of inputs depends on the grid topology that is used.
The grid has a number of children models, representing different components of the grid.</p>
<p>The most important attributes of loads, sgens, and storages (not available in every grid) are:</p>
<dl class="simple">
<dt>p_mw</dt><dd><p>Active power in Mega Watt of the grid node.
The behavior depends on the role (load, sgen, or storage) and multiple inputs to the same node will be summed up.
The value is of type float.</p>
</dd>
<dt>q_mvar</dt><dd><p>Reactive power in Mega Volt-Ampere reactive of the grid node.
The behavior depends on the role (load, sgen, or storage) and multiple inputs to the same node will be summed up.
The value is of type float.</p>
</dd>
</dl>
<p>Transformators have an input as well:</p>
<dl class="simple">
<dt>tap_pos</dt><dd><p>The currently active tap position.
The value is of type integer and defaults to 0.
The <em>tap_pos</em> can be between <em>tap_min</em> and <em>tap_max</em>, defined in the grid itself.
Currently, there is no MIDAS simulator that makes use of this input.</p>
</dd>
</dl>
<p>Finally, there are the switches which have an input:</p>
<dl class="simple">
<dt>closed</dt><dd><p>Controls the current state of the switch.
The default setting is closed, i.e., <em>closed</em> is set to <cite>true</cite>.
Currently, there is no MIDAS simulator that makes use of this input.</p>
</dd>
</dl>
</section>
<section id="outputs-of-the-powergrid-simulator">
<h2>Outputs of the Powergrid Simulator<a class="headerlink" href="#outputs-of-the-powergrid-simulator" title="Permalink to this headline">¶</a></h2>
<p>The grid itself has two outputs:</p>
<dl class="simple">
<dt>health</dt><dd><p>The average voltage magnitude per unit of all the buses in the grid.
The value is of type float.</p>
</dd>
<dt>grid_json</dt><dd><p>A string containing the json-serialized grid.</p>
</dd>
</dl>
<p>The bus nodes of the grid have four outputs:</p>
<dl class="simple">
<dt>vm_pu</dt><dd><p>The voltage magnitude per unit in relation to the slack node in the grid.
The value is of type float.</p>
</dd>
<dt>va_degree</dt><dd><p>The angle between voltage and current.
The value is of type float.</p>
</dd>
<dt>p_mw</dt><dd><p>The active power that arives at the bus.
The value is of type float.</p>
</dd>
<dt>q_mvar</dt><dd><p>The reactive power that arives at the bus.
The value is of type float.</p>
</dd>
</dl>
<p>Lines and transformators have (among others) the following output:</p>
<dl class="simple">
<dt>loading_percent</dt><dd><p>The load utilization relative to the rated power.
The value is of type float.</p>
</dd>
</dl>
<p>Additionally, the nodes that are listed in the inputs section, will send there current input to the database if one is used.</p>
</section>
<section id="palaestrai-sensors-of-the-powergrid-simulator">
<h2>PalaestrAI Sensors of the Powergrid Simulator<a class="headerlink" href="#palaestrai-sensors-of-the-powergrid-simulator" title="Permalink to this headline">¶</a></h2>
<p>If the <em>with_arl</em> is set either on the scenario levle or on the module level, sensor objects for the following outputs will be created.
However, space definitions needed to be generalized and may not represent the actual space of the attribute.</p>
<ul class="simple">
<li><p>loading_percent (Trafo, Line) = Box(0, 1, (1,), np.float32)</p></li>
<li><p>vm_pu (Bus) = Box(0.8, 1.2, (1,), np.float32)</p></li>
<li><p>va_degree (Bus) = Box(-1, 1, (1,), np.float32)</p></li>
<li><p>p_mw (Load, Sgen, Storage, Ext_grid) = Box(0, 1, (1,), np.float32)</p></li>
<li><p>q_mvar (Load, Sgen, Storage, Ext_grid) = Box(-1, 1, (1,), np.float32)</p></li>
<li><p>health (Grid) = Box(0, 1.2, (1,), np.float32)</p></li>
<li><p>grid_json (Grid) = Box(0, 1, (1,), np.float32)</p></li>
</ul>
<p>The last one (grid_json) is actually a string and not intented to be used as common sensor.</p>
</section>
<section id="palaestrai-actuators-of-the-powergrid-simulator">
<h2>PalaestrAI Actuators of the Powergrid Simulator<a class="headerlink" href="#palaestrai-actuators-of-the-powergrid-simulator" title="Permalink to this headline">¶</a></h2>
<p>With the <em>with_arl</em> flag, the following actuators will be created.
The spaces have the same limitations as with the sensors.</p>
<ul class="simple">
<li><p>tap_pos (Trafo): Box(-10, 10, (1,), np.int32)</p></li>
<li><p>p_mw (Load, Sgen): Box(0, 0.5, (1,), np.float32)</p></li>
<li><p>q_mvar (Load, Sgen): Box(0, 0.5, (1,), np.float32)</p></li>
</ul>
</section>
<section id="example-scenario-configuration">
<h2>Example Scenario Configuration<a class="headerlink" href="#example-scenario-configuration" title="Permalink to this headline">¶</a></h2>
<p>The following scenario (tbd) runs the same grid twice but one instance will use the (yet experimental) grid constraints.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">MIDAS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../next_steps.html">Next steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Scenario Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Overview of MIDAS’ Default Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="store.html">MIDAS Store Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="timesim.html">MIDAS Timesim Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MIDAS Powergrid Module</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Overview of MIDAS’ Default Modules</a><ul>
      <li>Previous: <a href="timesim.html" title="previous chapter">MIDAS Timesim Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Stephan Balduin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/modules/powergrid.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>