
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MIDAS Commercial Data Simulator &#8212; MIDAS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="MIDAS Smart Nord Data Module" href="sndata.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="midas-commercial-data-simulator">
<h1>MIDAS Commercial Data Simulator<a class="headerlink" href="#midas-commercial-data-simulator" title="Permalink to this headline">¶</a></h1>
<p>The <em>comdata</em> module, provided by the <em>midas-comdata</em> package, provides a simulator for a commercial building reference data set.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This package will usually installed automatically together with <cite>midas-mosaik</cite>. It is available on pypi, so you can install it manually with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install midas-comdata
</pre></div>
</div>
</section>
<section id="the-data">
<h2>The Data<a class="headerlink" href="#the-data" title="Permalink to this headline">¶</a></h2>
<p>The data set is taken from the project <a class="reference external" href="https://data.openei.org/about">Open Energy Data Initiative</a>.
It provides 15 time series for commercial facilitys, as it’s shown in the following table.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 46%" />
<col style="width: 18%" />
<col style="width: 21%" />
<col style="width: 14%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Facility</p></th>
<th class="head"><p>peak kW</p></th>
<th class="head"><p>MWh/a</p></th>
<th class="head"><p>avg kW</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Full Service Restaurant</p></td>
<td><p>0.137</p></td>
<td><p>601.044</p></td>
<td><p>0.069</p></td>
</tr>
<tr class="row-odd"><td><p>Hospital</p></td>
<td><p>2.805</p></td>
<td><p>18106.771</p></td>
<td><p>2.067</p></td>
</tr>
<tr class="row-even"><td><p>Large Hotel</p></td>
<td><p>0.876</p></td>
<td><p>4574.578</p></td>
<td><p>0.522</p></td>
</tr>
<tr class="row-odd"><td><p>Large Office</p></td>
<td><p>3.482</p></td>
<td><p>12137.960</p></td>
<td><p>1.386</p></td>
</tr>
<tr class="row-even"><td><p>Medium Office</p></td>
<td><p>0.588</p></td>
<td><p>1445.567</p></td>
<td><p>0.165</p></td>
</tr>
<tr class="row-odd"><td><p>Midrise Apartment</p></td>
<td><p>0.133</p></td>
<td><p>454.896</p></td>
<td><p>0.052</p></td>
</tr>
<tr class="row-even"><td><p>Out Patient</p></td>
<td><p>0.630</p></td>
<td><p>2643.197</p></td>
<td><p>0.302</p></td>
</tr>
<tr class="row-odd"><td><p>Primary School</p></td>
<td><p>0.713</p></td>
<td><p>1705.623</p></td>
<td><p>0.195</p></td>
</tr>
<tr class="row-even"><td><p>Quick Service Restaurant</p></td>
<td><p>0.077</p></td>
<td><p>357.569</p></td>
<td><p>0.041</p></td>
</tr>
<tr class="row-odd"><td><p>Secondary School</p></td>
<td><p>2.529</p></td>
<td><p>6396.515</p></td>
<td><p>0.730</p></td>
</tr>
<tr class="row-even"><td><p>Small Hotel</p></td>
<td><p>0.270</p></td>
<td><p>1147.850</p></td>
<td><p>0.131</p></td>
</tr>
<tr class="row-odd"><td><p>Small Office</p></td>
<td><p>0.039</p></td>
<td><p>122.119</p></td>
<td><p>0.014</p></td>
</tr>
<tr class="row-even"><td><p>Standalone Retail</p></td>
<td><p>0.219</p></td>
<td><p>615.892</p></td>
<td><p>0.070</p></td>
</tr>
<tr class="row-odd"><td><p>Strip Mall</p></td>
<td><p>0.197</p></td>
<td><p>541.853</p></td>
<td><p>0.062</p></td>
</tr>
<tr class="row-even"><td><p>Super Market</p></td>
<td><p>0.568</p></td>
<td><p>2343.541</p></td>
<td><p>0.268</p></td>
</tr>
<tr class="row-odd"><td><p>Warehouse</p></td>
<td><p>0.186</p></td>
<td><p>481.342</p></td>
<td><p>0.055</p></td>
</tr>
</tbody>
</table>
<p>The aggregated load of each lands is visualized in this figure:</p>
<a class="reference internal image-reference" href="../_images/facilitys.png"><img alt="../_images/facilitys.png" src="../_images/facilitys.png" style="width: 800px;" /></a>
</section>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The intended use-case for the time simulator is to be used inside of MIDAS.
However, it only depends on the <cite>midas-util</cite> package and be used in any mosaik simulation scenario.</p>
<section id="inside-of-midas">
<h3>Inside of MIDAS<a class="headerlink" href="#inside-of-midas" title="Permalink to this headline">¶</a></h3>
<p>To use the store inside of MIDAS, simply add <cite>comdata</cite> to your modules</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_scenario</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">comdata</span><span class="w"></span>
<span class="w">    </span><span class="c1"># - ...</span><span class="w"></span>
</pre></div>
</div>
<p>and provide a <em>scope</em> and a <em>gridfile</em>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">my_scenario</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="c1"># ...</span><span class="w"></span>
<span class="w">  </span><span class="nt">comdata_params</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">my_grid_scope</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nt">interpolate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">      </span><span class="nt">randomize_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">      </span><span class="nt">randomize_cos_phi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">      </span><span class="nt">mapping</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">22</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">Hospital</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.002</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># industrial subgrid</span><span class="w"></span>
<span class="w">        </span><span class="nt">35</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">StripMall</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.015</span><span class="p p-Indicator">]]</span><span class="w"></span>
</pre></div>
</div>
<p>The number 22, 35 stands for the bus number, which depends on the used <em>gridfile</em>.</p>
</section>
<section id="any-mosaik-scenario">
<h3>Any Mosaik Scenario<a class="headerlink" href="#any-mosaik-scenario" title="Permalink to this headline">¶</a></h3>
<p>If you don’t use MIDAS, you can add the <cite>comdata</cite> manually to your <a class="reference external" href="https://mosaik.readthedocs.io/en/latest/tutorials/demo1.html">mosaik scenario</a> file.
First, the entry in the <cite>sim_config</cite>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim_config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CommercialDataSimulator&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;python&quot;</span><span class="p">:</span> <span class="s2">&quot;midas.modules.comdata.simulator:CommercialDataSimulator&quot;</span><span class="p">},</span>
    <span class="c1"># ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Next, you need to start the simulator (assuming a <cite>step_size</cite> of 900):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">comdata_sim</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
    <span class="s2">&quot;CommercialData&quot;</span><span class="p">,</span>
    <span class="n">step_size</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
    <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2020-01-01 00:00:00+0100&quot;</span><span class="p">,</span>
    <span class="n">data_path</span><span class="o">=</span><span class="s2">&quot;/path/to/folder/where/dataset/is/located/&quot;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;CommercialsRefTMY3.hdf5&quot;</span><span class="p">,</span>  <span class="c1"># this is default</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Then the models can be started:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hospital</span> <span class="o">=</span> <span class="n">comdata_sim</span><span class="o">.</span><span class="n">Hospital</span><span class="p">(</span><span class="n">scaling</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">full_serv_restaurant</span> <span class="o">=</span> <span class="n">comdata_sim</span><span class="o">.</span><span class="n">FullServiceRestaurant</span><span class="p">(</span><span class="n">scaling</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the modells need to be connected to other entities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hospital</span><span class="p">,</span> <span class="n">other_entity</span><span class="p">,</span> <span class="s2">&quot;p_mw&quot;</span><span class="p">,</span> <span class="s2">&quot;q_mvar&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="the-keys-of-the-commercial-data-simulator">
<h2>The Keys of the Commercial Data Simulator<a class="headerlink" href="#the-keys-of-the-commercial-data-simulator" title="Permalink to this headline">¶</a></h2>
<p>This section gives a short description for all of the keys of the <em>comdata</em> module.
Keys that are part of every upgrade module will only be mentioned if the actual behavior might be unexpected.
First, the keys supported by the base data simulator.</p>
<dl class="simple">
<dt>step_size</dt><dd><p>The step size does not only affect the frequency of the simulator’s step calls but also the access to the data set.
The time resolution of the data set is 15 minutes (= 900 seconds).
When a lower <em>step_size</em> is used, e.g., 450, then the models will return the same values in every two consecutive steps.
With a higher <em>step_size</em>, e.g., 1800, every second value will be skipped.</p>
</dd>
<dt>interpolate</dt><dd><p>In cases where the time resolution of the data set is larger than the <em>step_size</em>, this key can be used to activate interpolation.
It is of type bool and defaults to <cite>false</cite>.
The interpolation is linear and allows to use even a <em>step_size</em> of 1.</p>
</dd>
<dt>randomize_data</dt><dd><p>This key can be used to activate randomization of the data.
It is of type bool and defaults to <cite>false</cite>.
If activated, a normal-distributed noise will be added to the output values.
The strength of the noise can be controlled with <em>noise_factor</em>.
The randomization is applied after interpolation.
If the data set contains <em>P</em> and <em>Q</em> values, noise is calculated individually for both of them.</p>
</dd>
<dt>noise_factor</dt><dd><p>This key can be used to control the strength of the noise, when <em>randomize_data</em> is used.
It is of type float and the default value is <cite>0.2</cite>, i.e., the noise is drawn with mean of zero (always) and standard deviation of 0.2 times the standard deviation of the data set for <em>P</em> or <em>Q</em>, respectively.</p>
</dd>
<dt>randomize_cos_phi</dt><dd><p>If the data set does not have values for <em>Q</em> (which is the case for the Smart Nord data set), the <em>Q</em> value will be calculated based on the value of the <em>cos_phi</em> key.
The <em>randomize_cos_phi</em> key allows to randomize the cos_phi value before that calculation.
It is of type bool and defaults to <cite>false</cite>.</p>
</dd>
</dl>
<p>On the module level, the <em>comdata</em> may also have following key:</p>
<dl class="simple">
<dt>load_scaling</dt><dd><p>This key can be used to scale all load models simultaneously.
It does not replace individual scaling, instead it is just another factor which is included in the multiplication.
It is of type float and the default value is <cite>1.0</cite>.</p>
</dd>
</dl>
<p>The following keys are only available on the scope level:</p>
<dl>
<dt>filename</dt><dd><p>The value of this key holds the filename of the data set file, starting from the location specified by <em>data_path</em>.
The value is of type string, the default value is <cite>CommercialsRefTMY3.hdf5</cite>, and, usually, there is no need to change this value.</p>
</dd>
<dt>mapping</dt><dd><p>This key allows to configure the models this simulator should create.
The mapping depends on the grid in-use and requires information about the available load nodes and the buses they should be connected to.
For example, a mapping for a grid with two facilitys at buses 2 and 4, the mapping could look like</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">mapping</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">SuperMarket</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.0</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">  </span><span class="nt">4</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">SmallOffice</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.2</span><span class="p p-Indicator">]]</span><span class="w"></span>
</pre></div>
</div>
<p>This will be interpreted as: create a SuperMarket and a SmallOffice model and a scaling of 1.0 and 1.2.
Connect those models to the load node at bus 2 and 4cd.
The models will also automatically connect to the database if any is used.</p>
</dd>
</dl>
</section>
<section id="inputs-of-the-commercial-data-simulator">
<h2>Inputs of the Commercial Data Simulator<a class="headerlink" href="#inputs-of-the-commercial-data-simulator" title="Permalink to this headline">¶</a></h2>
<p>Since this module is a data provider, it has not many inputs:</p>
<dl class="simple">
<dt>cos_phi</dt><dd><p>Set the cos phi for the next step.
This input is only relevant if the data set has no <em>Q</em> values and if <em>randomize_cos_phi</em> is set to <cite>false</cite>.</p>
</dd>
<dt>local_time</dt><dd><p>(Not yet implemented) If <em>local_time</em> is provided, e.g., by the <em>timesim</em>, then this time will be used to determine the current value from the data set.
This input is of type string in the UTC ISO 8601 date format.</p>
</dd>
</dl>
</section>
<section id="outputs-of-the-commercial-data-simulator">
<h2>Outputs of the Commercial Data Simulator<a class="headerlink" href="#outputs-of-the-commercial-data-simulator" title="Permalink to this headline">¶</a></h2>
<p>The models of this module have three outputs:</p>
<dl class="simple">
<dt>p_mw</dt><dd><p>Active power output in MW.</p>
</dd>
<dt>q_mvar</dt><dd><p>Reactive power output in MVAr.</p>
</dd>
<dt>cos_phi</dt><dd><p>The actual cos phi used in the previous step.</p>
</dd>
</dl>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>The following example is taken from the default <cite>midaslv</cite> scenario file.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">comdata_params</span><span class="p">:</span><span class="w"></span>
<span class="w"> </span><span class="nt">midaslv</span><span class="p">:</span><span class="w"></span>
<span class="w">   </span><span class="nt">interpolate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">   </span><span class="nt">randomize_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">   </span><span class="nt">randomize_cos_phi</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"></span>
<span class="w">   </span><span class="nt">mapping</span><span class="p">:</span><span class="w"></span>
<span class="w">     </span><span class="nt">22</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">Hospital</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.002</span><span class="p p-Indicator">]]</span><span class="w"> </span><span class="c1"># industrial subgrid</span><span class="w"></span>
<span class="w">     </span><span class="nt">35</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">StripMall</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.015</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">36</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">Warehouse</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.015</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">37</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">SmallHotel</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0072</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">40</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">StandaloneRetail</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.015</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">41</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">QuickServiceRestaurant</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0075</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">42</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">MidriseApartment</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.012</span><span class="p p-Indicator">]]</span><span class="w"></span>
<span class="w">     </span><span class="nt">43</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="nv">SmallOffice</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.021</span><span class="p p-Indicator">]]</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">MIDAS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../next_steps.html">Next Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Scenario Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Overview of MIDAS’ Default Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="store.html">MIDAS Store Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="timesim.html">MIDAS Timesim Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="powergrid.html">MIDAS Powergrid Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="sndata.html">MIDAS Smart Nord Data Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MIDAS Commercial Data Simulator</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Overview of MIDAS’ Default Modules</a><ul>
      <li>Previous: <a href="sndata.html" title="previous chapter">MIDAS Smart Nord Data Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Stephan Balduin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/modules/comdata.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>