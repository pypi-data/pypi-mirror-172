(this["webpackJsonpray-dashboard-client"]=this["webpackJsonpray-dashboard-client"]||[]).push([[5],{511:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(159),r=a(491),c=a(497),o=a(485),i=a(498),l=a(0),s=a.n(l),u=Object(n.a)((function(e){return{search:{margin:e.spacing(1),marginTop:0}}})),d=function(e){var t=e.label,a=e.onChange,n=e.defaultValue,o=u();return s.a.createElement(r.a,{className:o.search,size:"small",label:t,InputProps:{onChange:function(e){var t=e.target.value;a&&a(t)},defaultValue:n,endAdornment:s.a.createElement(c.a,{position:"end"},s.a.createElement(i.a,null))}})},m=function(e){var t=e.label,a=e.onChange,n=e.options,c=u();return s.a.createElement(r.a,{className:c.search,size:"small",label:t,select:!0,SelectProps:{onChange:function(e){var t=e.target.value;a&&a(t)},style:{width:100}}},s.a.createElement(o.a,{value:""},"All"),n.map((function(e){return"string"===typeof e?s.a.createElement(o.a,{value:e},e):s.a.createElement(o.a,{value:e[0]},e[1])})))}},512:function(e,t,a){"use strict";var n=a(436),r=a(483),c=a(0),o=a.n(c);t.a=function(e){var t=e.loading;return o.a.createElement(n.a,{open:t,style:{zIndex:100}},o.a.createElement(r.a,{color:"primary"}))}},517:function(e,t,a){"use strict";var n=a(1),r=a(2),c=a(0),o=(a(5),a(3)),i=a(4),l=c.forwardRef((function(e,t){var a=e.classes,i=e.className,l=e.component,s=void 0===l?"div":l,u=Object(r.a)(e,["classes","className","component"]);return c.createElement(s,Object(n.a)({ref:t,className:Object(o.a)(a.root,i)},u))}));t.a=Object(i.a)({root:{width:"100%",overflowX:"auto"}},{name:"MuiTableContainer"})(l)},518:function(e,t,a){"use strict";var n=a(1),r=a(2),c=a(0),o=(a(5),a(3)),i=a(4),l=a(8),s=a(6),u=a(112),d=c.forwardRef((function(e,t){var a=e.classes,i=e.className,l=e.color,d=void 0===l?"secondary":l,m=e.edge,p=void 0!==m&&m,b=e.size,g=void 0===b?"medium":b,h=Object(r.a)(e,["classes","className","color","edge","size"]),f=c.createElement("span",{className:a.thumb});return c.createElement("span",{className:Object(o.a)(a.root,i,{start:a.edgeStart,end:a.edgeEnd}[p],"small"===g&&a["size".concat(Object(s.a)(g))])},c.createElement(u.a,Object(n.a)({type:"checkbox",icon:f,checkedIcon:f,classes:{root:Object(o.a)(a.switchBase,a["color".concat(Object(s.a)(d))]),input:a.input,checked:a.checked,disabled:a.disabled},ref:t},h)),c.createElement("span",{className:a.track}))}));t.a=Object(i.a)((function(e){return{root:{display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},edgeStart:{marginLeft:-8},edgeEnd:{marginRight:-8},switchBase:{position:"absolute",top:0,left:0,zIndex:1,color:"light"===e.palette.type?e.palette.grey[50]:e.palette.grey[400],transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),"&$checked":{transform:"translateX(20px)"},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{opacity:.5},"&$disabled + $track":{opacity:"light"===e.palette.type?.12:.1}},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(l.c)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.primary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(l.c)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:"light"===e.palette.type?e.palette.grey[400]:e.palette.grey[800]},"&$checked + $track":{backgroundColor:e.palette.secondary.main},"&$disabled + $track":{backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white}},sizeSmall:{width:40,height:24,padding:7,"& $thumb":{width:16,height:16},"& $switchBase":{padding:4,"&$checked":{transform:"translateX(16px)"}}},checked:{},disabled:{},input:{left:"-100%",width:"300%"},thumb:{boxShadow:e.shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"},track:{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:"light"===e.palette.type?e.palette.common.black:e.palette.common.white,opacity:"light"===e.palette.type?.38:.3}}}),{name:"MuiSwitch"})(d)},519:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return c}));var n=a(50),r=function(){return Object(n.b)("api/jobs/")},c=function(e){return Object(n.b)("jobs/".concat(e))}},532:function(e,t,a){"use strict";a.r(t);var n=a(518),r=a(517),c=a(481),o=a(479),i=a(480),l=a(478),s=a(482),u=a(159),d=a(502),m=a(64),p=a.n(m),b=a(0),g=a.n(b),h=a(67),f=a(512),v=a(511),k=a(109),y=a(27),j=a(16),E=a(12),O=a.n(E),w=a(17),S=a(85),C=a(7),$=a(81),N=a(519),x=Object(u.a)((function(e){return{root:{padding:e.spacing(2),width:"100%"}}})),z=["Job ID","Submission ID","Status","Logs","StartTime","EndTime","Driver Pid"];t.default=function(){var e=x(),t=function(){var e=Object(b.useState)([]),t=Object(C.a)(e,2),a=t[0],n=t[1],r=Object(b.useState)({pageSize:10,pageNo:1}),c=Object(C.a)(r,2),o=c[0],i=c[1],l=Object(b.useState)("Loading the job list..."),s=Object(C.a)(l,2),u=s[0],d=s[1],m=Object(b.useState)(!0),p=Object(C.a)(m,2),g=p[0],h=p[1],f=Object(b.useContext)($.a).ipLogMap,v=Object(b.useState)([]),k=Object(C.a)(v,2),E=k[0],x=k[1],z=Object(b.useRef)(g),R=Object(b.useRef)();z.current=g;var _=Object(b.useCallback)(Object(w.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z.current){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(N.b)();case 4:(t=e.sent)&&(n(t.data.sort((function(e,t){var a,n;return(null!==(a=t.start_time)&&void 0!==a?a:0)-(null!==(n=e.start_time)&&void 0!==n?n:0)}))),d("Fetched jobs")),R.current=setTimeout(_,4e3);case 7:case"end":return e.stop()}}),e)}))),[]);return Object(b.useEffect)((function(){return _(),function(){R.current&&clearTimeout(R.current)}}),[_]),{jobList:a.filter((function(e){return E.every((function(t){var a;return e[t.key]&&(null!==(a=e[t.key])&&void 0!==a?a:"").includes(t.val)}))})),msg:u,isRefreshing:g,onSwitchChange:function(e){h(e.target.checked)},changeFilter:function(e,t){var a=E.find((function(t){return t.key===e}));a?a.val=t:E.push({key:e,val:t}),x(Object(S.a)(E))},page:o,originalJobs:a,setPage:function(e,t){return i(Object(j.a)(Object(j.a)({},o),{},Object(y.a)({},e,t)))},ipLogMap:f}}(),a=t.msg,u=t.isRefreshing,m=t.onSwitchChange,E=t.jobList,R=t.changeFilter,_=t.page,I=t.setPage,L=t.ipLogMap;return g.a.createElement("div",{className:e.root},g.a.createElement(f.a,{loading:a.startsWith("Loading")}),g.a.createElement(k.a,{title:"JOBS"},"Auto Refresh:",g.a.createElement(n.a,{checked:u,onChange:m,name:"refresh",inputProps:{"aria-label":"secondary checkbox"}}),g.a.createElement("br",null),"Request Status: ",a),g.a.createElement(k.a,{title:"Job List"},g.a.createElement(r.a,null,g.a.createElement(v.a,{label:"Job ID",onChange:function(e){return R("job_id",e)}}),g.a.createElement(v.a,{label:"Page Size",onChange:function(e){return I("pageSize",Math.min(Number(e),500)||10)}}),g.a.createElement("div",null,g.a.createElement(d.a,{count:Math.ceil(E.length/_.pageSize),page:_.pageNo,onChange:function(e,t){return I("pageNo",t)}})),g.a.createElement(c.a,null,g.a.createElement(o.a,null,g.a.createElement(i.a,null,z.map((function(e){return g.a.createElement(l.a,{align:"center",key:e},e)})))),g.a.createElement(s.a,null,E.slice((_.pageNo-1)*_.pageSize,_.pageNo*_.pageSize).map((function(e,t){var a,n,r=e.job_id,c=e.submission_id,o=e.driver_info,s=e.type,u=e.status,d=e.start_time,m=e.end_time;return g.a.createElement(i.a,{key:null!==(a=null!==r&&void 0!==r?r:c)&&void 0!==a?a:t},g.a.createElement(l.a,{align:"center"},null!==r&&void 0!==r?r:"-"),g.a.createElement(l.a,{align:"center"},null!==c&&void 0!==c?c:"-"),g.a.createElement(l.a,{align:"center"},u),g.a.createElement(l.a,{align:"center"},o&&L[o.node_ip_address]?g.a.createElement(h.b,{to:"/log/".concat(encodeURIComponent(L[o.node_ip_address]),"?fileName=").concat("DRIVER"===s?r:"driver-".concat(c)),target:"_blank"},"Log"):"-"),g.a.createElement(l.a,{align:"center"},p()(Number(d)).format("YYYY/MM/DD HH:mm:ss")),g.a.createElement(l.a,{align:"center"},m&&m>0?p()(Number(m)).format("YYYY/MM/DD HH:mm:ss"):"-"),g.a.createElement(l.a,{align:"center"},null!==(n=null===o||void 0===o?void 0:o.pid)&&void 0!==n?n:"-"))})))))))}}}]);
//# sourceMappingURL=5.a7e39ddd.chunk.js.map