
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Frequently Asked Questions &#8212; mode-ng 0.4.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="frequently-asked-questions">
<h1>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this heading">¶</a></h1>
<section id="can-i-use-mode-with-django-flask-etc">
<h2>Can I use Mode with Django/Flask/etc.?<a class="headerlink" href="#can-i-use-mode-with-django-flask-etc" title="Permalink to this heading">¶</a></h2>
<p>Yes! Use gevent/eventlet as a bridge to integrate with asyncio.</p>
<section id="using-gevent">
<h3>Using <code class="docutils literal notranslate"><span class="pre">gevent</span></code><a class="headerlink" href="#using-gevent" title="Permalink to this heading">¶</a></h3>
<p>This works with any blocking Python library that can work with gevent.</p>
<p>Using gevent requires you to install the <code class="docutils literal notranslate"><span class="pre">aiogevent</span></code> module,
and you can install this as a bundle with Mode:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install -U mode<span class="o">[</span>gevent<span class="o">]</span>
</pre></div>
</div>
<p>Then to actually use gevent as the event loop you have to
execute the following in your entrypoint module (usually where you
start the worker), before any other third party libraries are imported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">mode.loop</span>
<span class="n">mode</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;gevent&#39;</span><span class="p">)</span>
<span class="c1"># execute program</span>
</pre></div>
</div>
<p>REMEMBER: This must be located at the very top of the module,
in such a way that it executes before you import other libraries.</p>
</section>
<section id="using-eventlet">
<h3>Using <code class="docutils literal notranslate"><span class="pre">eventlet</span></code><a class="headerlink" href="#using-eventlet" title="Permalink to this heading">¶</a></h3>
<p>This works with any blocking Python library that can work with eventlet.</p>
<p>Using eventlet requires you to install the <code class="docutils literal notranslate"><span class="pre">aioeventlet</span></code> module,
and you can install this as a bundle with Mode:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip install -U mode<span class="o">[</span>eventlet<span class="o">]</span>
</pre></div>
</div>
<p>Then to actually use eventlet as the event loop you have to
execute the following in your entrypoint module (usually where you
start the worker), before any other third party libraries are imported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="kn">import</span> <span class="nn">mode.loop</span>
<span class="n">mode</span><span class="o">.</span><span class="n">loop</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;eventlet&#39;</span><span class="p">)</span>
<span class="c1"># execute program</span>
</pre></div>
</div>
<p>REMEMBER: It’s very important this is at the very top of the module,
and that it executes before you import libraries.</p>
</section>
</section>
<section id="can-i-use-mode-with-tornado">
<h2>Can I use Mode with Tornado?<a class="headerlink" href="#can-i-use-mode-with-tornado" title="Permalink to this heading">¶</a></h2>
<p>Yes! Use the <code class="docutils literal notranslate"><span class="pre">tornado.platform.asyncio</span></code> bridge:
<a class="reference external" href="http://www.tornadoweb.org/en/stable/asyncio.html">http://www.tornadoweb.org/en/stable/asyncio.html</a></p>
</section>
<section id="can-i-use-mode-with-twisted">
<h2>Can I use Mode with Twisted?<a class="headerlink" href="#can-i-use-mode-with-twisted" title="Permalink to this heading">¶</a></h2>
<p>Yes! Use the asyncio reactor implementation:
<a class="reference external" href="https://twistedmatrix.com/documents/17.1.0/api/twisted.internet.asyncioreactor.html">https://twistedmatrix.com/documents/17.1.0/api/twisted.internet.asyncioreactor.html</a></p>
</section>
<section id="will-you-support-python-3-5-or-earlier">
<h2>Will you support Python 3.5 or earlier?<a class="headerlink" href="#will-you-support-python-3-5-or-earlier" title="Permalink to this heading">¶</a></h2>
<p>There are no immediate plans to support Python 3.5, but you are welcome to
contribute to the project.</p>
<p>Here are some of the steps required to accomplish this:</p>
<ul>
<li><p>Source code transformation to rewrite variable annotations to comments</p>
<p>for example, the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
         <span class="n">x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
         <span class="n">y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">must</span> <span class="n">be</span> <span class="n">rewritten</span> <span class="n">into</span><span class="p">::</span>

     <span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
         <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># type: int</span>
         <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># type: int</span>
</pre></div>
</div>
</li>
<li><p>Source code transformation to rewrite async functions</p>
<blockquote>
<div><p>for example, the code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>must be rewritten into:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@coroutine</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">yield from</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="will-you-support-python-2">
<h2>Will you support Python 2?<a class="headerlink" href="#will-you-support-python-2" title="Permalink to this heading">¶</a></h2>
<p>There are no plans to support Python 2, but you are welcome to contribute to
the project (details in question above is relevant also for Python 2).</p>
</section>
<section id="at-shutdown-i-get-lots-of-warnings-what-is-this-about">
<h2>At Shutdown I get lots of warnings, what is this about?<a class="headerlink" href="#at-shutdown-i-get-lots-of-warnings-what-is-this-about" title="Permalink to this heading">¶</a></h2>
<p>If you get warnings such as this at shutdown:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Task was destroyed but it is pending!
task: &lt;Task pending coro=&lt;Service._execute_task() running at /opt/devel/mode/mode/services.py:643&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x1100a7468&gt;()]&gt;&gt;
Task was destroyed but it is pending!
task: &lt;Task pending coro=&lt;Service._execute_task() running at /opt/devel/mode/mode/services.py:643&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x1100a72e8&gt;()]&gt;&gt;
Task was destroyed but it is pending!
task: &lt;Task pending coro=&lt;Service._execute_task() running at /opt/devel/mode/mode/services.py:643&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x1100a7678&gt;()]&gt;&gt;
Task was destroyed but it is pending!
task: &lt;Task pending coro=&lt;Event.wait() running at /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/asyncio/locks.py:269&gt; cb=[_release_waiter(&lt;Future pendi...1100a7468&gt;()]&gt;)() at /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/asyncio/tasks.py:316]&gt;
Task was destroyed but it is pending!
    task: &lt;Task pending coro=&lt;Event.wait() running at /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/asyncio/locks.py:269&gt; cb=[_release_waiter(&lt;Future pendi...1100a7678&gt;()]&gt;)() at /Library/Frameworks/Python.framework/Versions/3.6/lib/python3.6/asyncio/tasks.py:316]&gt;
</pre></div>
</div>
<p>It usually means you forgot to stop a service before the process exited.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">mode-ng</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction to Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">Copyright</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Lanqing Huang.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/includes/faq.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>